<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="pineapple-man"><title>CPU 与并发 - pineapple-man</title><meta name="author" content="pineapple-man"><meta name="keywords" content="CPU,如何设置线程个数"><link rel="icon" href="https://pineapple-man.github.io/assets/images/logo.svg"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png"},"articleBody":"\n¶CPU 相关术语\n🤔程序都运行在 CPU 之上，那么 CPU 的核心数和线程数之间是什么关系尼？答案隐藏在本文中\n¶物理 CPU 数（Physical CPU）\n\n✨Physical CPU 指的是：主板上实际插入的 CPU 硬件个数\n😣但是这一概念经常被泛泛的说成是 cpu 数，这很容易导致与 core 数，processor 数等概念混淆\n🎶由于在主板上引入多个 CPU 插槽（socket）需要更复杂的硬件支持（连接不同插槽的 CPU 到内存和其他资源），通常只会在服务器才会插多个物理 CPU，家用 PC 机的主板上只会有一个 CPU 插槽\n¶核心（Core）\n最初，每个物理 CPU 上只有一个核心（single core），此时对于操作系统而言，同一时刻只能运行一个进程/线程；随着摩尔定律的生效，CPU 厂商开始在单个物理 cpu 上增加核心（实实在在的硬件存在），此时单核心物理 CPU变成了双核心 cpu（dual-core cpu）以及多核心 cpu（multiple cores），如此一来，操作系统就能在同一时刻运行多个进程/线程\n\n一个双核心 cpu 就是操作系统同一时刻能够运行两个进程/线程的物理设备，下图是多核心 CPU 的示意图\n\n\n¶同时多线程技术（simultaneous multithreading）和超线程技术（hyper–threading/HT）\n🎯同时多线程技术和超线程技术的本意是：提高单个 CPU 核心同一时刻能够执行的多线程数，充分利用单个 CPU Core 的计算能力\n\nsimultaneous multithreading 缩写 SMT，是 AMD 和其他 CPU 厂商的称呼\nhyper–threading 是 Intel 的称呼，可以认为 hyper–threading 是 SMT 的一种具体技术实现\n✨在类似的多线程技术下，产生了如下等价的术语：\n\n虚拟核心：virtual core\n逻辑处理器：logical processor\n线程：thread\n\n\n¶查看系统 CPU 资源\n¶Linux 系统\n1234567891011121314#查看物理 cpu 数cat /proc/cpuinfo| grep &quot;physical id&quot;| sort| uniq| wc -l## 查看每个物理 cpu 中 核心数(core 数)cat /proc/cpuinfo | grep &quot;cpu cores&quot; | uniq## 查看总的逻辑 cpu 数（processor 数）cat /proc/cpuinfo| grep &quot;processor&quot;| wc -l## 查看 cpu 型号cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c## 同时查看上述信息lscpu\n¶Windows 系统\n\n¶CPU 的并发\nCPU 本身并没有线程和进程的概念，它只会按照机器指令的要求执行某个动作，线程以及进程等概念是从操作系统角度看待任务产生的两个概念，因此宏观角度看待CPU 不存在并发性抽象，并发的抽象发生在操作系统层级\n🎶CPU 的核心数和线程个数有什么必然的关系吗？（没有任何关系）\n\n单个核心可以跑任意多个线程，只要计算机内存足够就可以；\n计算机可以有多核但只运行单线程\n\n📓CPU 与并发的总结\n\nCPU 根本不理解自己执行的指令属于哪个线程，CPU 也不需要理解这些，CPU 需要做的事情就是根据 PC 寄存器中的地址从内存中取出响应的指令，然后执行就足够了\n计算机中应该存在多少线程，线程之间如何运行都是操作系统应该操心的事情，CPU 根本不用考虑这些问题，它只需要执行任务就可以了\n\n¶操作系统的并发\n✨操作系统的并发来自于操作系统的多任务特点\n🤔什么是操作系统的多任务？\n\n多任务就是在操作系统的管理下（通过修改 CPU 的 PC 寄存器），能够在一段时间内执行多个任务（多个线程）\n多任务是并行/并发的雏形\n\n¶进程与线程\n🆚CPU 与 OS 如何看待进程和线程\n\nCPU 不知道执行的某一段机器指令属于 A 任务还是 B 任务，其内部没有进程和线程的抽象\n操作系统知道机器指令属于哪个任务，同时操作系统还能知道任务 A 和 B 任务是否属于同一个地址空间\n\n\n如果两个任务属于同一个地址空间，那么任务 A 和任务 B 就是我们熟悉的多线程；如果不属于同一个地址空间，那么任务 A 和任务 B 就是我们熟悉的多进程\n\n¶单核与多线程\n假设现在有两个任务，任务 A 和任务 B，每个任务需要的计算时间都是 5 分钟，那么无论是任务 A 和任务 B 串行执行还是放到两个线程中并行执行，在单核环境下执行完这两个任务总需要 10 分钟\n🎶由于核心数是固定的，再怎么并发，单核心上再某一时刻，只能执行一个任务\n👴线程概念为程序设计人员提供了一种变成抽象，可以将一项任务进行划分，然后把每一个子任务放到一个个线程中运行\n📖单核多线程的案例（阻塞式 I/O）\n\n如果没有多线程，执行阻塞式 I/O 时整个进程会被操作系统暂停，但如果开启两个线程，其中一个线程被阻塞时另一个线程依然可以继续向前推进，就可以充分利用系统资源\n\n¶总结\n🎶CPU 自身对于并发还是并行是不敏感的，这些都是我们在操作系统层面讨论的东西，CPU 唯一限制开发人员的就是：CPU 所具有的物理性质（核心数目），就是再优秀的并发算法，在单核 CPU 上，表现的性能比串行性能差\n🤔为了让多线程程序更好的利用 cpu 资源，应当如何做到 CPU 与线程数的权衡尼？\n\n对于计算密集型程序的建议是：(logical processor count ) + 1，有的建议是(logical processor count)*1.5，但是大部分都是经验之谈，需要根据实际业务场景进行测试才能得到适合自己的答案\n\n❓那么如何了解机器拥有的 logical processor 数尼？\n\ncpuinfo中查看：cat /proc/cpuinfo | grep &quot;processor&quot; | wc -l\ntop命令查看：cpu0,cpu1,...\n编程：比如在 Java 中用 Runtime.getRuntime().availableProcessors()\n\n¶附录\ncpu 核心数与线程数——何健超\n中央处理器——wiki\nCPU 核数与线程数有什么关系？\n","dateCreated":"2021-10-22T11:53:14+00:00","dateModified":"2023-06-07T02:13:34+00:00","datePublished":"2021-10-22T11:53:14+00:00","description":"之前一直对CPU相关的术语有些纠缠不清楚，本文将这些概念进行整理","headline":"CPU 与并发","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://pineapple-man.github.io/cpu-%E4%B8%8E%E5%B9%B6%E5%8F%91/"},"publisher":{"@type":"Organization","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png","logo":{"@type":"ImageObject","url":"logo.png"}},"url":"https://pineapple-man.github.io/cpu-%E4%B8%8E%E5%B9%B6%E5%8F%91/","keywords":"操作系统"}</script><meta name="description" content="之前一直对CPU相关的术语有些纠缠不清楚，本文将这些概念进行整理"><meta property="og:type" content="blog"><meta property="og:title" content="CPU 与并发"><meta property="og:url" content="https://pineapple-man.github.io/cpu-%E4%B8%8E%E5%B9%B6%E5%8F%91/"><meta property="og:site_name" content="pineapple-man"><meta property="og:description" content="之前一直对CPU相关的术语有些纠缠不清楚，本文将这些概念进行整理"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/1200px-Intel_Core_I7-920_Boxed_-_14.JPG"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/v2-e898e919d0061b49ac2fe8ac0ad190ec_720w.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/image-20211017124212223.png"><meta property="article:published_time" content="2021-10-22T11:53:14.000Z"><meta property="article:modified_time" content="2023-06-07T02:13:34.003Z"><meta property="article:author" content="pineapple-man"><meta property="article:tag" content="操作系统"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/1200px-Intel_Core_I7-920_Boxed_-_14.JPG"><meta property="og:image" content="https://pineapple-man.github.io/assets/images/logo.png"><link rel="stylesheet" href="/assets/css/style-oth3meuzcjopbgwqbdvoxqknhcm0sy9wkullcc94zhkkop3pmfrpl5t4fzzz.min.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-210516333-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-210516333-1")</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"></head><body><div id="blog"><header id="header" data-behavior="5"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><div class="header-title"><a class="header-title-link" href="/" aria-label="">pineapple-man</a></div><a class="header-right-picture" href="#about" aria-label="打开链接: /#about"><img class="header-picture" src="/assets/images/logo.png" alt="作者的图片"></a></header><nav id="sidebar" data-behavior="5"><div class="sidebar-container"><div class="sidebar-profile"><a href="/#about" aria-label="阅读有关作者的更多信息"><img class="sidebar-profile-picture" src="/assets/images/logo.png" alt="作者的图片"></a><h4 class="sidebar-profile-name">pineapple-man</h4><h5 class="sidebar-profile-bio"><p>做一个菠萝：站得笔直，头戴王冠，内心甜美</p></h5></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="/" rel="noopener" title="首页"><i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i> <span class="sidebar-button-desc">首页</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-categories" rel="noopener" title="分类"><i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i> <span class="sidebar-button-desc">分类</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-tags" rel="noopener" title="标签"><i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i> <span class="sidebar-button-desc">标签</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-archives" rel="noopener" title="归档"><i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i> <span class="sidebar-button-desc">归档</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="#about" rel="noopener" title="关于"><i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i> <span class="sidebar-button-desc">关于</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="https://github.com/pineapple-man" target="_blank" rel="noopener" title="GitHub"><i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i> <span class="sidebar-button-desc">GitHub</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="mailto://mingchaohu720@gmail.com" target="_blank" rel="noopener" title="邮箱"><i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i> <span class="sidebar-button-desc">邮箱</span></a></li></ul></div></nav><div id="main" data-behavior="5" class="hasCoverMetaIn"><article class="post"><div class="post-header main-content-wrap text-center"><h1 class="post-title">CPU 与并发</h1><div class="post-meta"><time datetime="2021-10-22T11:53:14+00:00">10月 22, 2021 </time><span>发布在 </span><a class="category-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a> <i class="fas fa-book-open"></i> 本文共<span class="post-count"> 1.6k </span>字 <i class="far fa-clock"></i> 阅读预计<span class="post-count"> 15 </span>分钟</div></div><div class="post-content markdown"><div class="main-content-wrap"><h1 id="table-of-contents">目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CPU-%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD"><span class="toc-text">CPU 相关术语</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A9%E7%90%86-CPU-%E6%95%B0%EF%BC%88Physical-CPU%EF%BC%89"><span class="toc-text">物理 CPU 数（Physical CPU）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%EF%BC%88Core%EF%BC%89"><span class="toc-text">核心（Core）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%97%B6%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%8A%80%E6%9C%AF%EF%BC%88simultaneous-multithreading%EF%BC%89%E5%92%8C%E8%B6%85%E7%BA%BF%E7%A8%8B%E6%8A%80%E6%9C%AF%EF%BC%88hyper%E2%80%93threading-HT%EF%BC%89"><span class="toc-text">同时多线程技术（simultaneous multithreading）和超线程技术（hyper–threading&#x2F;HT）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F-CPU-%E8%B5%84%E6%BA%90"><span class="toc-text">查看系统 CPU 资源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux-%E7%B3%BB%E7%BB%9F"><span class="toc-text">Linux 系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows-%E7%B3%BB%E7%BB%9F"><span class="toc-text">Windows 系统</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CPU-%E7%9A%84%E5%B9%B6%E5%8F%91"><span class="toc-text">CPU 的并发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B9%B6%E5%8F%91"><span class="toc-text">操作系统的并发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B"><span class="toc-text">进程与线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%A0%B8%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-text">单核与多线程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-text">附录</span></a></li></ol><h2 id="CPU-相关术语"><a class="header-anchor" href="#CPU-相关术语">¶</a>CPU 相关术语</h2><p>🤔程序都运行在 CPU 之上，那么 CPU 的核心数和线程数之间是什么关系尼？答案隐藏在本文中</p><h3 id="物理-CPU-数（Physical-CPU）"><a class="header-anchor" href="#物理-CPU-数（Physical-CPU）">¶</a>物理 CPU 数（Physical CPU）</h3><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/1200px-Intel_Core_I7-920_Boxed_-_14.JPG" alt="中央处理器"></p><p>✨Physical CPU 指的是：<strong>主板上实际插入的 CPU 硬件个数</strong></p><p>😣但是这一概念经常被泛泛的说成是 cpu 数，这很容易导致与 core 数，processor 数等概念混淆</p><p>🎶由于在主板上引入多个 CPU 插槽（socket）需要更复杂的硬件支持（连接不同插槽的 CPU 到内存和其他资源），通常只会在服务器才会插多个物理 CPU，家用 PC 机的主板上只会有一个 CPU 插槽</p><h3 id="核心（Core）"><a class="header-anchor" href="#核心（Core）">¶</a>核心（Core）</h3><p>最初，每个物理 CPU 上只有一个核心（single core），此时对于操作系统而言，同一时刻只能运行一个进程/线程；随着<strong>摩尔定律的生效</strong>，CPU 厂商开始在单个物理 cpu 上增加核心（实实在在的硬件存在），此时<strong>单核心物理 CPU</strong>变成了<strong>双核心 cpu（dual-core cpu）<strong>以及</strong>多核心 cpu（multiple cores）</strong>，如此一来，操作系统就能在同一时刻运行多个进程/线程</p><blockquote><p>一个双核心 cpu 就是操作系统同一时刻能够运行两个进程/线程的物理设备，下图是多核心 CPU 的示意图</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/v2-e898e919d0061b49ac2fe8ac0ad190ec_720w.jpg" alt="CPU muliti croe "></p><h3 id="同时多线程技术（simultaneous-multithreading）和超线程技术（hyper–threading-HT）"><a class="header-anchor" href="#同时多线程技术（simultaneous-multithreading）和超线程技术（hyper–threading-HT）">¶</a>同时多线程技术（simultaneous multithreading）和超线程技术（hyper–threading/HT）</h3><p>🎯同时多线程技术和超线程技术的本意是：<strong>提高单个 CPU 核心同一时刻能够执行的多线程数</strong>，充分利用单个 CPU Core 的计算能力</p><blockquote><p>simultaneous multithreading 缩写 SMT，是 AMD 和其他 CPU 厂商的称呼</p><p>hyper–threading 是 Intel 的称呼，可以认为 hyper–threading 是 SMT 的一种具体技术实现</p><p>✨在类似的多线程技术下，产生了如下等价的术语：</p><ul><li>虚拟核心：virtual core</li><li>逻辑处理器：logical processor</li><li>线程：thread</li></ul></blockquote><h3 id="查看系统-CPU-资源"><a class="header-anchor" href="#查看系统-CPU-资源">¶</a>查看系统 CPU 资源</h3><h4 id="Linux-系统"><a class="header-anchor" href="#Linux-系统">¶</a>Linux 系统</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看物理 cpu 数</span></span><br><span class="line"><span class="built_in">cat</span> /proc/cpuinfo| grep <span class="string">&quot;physical id&quot;</span>| <span class="built_in">sort</span>| <span class="built_in">uniq</span>| <span class="built_in">wc</span> -l</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看每个物理 cpu 中 核心数(core 数)</span></span><br><span class="line"><span class="built_in">cat</span> /proc/cpuinfo | grep <span class="string">&quot;cpu cores&quot;</span> | <span class="built_in">uniq</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看总的逻辑 cpu 数（processor 数）</span></span><br><span class="line"><span class="built_in">cat</span> /proc/cpuinfo| grep <span class="string">&quot;processor&quot;</span>| <span class="built_in">wc</span> -l</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看 cpu 型号</span></span><br><span class="line"><span class="built_in">cat</span> /proc/cpuinfo | grep name | <span class="built_in">cut</span> -f2 -d: | <span class="built_in">uniq</span> -c</span><br><span class="line"></span><br><span class="line"><span class="comment">## 同时查看上述信息</span></span><br><span class="line">lscpu</span><br></pre></td></tr></table></figure><h4 id="Windows-系统"><a class="header-anchor" href="#Windows-系统">¶</a>Windows 系统</h4><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/image-20211017124212223.png" alt="Windows系统查看CPU信息"></p><h2 id="CPU-的并发"><a class="header-anchor" href="#CPU-的并发">¶</a>CPU 的并发</h2><p>CPU 本身并没有线程和进程的概念，它只会<strong>按照机器指令的要求执行某个动作</strong>，<strong>线程以及进程等概念是从操作系统角度看待任务产生的两个概念</strong>，因此宏观角度看待<strong>CPU 不存在并发性抽象，并发的抽象发生在操作系统层级</strong></p><p>🎶CPU 的核心数和线程个数有什么必然的关系吗？（没有任何关系）</p><ul><li>单个核心可以跑任意多个线程，只要计算机内存足够就可以；</li><li>计算机可以有多核但只运行单线程</li></ul><p>📓CPU 与并发的总结</p><ul><li>CPU 根本不理解自己执行的指令属于哪个线程，CPU 也不需要理解这些，<strong>CPU 需要做的事情就是根据 PC 寄存器中的地址从内存中取出响应的指令，然后执行就足够了</strong></li><li>计算机中应该存在多少线程，线程之间如何运行都是<strong>操作系统</strong>应该操心的事情，CPU 根本不用考虑这些问题，它只需要执行任务就可以了</li></ul><h2 id="操作系统的并发"><a class="header-anchor" href="#操作系统的并发">¶</a>操作系统的并发</h2><p>✨操作系统的并发来自于操作系统的多任务特点<br>🤔什么是操作系统的多任务？</p><ul><li>多任务就是在操作系统的管理下（通过<strong>修改 CPU 的 PC 寄存器</strong>），能够在一段时间内执行多个任务（多个线程）</li><li>多任务是并行/并发的雏形</li></ul><h3 id="进程与线程"><a class="header-anchor" href="#进程与线程">¶</a>进程与线程</h3><p>🆚CPU 与 OS 如何看待进程和线程</p><ul><li>CPU 不知道执行的某一段机器指令属于 A 任务还是 B 任务，其内部没有进程和线程的抽象</li><li>操作系统知道机器指令属于哪个任务，同时操作系统还能知道任务 A 和 B 任务是否属于同一个<strong>地址空间</strong></li></ul><blockquote><p>如果两个任务属于同一个地址空间，那么任务 A 和任务 B 就是我们熟悉的<strong>多线程</strong>；如果不属于同一个地址空间，那么任务 A 和任务 B 就是我们熟悉的<strong>多进程</strong></p></blockquote><h3 id="单核与多线程"><a class="header-anchor" href="#单核与多线程">¶</a>单核与多线程</h3><p>假设现在有两个任务，任务 A 和任务 B，每个任务需要的计算时间都是 5 分钟，那么无论是任务 A 和任务 B 串行执行还是放到两个线程中并行执行，在单核环境下执行完这两个任务总需要 10 分钟</p><p>🎶由于核心数是固定的，再怎么并发，单核心上再某一时刻，只能执行一个任务</p><p>👴<strong>线程概念为程序设计人员提供了一种变成抽象</strong>，可以将一项任务进行划分，然后把每一个子任务放到一个个线程中运行</p><p>📖单核多线程的案例（阻塞式 I/O）</p><ul><li>如果没有多线程，执行阻塞式 I/O 时整个进程会被操作系统暂停，但如果开启两个线程，其中一个线程被阻塞时另一个线程依然可以继续向前推进，就可以充分利用系统资源</li></ul><h2 id="总结"><a class="header-anchor" href="#总结">¶</a>总结</h2><p>🎶CPU 自身对于并发还是并行是不敏感的，这些都是我们在操作系统层面讨论的东西，CPU 唯一限制开发人员的就是：<strong>CPU 所具有的物理性质（核心数目）</strong>，就是再优秀的并发算法，在单核 CPU 上，表现的性能比串行性能差</p><p>🤔为了让多线程程序<strong>更好的利用 cpu 资源</strong>，应当如何做到 CPU 与线程数的权衡尼？</p><ul><li>对于计算密集型程序的建议是：<code>(logical processor count ) + 1</code>，有的建议是<code>(logical processor count)*1.5</code>，但是大部分都是经验之谈，需要根据实际业务场景进行测试才能得到适合自己的答案</li></ul><p>❓那么如何<strong>了解机器拥有的 logical processor 数尼</strong>？</p><ul><li><code>cpuinfo</code>中查看：<code>cat /proc/cpuinfo | grep &quot;processor&quot; | wc -l</code></li><li><code>top</code>命令查看：<code>cpu0,cpu1,...</code></li><li>编程：比如在 Java 中用 <code>Runtime.getRuntime().availableProcessors()</code></li></ul><h2 id="附录"><a class="header-anchor" href="#附录">¶</a>附录</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/86855590">cpu 核心数与线程数——何健超</a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%A4%AE%E5%A4%84%E7%90%86%E5%99%A8">中央处理器——wiki</a></p><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg4OTYzODM4Mw==&amp;mid=2247485900&amp;idx=1&amp;sn=36e943eb6fe9baaf9cce64b2295136c8&amp;chksm=cfe9954cf89e1c5a83073f70e832d953e487781dbfe9c7cb55c5db241c80791bfc570e27daa8&amp;=985761181&amp;=zh_CN#rd">CPU 核数与线程数有什么关系？</a></p></div></div><div id="post-footer" class="post-footer main-content-wrap"><div class="post-footer-tags"><span class="text-color-light text-small">标签</span><br><a class="tag tag--primary tag--small t-none-link" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag">操作系统</a></div><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E8%AE%A1%E7%AE%97%E5%A4%8D%E6%9D%82%E6%80%A7/" data-tooltip="计算复杂性" aria-label="上一篇: 计算复杂性"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">上一篇</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%80%BB%E8%A7%88/" data-tooltip="设计模式总览" aria-label="下一篇: 设计模式总览"><span class="hide-xs hide-sm text-small icon-mr">下一篇</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></article><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><footer id="footer" class="main-content-wrap"><span class="copyrights">Copyrights &copy; 2023 pineapple-man. All Rights Reserved.</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><br>Total <span id="busuanzi_value_site_pv"></span> views. 您是pineapple-man的第<span id="busuanzi_value_site_uv"></span>个小伙伴<br><i class="fas fa-book-open"></i> <span class="post-count">博客字数统计：370.7k</span><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></footer></div><div id="bottom-bar" class="post-bottom-bar" data-behavior="5"><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E8%AE%A1%E7%AE%97%E5%A4%8D%E6%9D%82%E6%80%A7/" data-tooltip="计算复杂性" aria-label="上一篇: 计算复杂性"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">上一篇</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%80%BB%E8%A7%88/" data-tooltip="设计模式总览" aria-label="下一篇: 设计模式总览"><span class="hide-xs hide-sm text-small icon-mr">下一篇</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></div><div id="about"><div id="about-card"><div id="about-btn-close"><i class="fa fa-times"></i></div><img id="about-card-picture" src="/assets/images/logo.png" alt="作者的图片"><h4 id="about-card-name">pineapple-man</h4><div id="about-card-bio"><p>做一个菠萝：站得笔直，头戴王冠，内心甜美</p></div><div id="about-card-job"><i class="fa fa-briefcase"></i><br><p>刚毕业就失业</p></div><div id="about-card-location"><i class="fa fa-map-marker-alt"></i><br>西安</div></div></div><div id="cover" style="background-image:url(/assets/images/cover-v1.2.0.jpg)"></div><script src="/assets/js/script-kcoiyt1nxfue7qgcpkrcixymglcc3cuxeg98fy01hqww4nblnhd2ees6j6yc.min.js"></script></body></html>