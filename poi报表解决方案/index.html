<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="pineapple-man"><title>POI报表解决方案 - pineapple-man</title><meta name="author" content="pineapple-man"><meta name="keywords" content="POI报表"><link rel="icon" href="https://pineapple-man.github.io/assets/images/logo.svg"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png"},"articleBody":"\n¶概述\n在企业级应用开发中，Excel 报表是一种最常见的报表需求，Excel 报表开发一般分为两种形式：\n\n方便操作，基于 Excel 的报表批量上传数据\n通过 java 代码生成 Excel 报表\n\n¶Excel 的两种形式\n目前世面上的 Excel 分为两个大的版本 Excel2003 和 Excel2007 及以上两个版本，两者之间的区别如下：\n\n\n\n\nExcel 2003\nExcel 2003\n\n\n\n\n后缀\nxls\nxlsx\n\n\n结构\n二进制格式，核心结构是复合文档类型的结构\nXML 类型结构\n\n\n单 sheet 数据量\n行：65535列：256\n行：1048576列：16384\n\n\n特点\n存储容量优先\n基于xml压缩，占用空间小、操作效率高\n\n\n\n✨Java 中常见的用来操作 Excl 的方式一般有 2 种：JXL 和 POI\n\nJXL 只能对 Excel 进行操作,属于比较老的框架，它只支持到 Excel 95-2000 的版本。现在已经停止更新和维护。\nPOI 是 apache 的项目,可对微软的 Word、Excel、PPT 进行操作,包括 office2003 和 2007,Excel2003 和 2007\n\n¶POI\nAPache POI 是 Apache 软件基金会的开源项目，由 Java 编写的免费开源的跨平台的 Java API，Apache POI 提供 API 给 Java 语言操作Microsoft Office功能\n✨应用场景\n\n数据报表生成\n数据备份\n数据批量上传\n\n1234567891011121314151617&lt;dependencies&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;        &lt;artifactId&gt;poi&lt;/artifactId&gt;        &lt;version&gt;4.0.1&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;        &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;        &lt;version&gt;4.0.1&lt;/version&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;        &lt;artifactId&gt;poi-ooxml-schemas&lt;/artifactId&gt;        &lt;version&gt;4.0.1&lt;/version&gt;    &lt;/dependency&gt;&lt;/dependencies&gt;\n结构说明\n\n\n\n结构\n对应的 office\n\n\n\n\nHSSF\n提供读写 Microsoft Excel XLS 格式档案的功能\n\n\nXSSF\n提供读写 Microsoft Excel OOXML XLSX 格式档案的功能\n\n\nHWPF\n提供读写 Microsoft Word DOC 格式档案的功能\n\n\nHSLF\n提供读写 Microsoft PowerPoint 格式档案的功能\n\n\nHDGF\n提供读 Microsoft Visio 格式档案的功能\n\n\nHPBF\n提供读 Microsoft Publisher 格式档案的功能\n\n\nHSMF\n提供读 Microsoft Outlook 格式档案的功能\n\n\n\n¶操作\n\n\n\nAPI 名称\n含义\n\n\n\n\nWorkbook\nExcel 的文档对象,针对不同的 Excel 类型分为：HSSFWorkbook（2003）和 XSSFWorkbool（2007）\n\n\nSheet\nExcel 的表单\n\n\nRow\nExcel 的行\n\n\nCell\nExcel 的格子单元\n\n\nFont\nExcel 字体\n\n\nCellStyle\n格子单元样式\n\n\n\n¶创建 Excel\n12345XSSFWorkbook workbook = new XSSFWorkbook();XSSFSheet sheet = workbook.createSheet(&quot;test&quot;);FileOutputStream fileOutputStream = new FileOutputStream(&quot;test.xlsx&quot;);workbook.write(fileOutputStream);fileOutputStream.close();\n¶创建单元格\n12345678XSSFWorkbook workbook = new XSSFWorkbook();XSSFSheet sheet = workbook.createSheet(&quot;test&quot;);XSSFRow row = sheet.createRow(3);XSSFCell cell = row.createCell(0);cell.setCellValue(&quot;Hello World&quot;);FileOutputStream fileOutputStream = new FileOutputStream(&quot;test.xlsx&quot;);workbook.write(fileOutputStream);fileOutputStream.close();\n¶设置格式\n12345678910111213141516171819202122232425262728293031323334353637// 创建单元格样式对象XSSFCellStyle cellStyle = workbook.createCellStyle();// 设置边框// 设置下边框cellStyle.setBorderBottom(BorderStyle.DASH_DOT);// 设置上边框cellStyle.setBorderBottom(BorderStyle.HAIR);// 设置字体// 创建字体对象Font font = workbook.createFont();// 设置字体font.setFontName(&quot;仿宋&quot;);// 设置字号font.setFontHeightInPoints((short) 28);cellStyle.setFont(font);// 设置宽高// 设置第一列的宽度是 31 个字符宽度sheet.setColumnWidth(0,31*256);// 设置行的高度是 50 个点row.setHeightInPoints(50);// 设置居中显示// 水平居中cellStyle.setAlignment(HorizontalAlignment.CENTER);// 垂直居中cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);// 设置单元格样式cell.setCellStyle(cellStyle);// 合并单元格CellRangeAddress region = new CellRangeAddress(0, 3, 0, 3);sheet.addMergedRegion(region);fileOutputStream.close();\n¶绘制图形\n1234567891011121314151617181920212223242526272829XSSFWorkbook workbook = new XSSFWorkbook();XSSFSheet sheet = workbook.createSheet(&quot;test&quot;);// 读取图片FileInputStream fileInputStream = new FileInputStream(&quot;/Users/humingchao/IdeaProjects/SaaS_ihrm/poiTest/p1.jpg&quot;);byte[] bytes = IOUtils.toByteArray(fileInputStream);fileInputStream.read(bytes);// 向 POI 内存添加一张图片，并返回该图片在 Excel 中的图片集合中的下标int index = workbook.addPicture(bytes, Workbook.PICTURE_TYPE_JPEG);// 绘制图片工具类XSSFCreationHelper helper = workbook.getCreationHelper();// 创建一个绘图对象Drawing&lt;?&gt; patriarch = sheet.createDrawingPatriarch();// 创建锚点，设置图片坐标ClientAnchor anchor = helper.createClientAnchor();// 行从 0 开始anchor.setRow1(0);// 列从 0 开始anchor.setCol1(0);// 创建图片Picture picture = patriarch.createPicture(anchor, index);picture.resize();// 文件流FileOutputStream fileOutputStream = new FileOutputStream(&quot;test3.xlsx&quot;);// 写入文件workbook.write(fileOutputStream);fileOutputStream.close();\n¶加载 Excel\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public static void main(String[] args) throws Exception &#123;   // 创建 workbook 工作簿   XSSFWorkbook workbook = new XSSFWorkbook(&quot;demo.xlsx&quot;);   // 获取 sheet 从 0 开始   Sheet sheet = workbook.getSheetAt(0);   int totalRowNum = sheet.getLastRowNum();   Row row = null;   Cell cell = null;  // 循环所有行   for (int rowNum = 0; rowNum &lt;=sheet.getLastRowNum(); rowNum++) &#123;      row = sheet.getRow(rowNum);      StringBuilder stringBuilder = new StringBuilder();     // 循环每行中的所有单元格      for (int cellNum = 2; cellNum &lt; row.getLastCellNum(); cellNum++) &#123;         cell = row.getCell(cellNum);         stringBuilder.append(getValue(cell)).append(&quot;-&quot;);      &#125;      System.out.println(stringBuilder.toString());   &#125;&#125;// 获取数据public static Object getValue(Cell cell) &#123;   Object value = null;   switch (cell.getCellType()) &#123;      case STRING:         value = cell.getStringCellValue();         break;      case BOOLEAN:         value = cell.getBooleanCellValue();         break;\t\t// 数字类型（包含日期和普通数字）     case NUMERIC:         if (DateUtil.isCellDateFormatted(cell)) &#123;            value = cell.getDateCellValue();         &#125; else &#123;            value = cell.getNumericCellValue();         &#125;         break;\t\t// 公式类型     case FORMULA:         value = cell.getCellFormula();         break;      default:         break;   &#125;   return value;&#125;\n¶模版打印\n自定义生成 Excel 报表文件还是有很多不尽如意的地方，特别是针对复杂报表头，单元格样式，字体等操作。手写这些代码不仅费时费力，有时候效果还不太理想。\n❓ 那怎么样才能更方便的对报表样式，报表头进行处理呢?\n答案是使用已经准备好的 Excel 模板，只需要关注模板中的数据即可\n⛵ 模版打印的操作步骤\n\n制作模版文件（模版文件的路径）\n导入（加载）模版文件，从而得到一个工作簿\n读取工作表\n读取行\n读取单元格\n读取单元格样式\n设置单元格内容\n其他单元格就可以使用读到的样式了\n\n","dateCreated":"2022-01-31T16:55:15+00:00","dateModified":"2023-06-07T02:13:34+00:00","datePublished":"2022-01-31T16:55:15+00:00","description":"本文主要讲解如何通过 Java 进行报表处理","headline":"POI报表解决方案","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://pineapple-man.github.io/poi%E6%8A%A5%E8%A1%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"},"publisher":{"@type":"Organization","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png","logo":{"@type":"ImageObject","url":"logo.png"}},"url":"https://pineapple-man.github.io/poi%E6%8A%A5%E8%A1%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","keywords":"杂七杂八"}</script><meta name="description" content="本文主要讲解如何通过 Java 进行报表处理"><meta property="og:type" content="blog"><meta property="og:title" content="POI报表解决方案"><meta property="og:url" content="https://pineapple-man.github.io/poi%E6%8A%A5%E8%A1%A8%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"><meta property="og:site_name" content="pineapple-man"><meta property="og:description" content="本文主要讲解如何通过 Java 进行报表处理"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2022-01-31T16:55:15.000Z"><meta property="article:modified_time" content="2023-06-07T02:13:34.003Z"><meta property="article:author" content="pineapple-man"><meta property="article:tag" content="杂七杂八"><meta name="twitter:card" content="summary"><meta property="og:image" content="https://pineapple-man.github.io/assets/images/logo.png"><link rel="stylesheet" href="/assets/css/style-oth3meuzcjopbgwqbdvoxqknhcm0sy9wkullcc94zhkkop3pmfrpl5t4fzzz.min.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-210516333-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-210516333-1")</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"></head><body><div id="blog"><header id="header" data-behavior="5"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><div class="header-title"><a class="header-title-link" href="/" aria-label="">pineapple-man</a></div><a class="header-right-picture" href="#about" aria-label="打开链接: /#about"><img class="header-picture" src="/assets/images/logo.png" alt="作者的图片"></a></header><nav id="sidebar" data-behavior="5"><div class="sidebar-container"><div class="sidebar-profile"><a href="/#about" aria-label="阅读有关作者的更多信息"><img class="sidebar-profile-picture" src="/assets/images/logo.png" alt="作者的图片"></a><h4 class="sidebar-profile-name">pineapple-man</h4><h5 class="sidebar-profile-bio"><p>做一个菠萝：站得笔直，头戴王冠，内心甜美</p></h5></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="/" rel="noopener" title="首页"><i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i> <span class="sidebar-button-desc">首页</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-categories" rel="noopener" title="分类"><i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i> <span class="sidebar-button-desc">分类</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-tags" rel="noopener" title="标签"><i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i> <span class="sidebar-button-desc">标签</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-archives" rel="noopener" title="归档"><i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i> <span class="sidebar-button-desc">归档</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="#about" rel="noopener" title="关于"><i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i> <span class="sidebar-button-desc">关于</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="https://github.com/pineapple-man" target="_blank" rel="noopener" title="GitHub"><i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i> <span class="sidebar-button-desc">GitHub</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="mailto://mingchaohu720@gmail.com" target="_blank" rel="noopener" title="邮箱"><i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i> <span class="sidebar-button-desc">邮箱</span></a></li></ul></div></nav><div id="main" data-behavior="5" class="hasCoverMetaIn"><article class="post"><div class="post-header main-content-wrap text-center"><h1 class="post-title">POI报表解决方案</h1><div class="post-meta"><time datetime="2022-01-31T16:55:15+00:00">1月 31, 2022 </time><span>发布在 </span><a class="category-link" href="/categories/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">解决方案</a> <i class="fas fa-book-open"></i> 本文共<span class="post-count"> 1.4k </span>字 <i class="far fa-clock"></i> 阅读预计<span class="post-count"> 15 </span>分钟</div></div><div class="post-content markdown"><div class="main-content-wrap"><h1 id="table-of-contents">目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Excel-%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%BD%A2%E5%BC%8F"><span class="toc-text">Excel 的两种形式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POI"><span class="toc-text">POI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C"><span class="toc-text">操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-Excel"><span class="toc-text">创建 Excel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-text">创建单元格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%A0%BC%E5%BC%8F"><span class="toc-text">设置格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%9B%BE%E5%BD%A2"><span class="toc-text">绘制图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD-Excel"><span class="toc-text">加载 Excel</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E7%89%88%E6%89%93%E5%8D%B0"><span class="toc-text">模版打印</span></a></li></ol><h2 id="概述"><a class="header-anchor" href="#概述">¶</a>概述</h2><p>在企业级应用开发中，Excel 报表是一种最常见的报表需求，Excel 报表开发一般分为两种形式：</p><ul><li>方便操作，基于 Excel 的报表批量上传数据</li><li>通过 java 代码生成 Excel 报表</li></ul><h2 id="Excel-的两种形式"><a class="header-anchor" href="#Excel-的两种形式">¶</a>Excel 的两种形式</h2><p>目前世面上的 Excel 分为两个大的版本 Excel2003 和 Excel2007 及以上两个版本，两者之间的区别如下：</p><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Excel 2003</th><th style="text-align:center">Excel 2003</th></tr></thead><tbody><tr><td style="text-align:center">后缀</td><td style="text-align:center"><code>xls</code></td><td style="text-align:center"><code>xlsx</code></td></tr><tr><td style="text-align:center">结构</td><td style="text-align:center">二进制格式，核心结构是复合文档类型的结构</td><td style="text-align:center">XML 类型结构</td></tr><tr><td style="text-align:center">单 sheet 数据量</td><td style="text-align:center">行：65535<br>列：256</td><td style="text-align:center">行：1048576<br>列：16384</td></tr><tr><td style="text-align:center">特点</td><td style="text-align:center">存储容量优先</td><td style="text-align:center">基于<code>xml</code>压缩，占用空间小、操作效率高</td></tr></tbody></table><p>✨Java 中常见的用来操作 Excl 的方式一般有 2 种：JXL 和 POI</p><ul><li>JXL 只能对 Excel 进行操作,属于比较老的框架，它只支持到 Excel 95-2000 的版本。现在已经停止更新和维护。</li><li>POI 是 apache 的项目,可对微软的 Word、Excel、PPT 进行操作,包括 office2003 和 2007,Excel2003 和 2007</li></ul><h2 id="POI"><a class="header-anchor" href="#POI">¶</a>POI</h2><p>APache POI 是 Apache 软件基金会的开源项目，由 Java 编写的免费开源的跨平台的 Java API，Apache POI 提供 API 给 Java 语言操作<code>Microsoft Office</code>功能</p><p>✨应用场景</p><ul><li>数据报表生成</li><li>数据备份</li><li>数据批量上传</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml-schemas<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>结构说明</p><table><thead><tr><th style="text-align:center">结构</th><th style="text-align:center">对应的 office</th></tr></thead><tbody><tr><td style="text-align:center"><code>HSSF</code></td><td style="text-align:center">提供读写 <strong>Microsoft Excel XLS</strong> 格式档案的功能</td></tr><tr><td style="text-align:center"><code>XSSF</code></td><td style="text-align:center">提供读写 <strong>Microsoft Excel OOXML XLSX</strong> 格式档案的功能</td></tr><tr><td style="text-align:center">HWPF</td><td style="text-align:center">提供读写 Microsoft Word DOC 格式档案的功能</td></tr><tr><td style="text-align:center">HSLF</td><td style="text-align:center">提供读写 Microsoft PowerPoint 格式档案的功能</td></tr><tr><td style="text-align:center">HDGF</td><td style="text-align:center">提供读 Microsoft Visio 格式档案的功能</td></tr><tr><td style="text-align:center">HPBF</td><td style="text-align:center">提供读 Microsoft Publisher 格式档案的功能</td></tr><tr><td style="text-align:center">HSMF</td><td style="text-align:center">提供读 Microsoft Outlook 格式档案的功能</td></tr></tbody></table><h3 id="操作"><a class="header-anchor" href="#操作">¶</a>操作</h3><table><thead><tr><th style="text-align:center">API 名称</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">Workbook</td><td style="text-align:center">Excel 的文档对象,针对不同的 Excel 类型分为：HSSFWorkbook（2003）和 XSSFWorkbool（2007）</td></tr><tr><td style="text-align:center">Sheet</td><td style="text-align:center">Excel 的表单</td></tr><tr><td style="text-align:center">Row</td><td style="text-align:center">Excel 的行</td></tr><tr><td style="text-align:center">Cell</td><td style="text-align:center">Excel 的格子单元</td></tr><tr><td style="text-align:center">Font</td><td style="text-align:center">Excel 字体</td></tr><tr><td style="text-align:center">CellStyle</td><td style="text-align:center">格子单元样式</td></tr></tbody></table><h3 id="创建-Excel"><a class="header-anchor" href="#创建-Excel">¶</a>创建 <code>Excel</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">XSSFWorkbook</span> <span class="variable">workbook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>();</span><br><span class="line"><span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> workbook.createSheet(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;test.xlsx&quot;</span>);</span><br><span class="line">workbook.write(fileOutputStream);</span><br><span class="line">fileOutputStream.close();</span><br></pre></td></tr></table></figure><h3 id="创建单元格"><a class="header-anchor" href="#创建单元格">¶</a>创建单元格</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">XSSFWorkbook</span> <span class="variable">workbook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>();</span><br><span class="line"><span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> workbook.createSheet(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="type">XSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(<span class="number">3</span>);</span><br><span class="line"><span class="type">XSSFCell</span> <span class="variable">cell</span> <span class="operator">=</span> row.createCell(<span class="number">0</span>);</span><br><span class="line">cell.setCellValue(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line"><span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;test.xlsx&quot;</span>);</span><br><span class="line">workbook.write(fileOutputStream);</span><br><span class="line">fileOutputStream.close();</span><br></pre></td></tr></table></figure><h3 id="设置格式"><a class="header-anchor" href="#设置格式">¶</a>设置格式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建单元格样式对象</span></span><br><span class="line"><span class="type">XSSFCellStyle</span> <span class="variable">cellStyle</span> <span class="operator">=</span> workbook.createCellStyle();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置边框</span></span><br><span class="line"><span class="comment">// 设置下边框</span></span><br><span class="line">cellStyle.setBorderBottom(BorderStyle.DASH_DOT);</span><br><span class="line"><span class="comment">// 设置上边框</span></span><br><span class="line">cellStyle.setBorderBottom(BorderStyle.HAIR);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置字体</span></span><br><span class="line"><span class="comment">// 创建字体对象</span></span><br><span class="line"><span class="type">Font</span> <span class="variable">font</span> <span class="operator">=</span> workbook.createFont();</span><br><span class="line"><span class="comment">// 设置字体</span></span><br><span class="line">font.setFontName(<span class="string">&quot;仿宋&quot;</span>);</span><br><span class="line"><span class="comment">// 设置字号</span></span><br><span class="line">font.setFontHeightInPoints((<span class="type">short</span>) <span class="number">28</span>);</span><br><span class="line">cellStyle.setFont(font);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置宽高</span></span><br><span class="line"><span class="comment">// 设置第一列的宽度是 31 个字符宽度</span></span><br><span class="line">sheet.setColumnWidth(<span class="number">0</span>,<span class="number">31</span>*<span class="number">256</span>);</span><br><span class="line"><span class="comment">// 设置行的高度是 50 个点</span></span><br><span class="line">row.setHeightInPoints(<span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置居中显示</span></span><br><span class="line"><span class="comment">// 水平居中</span></span><br><span class="line">cellStyle.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line"><span class="comment">// 垂直居中</span></span><br><span class="line">cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置单元格样式</span></span><br><span class="line">cell.setCellStyle(cellStyle);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 合并单元格</span></span><br><span class="line"><span class="type">CellRangeAddress</span> <span class="variable">region</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CellRangeAddress</span>(<span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">sheet.addMergedRegion(region);</span><br><span class="line">fileOutputStream.close();</span><br></pre></td></tr></table></figure><h3 id="绘制图形"><a class="header-anchor" href="#绘制图形">¶</a>绘制图形</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">XSSFWorkbook</span> <span class="variable">workbook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>();</span><br><span class="line"><span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> workbook.createSheet(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="comment">// 读取图片</span></span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;/Users/humingchao/IdeaProjects/SaaS_ihrm/poiTest/p1.jpg&quot;</span>);</span><br><span class="line"><span class="type">byte</span>[] bytes = IOUtils.toByteArray(fileInputStream);</span><br><span class="line">fileInputStream.read(bytes);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向 POI 内存添加一张图片，并返回该图片在 Excel 中的图片集合中的下标</span></span><br><span class="line"><span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> workbook.addPicture(bytes, Workbook.PICTURE_TYPE_JPEG);</span><br><span class="line"><span class="comment">// 绘制图片工具类</span></span><br><span class="line"><span class="type">XSSFCreationHelper</span> <span class="variable">helper</span> <span class="operator">=</span> workbook.getCreationHelper();</span><br><span class="line"><span class="comment">// 创建一个绘图对象</span></span><br><span class="line">Drawing&lt;?&gt; patriarch = sheet.createDrawingPatriarch();</span><br><span class="line"><span class="comment">// 创建锚点，设置图片坐标</span></span><br><span class="line"><span class="type">ClientAnchor</span> <span class="variable">anchor</span> <span class="operator">=</span> helper.createClientAnchor();</span><br><span class="line"><span class="comment">// 行从 0 开始</span></span><br><span class="line">anchor.setRow1(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 列从 0 开始</span></span><br><span class="line">anchor.setCol1(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建图片</span></span><br><span class="line"><span class="type">Picture</span> <span class="variable">picture</span> <span class="operator">=</span> patriarch.createPicture(anchor, index);</span><br><span class="line">picture.resize();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件流</span></span><br><span class="line"><span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;test3.xlsx&quot;</span>);</span><br><span class="line"><span class="comment">// 写入文件</span></span><br><span class="line">workbook.write(fileOutputStream);</span><br><span class="line">fileOutputStream.close();</span><br></pre></td></tr></table></figure><h3 id="加载-Excel"><a class="header-anchor" href="#加载-Excel">¶</a>加载 Excel</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">   <span class="comment">// 创建 workbook 工作簿</span></span><br><span class="line">   <span class="type">XSSFWorkbook</span> <span class="variable">workbook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>(<span class="string">&quot;demo.xlsx&quot;</span>);</span><br><span class="line">   <span class="comment">// 获取 sheet 从 0 开始</span></span><br><span class="line">   <span class="type">Sheet</span> <span class="variable">sheet</span> <span class="operator">=</span> workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">   <span class="type">int</span> <span class="variable">totalRowNum</span> <span class="operator">=</span> sheet.getLastRowNum();</span><br><span class="line"></span><br><span class="line">   <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">   <span class="type">Cell</span> <span class="variable">cell</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 循环所有行</span></span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">rowNum</span> <span class="operator">=</span> <span class="number">0</span>; rowNum &lt;=sheet.getLastRowNum(); rowNum++) &#123;</span><br><span class="line">      row = sheet.getRow(rowNum);</span><br><span class="line">      <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">     <span class="comment">// 循环每行中的所有单元格</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">cellNum</span> <span class="operator">=</span> <span class="number">2</span>; cellNum &lt; row.getLastCellNum(); cellNum++) &#123;</span><br><span class="line">         cell = row.getCell(cellNum);</span><br><span class="line">         stringBuilder.append(getValue(cell)).append(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      System.out.println(stringBuilder.toString());</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数据</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getValue</span><span class="params">(Cell cell)</span> &#123;</span><br><span class="line">   <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">   <span class="keyword">switch</span> (cell.getCellType()) &#123;</span><br><span class="line">      <span class="keyword">case</span> STRING:</span><br><span class="line">         value = cell.getStringCellValue();</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> BOOLEAN:</span><br><span class="line">         value = cell.getBooleanCellValue();</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">		<span class="comment">// 数字类型（包含日期和普通数字）</span></span><br><span class="line">     <span class="keyword">case</span> NUMERIC:</span><br><span class="line">         <span class="keyword">if</span> (DateUtil.isCellDateFormatted(cell)) &#123;</span><br><span class="line">            value = cell.getDateCellValue();</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            value = cell.getNumericCellValue();</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">		<span class="comment">// 公式类型</span></span><br><span class="line">     <span class="keyword">case</span> FORMULA:</span><br><span class="line">         value = cell.getCellFormula();</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="模版打印"><a class="header-anchor" href="#模版打印">¶</a>模版打印</h2><p>自定义生成 Excel 报表文件还是有很多不尽如意的地方，特别是针对复杂报表头，单元格样式，字体等操作。手写这些代码不仅费时费力，有时候效果还不太理想。</p><p>❓ 那怎么样才能更方便的对报表样式，报表头进行处理呢?</p><p>答案是使用已经准备好的 Excel 模板，只需要关注模板中的数据即可</p><p>⛵ 模版打印的操作步骤</p><ol><li>制作模版文件（模版文件的路径）</li><li>导入（加载）模版文件，从而得到一个工作簿</li><li>读取工作表</li><li>读取行</li><li>读取单元格</li><li>读取单元格样式</li><li>设置单元格内容</li><li>其他单元格就可以使用读到的样式了</li></ol></div></div><div id="post-footer" class="post-footer main-content-wrap"><div class="post-footer-tags"><span class="text-color-light text-small">标签</span><br><a class="tag tag--primary tag--small t-none-link" href="/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" rel="tag">杂七杂八</a></div><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mysql-%E4%BA%94-%E7%AE%80%E5%8D%95%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E6%B5%81%E7%A8%8B/" data-tooltip="MySQL(五)简单更新语句流程" aria-label="上一篇: MySQL(五)简单更新语句流程"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">上一篇</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E5%AE%8C%E7%BE%8E%E6%B4%97%E7%89%8C%E7%AE%97%E6%B3%95/" data-tooltip="完美洗牌算法" aria-label="下一篇: 完美洗牌算法"><span class="hide-xs hide-sm text-small icon-mr">下一篇</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></article><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><footer id="footer" class="main-content-wrap"><span class="copyrights">Copyrights &copy; 2023 pineapple-man. All Rights Reserved.</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><br>Total <span id="busuanzi_value_site_pv"></span> views. 您是pineapple-man的第<span id="busuanzi_value_site_uv"></span>个小伙伴<br><i class="fas fa-book-open"></i> <span class="post-count">博客字数统计：370.7k</span><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></footer></div><div id="bottom-bar" class="post-bottom-bar" data-behavior="5"><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mysql-%E4%BA%94-%E7%AE%80%E5%8D%95%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E6%B5%81%E7%A8%8B/" data-tooltip="MySQL(五)简单更新语句流程" aria-label="上一篇: MySQL(五)简单更新语句流程"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">上一篇</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E5%AE%8C%E7%BE%8E%E6%B4%97%E7%89%8C%E7%AE%97%E6%B3%95/" data-tooltip="完美洗牌算法" aria-label="下一篇: 完美洗牌算法"><span class="hide-xs hide-sm text-small icon-mr">下一篇</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></div><div id="about"><div id="about-card"><div id="about-btn-close"><i class="fa fa-times"></i></div><img id="about-card-picture" src="/assets/images/logo.png" alt="作者的图片"><h4 id="about-card-name">pineapple-man</h4><div id="about-card-bio"><p>做一个菠萝：站得笔直，头戴王冠，内心甜美</p></div><div id="about-card-job"><i class="fa fa-briefcase"></i><br><p>刚毕业就失业</p></div><div id="about-card-location"><i class="fa fa-map-marker-alt"></i><br>西安</div></div></div><div id="cover" style="background-image:url(/assets/images/cover-v1.2.0.jpg)"></div><script src="/assets/js/script-kcoiyt1nxfue7qgcpkrcixymglcc3cuxeg98fy01hqww4nblnhd2ees6j6yc.min.js"></script></body></html>