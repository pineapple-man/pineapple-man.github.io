<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="pineapple-man"><title>MySQL(二)DQL 数据查询语言 - pineapple-man</title><meta name="author" content="pineapple-man"><meta name="keywords" content="mysql"><link rel="icon" href="https://pineapple-man.github.io/assets/images/logo.svg"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png"},"articleBody":"\n¶概述\n❓ 什么是 DQL 数据查询语言？\n数据库的核心操作之一就是提供给使用者进行查询，和基础编程语言的语法相同，向数据库中查询相关的数据，也需要遵从一定的语法规范，这种语法规范而后就形成了 DQL 语言，所以本文主要考虑如何使用 DQL 语言，从数据库查询出满意的数据。\n\n¶基础查询\n1select 查询列表 from 表名;\n✨ 查询语句具有以下特点：\n\n查询结果集，返回的是一个虚拟表，select 查询列表类似于 Java 中的 sout\n执行顺序：先from后select\n查询列表可以是：字段、表达式、常量、函数等\n\n\n12345678#查询列表是常数SELECT 100;#查询列表是表达式，常数不需要加单引号，如果是字段或字符需要加单引号SELECT 100%2;#查询列表是字段SELECT `first_name`,`last_name`,`email` FROM `employees` ;#查询列表是函数SELECT DATABASE();\n❓ 如何查找一个表的全部字段？\n1SELECT * FROM `employees`;\t#此种方法虽然便于书写但是语意不明确\n¶查询列表是查询函数\n🎶 查询列表是一个函数，表示查询时调用函数，并获取函数的返回值\n123SELECT DATABASE();  #查看当前正在使用的数据库SELECT VERSION();   #查看MySQL的版本SELECT USER();      #查看当前登录数据库的用户\n¶查询列表起别名\n进行查询时，表中字段名表达的语义不够直接、明确，可以使用别名对查询的字段重命名。设置字段别名主要有两种方式：使用 AS 关键字和使用空格分隔\n1234# 方式一：使用AS关键字SELECT USER() AS &#x27;姓 名&#x27;;\t#此时返回虚拟表中的列名，从user()变为姓名# 方式二：使用空格分隔SELECT USER() &#x27;姓 名&#x27;;\n¶字段拼接\n❓如果想将查询结果中两列结果合并，如何进行？\n✨ +在不同场景下的不同作用：\n\nJava 中有两种作用：加法运算以及字符串拼接\nMySQL 中，只有一种作用：进行加法运算\n\n\n🎶 MySQL 中+运算结果\n\n\n\n加号两边操作数类型\n结果\n举例\n\n\n\n\n数值型\n数值\n100+1.5 ===&gt; 101.5\n\n\n其中一个操作数为字符型\n字符型看作 0，之后进行加法运算\n‘张三’+100 ===&gt; 100\n\n\n其中一个操作数为 null\nnull\nnull+100 ===&gt; null\n\n\n\n1SELECT CONCAT(first_name,last_name) FROM employees;\n¶查看表的结构\n12DESC employees;show columns from employees;\n¶条件查询\n1SELECT 查询列表 FROM 表名 WHERE 筛选条件;\n✨特点：\n\n执行顺序：FROM–&gt;WHERE–&gt;SELECT\n筛选条件可以是关系表达式: &gt;, &gt;=, &lt;, &lt;=, =, &lt;&gt;,虽然!=也可以，但是不推荐 ​​\n筛选条件可以是逻辑表达式:and,or,not\n模糊查询:like,in,between and,is null\n\n\n¶关系表达式筛选\n案例 1：查询部门编号不是 100 的员工信息\n123SELECT *FROM employeesWHERE department_id &lt;&gt; 100;\n#案例 2：查询工资&lt;15000 的姓名、工资\n123SELECT CONCAT(last_name, first_name) AS &#x27;姓 名&#x27;,salaryFROM employeesWHERE salary&lt;15000;\n\n¶逻辑表达式筛选\n案例 1：查询部门编号不是 50-100 之间员工姓名、部门编号、邮箱\n12345678#方式1：SELECT last_name,department_id,emailFROM employeesWHERE department_id &lt;50 OR department_id&gt;100;#方式2：SELECT last_name,department_id,emailFROM employeesWHERE NOT(department_id&gt;=50 AND department_id&lt;=100);\n案例 2：查询奖金率&gt;0.03 或者 员工编号在 60-110 之间的员工信息\n12SELECT * FROM employeesWHERE commission_pct&gt;0.03 OR (employee_id&gt;=60 AND employee_id&lt;=100);\n\n¶模糊查询\n模糊查询主要进行模糊搜索依赖于 like 、in 等关键字以及一些其他的符号\n¶like\nlike 关键字通常和通配符搭配使用，对字符型数据进行部分匹配查询\n12WHERE 字段 LIKE &#x27;匹配字符串&#x27;;WHERE 字段 NOT LIKE &#x27;匹配字符串&#x27;;\n¶常见的通配符\n\n\n\n通配符\n含义\n\n\n\n\n_（下划线）\n任意单个字符\n\n\n%(百分号)\n任意多个字符，0-多个\n\n\n\n案例 1：查询姓中包含字符 a 的员工信息\n1SELECT * FROM employees WHERE last_name LIKE &#x27;%a%&#x27;;\n案例 2：查询姓中包含最后一个字符为 e 的员工信息\n1SELECT * FROM employees WHERE last_name LIKE &#x27;%e&#x27;;\n案例 3：查询姓中包含第一个字符为 e 的员工信息\n1SELECT * FROM employees WHERE\tlast_name LIKE &#x27;e%&#x27;;\n案例 4：查询姓中包含第三个字符为 x 的员工信息\n1SELECT * FROM employees WHERE last_name LIKE &#x27;__x%&#x27;;\n案例 5：查询姓名中包含第二个字符为_的员工信息\n1234#方式一，默认选用\\作为转义字符SELECT * FROM employees WHERE last_name LIKE &#x27;_\\_%&#x27;;#方式二，自定义转义字符SELECT * FROM employees WHERE last_name LIKE &#x27;_$_%&#x27; ESCAPE &#x27;$&#x27;;\n\n¶in\n🎶 in 关键字用于查询某字段的值是否属于指定的列表之内\n12WHERE 字段 IN(a,b,c);WHERE 字段 NOT IN(a,b,c);\n案例 1：查询部门编号是 30/50/90 的员工名、部门编号\n123SELECT * FROM employees WHERE department_id IN(30,50,90);SELECT * FROM employeesWHERE department_id=30 OR department_id=50 OR department_id=90;\n案例 2：查询工种编号不是 SH_CLERK 或 IT_PROG 的员工信息\n12SELECT * FROM employees WHERE job_id NOT IN(&#x27;SH_CLERK&#x27;,&#x27;IT_PROG&#x27;);SELECT * FROM employees WHERE NOT(job_id =&#x27;SH_CLERK&#x27; OR job_id=&#x27;IT_PROG&#x27;);\n\n¶between A AND B\n🎶 betweem and 关键字用于判断某个字段的值是否介于[A,B]之间\n12WHERE 字段 between minNUmber AND maxNumber;WHERE 字段 NOT between minNUmber AND maxNumber;\n案例 1：查询部门编号是 30-90 之间的部门编号、员工姓名\n12SELECT * FROM employees WHERE department_id BETWEEN 30 AND 90;SELECT * FROM employees WHERE department_id&gt;=30 AND department_id&lt;=90;\n案例 2：查询年薪不是 100000-200000 之间的员工姓名、工资、年薪\n12SELECT * FROM employeesWHERE salary*(12+IFNULL(commission_pct,0)) NOT BETWEEN 10000 AND 20000;\n\n¶is null\n🎶 is null 用于判断当前字段是否为空\n案例 1：查询没有奖金的员工信息\n1SELECT * FROM employees WHERE commission_pct IS NULL;\n案例 2：查询有奖金的员工信息\n1SELECT * FROM employees WHERE commission_pct IS NOT NULL;\n\n🎶 =与IS的区别：\n\n=：只能判断普通的内容\nIS只能判断 NULL 值\n&lt;=&gt;安全等于，既能判断普通内容，又能判断 NULL 值，符合表达意义不明确，不推荐使用\n\n\n¶字段控制查询（dintinct）\n🎶 distinct 关键字用于去除重复记录\n需求：查询员工涉及到的部门编号有哪些\n1SELECT DISTINCT department_id FROM employees;\n\n¶排序查询\n¶基本格式\n1SELECT 查询列表,FROM 表名,[WHERE 筛选条件],ORDER BY 排序列表 &lt;ASC|DESC&gt;\n✨特点：\n\n执行顺序: FROM --&gt; WHERE --&gt; SELECT --&gt; ORDER BY (所以排序列表可以使用别名)\n排序列表可以是：单个字段、多个字段、表达式、函数、以及这些列表的组合\n排序方式有两种：升序（ASC，默认行为）、降序(DESC)\n\n\n¶按照单个字段排序\n案例 1：将员工编号&gt;120 的员工信息进行工资的升序(降序)\n12select * from employees where employee_id&gt;120 ORDER BY salary;SELECT * FROM employees WHERE employee_id&gt;120 ORDER BY salary DESC;\n\n¶按照表达式排序\n案例 1：对有奖金的员工，按年薪降序\n1234567select  *,  salary * (1+ ifnull(commission_pct, 0)) as &#x27;年薪&#x27;from  employeeswhere commission_pct is not nullorder by salary * (1+ ifnull(commission_pct, 0)) desc ;\n\n¶按照别名排序\n案例 1：对有奖金的员工，按年薪降序\n1234567SELECT  *,  salary * (1+ commission_pct) AS &#x27;年薪&#x27;FROM  employeesWHERE commission_pct IS NOT NULLORDER BY 年薪 DESC ;\n\n¶按照函数的结果排序\n案例 1：按姓名的字数长度进行升序\n1SELECT * FROM employees\tORDER BY LENGTH(last_name);\n\n¶按照多个字段排序\n案例 1：查询员工的姓名、工资、部门编号，先按工资升序，再按部门编号降序\n12345678SELECT  last_name,  salary,  department_idFROM  employeesORDER BY salary ASC,  department_id DESC ;\n\n¶常见函数（单行函数）\n🎶函数类似于 JAVA 中的方法，为了解决某个问题，将编写的一系列命令集合封装在一起，对外仅暴露方法名，供外部调用。常见函数拥有如下几类:\n\n¶字符函数\n主要记录对字符串进行操作的常用函数\n\n\n\n函数\n作用\n\n\n\n\nCONCAT()\n拼接字符串\n\n\nLENGTH()\n获取字符长度\n\n\nCHAR_LENGTH()\n获取字符个数\n\n\nSUBSTRING()\n截取子串，MySQL 中子串的开始索引为1\n\n\nINSTR()\n获取字符第一次出现的索引\n\n\nTRIM()\n去除前后指定的字符，默认是空格\n\n\nLPAD()\n按照指定长度，分别对字符串的左端，补充字符\n\n\nRPAD()\n按照指定长度，分别对字符串的右端，补充字符\n\n\nUPPER()\n将字符变为大写\n\n\nLOWER()\n将字符变为小写\n\n\nSTRCMP()\n比较两个字符大小，使用 ASCII 码值比较，前者减后者\n\n\nLEFT()\n从左边截取子串\n\n\nRIGHT()\n从右边截取子串\n\n\n\n12#将多个字符串进行拼接,如果其中一个字符是null,拼接结果就是nullCONCAT(str1,str2,...)\n12ELECT length(&#x27;hello,世界&#x27;);#结果:\t12\n12SELECT CHAR_LENGTH(&#x27;hello,世界&#x27;);#结果:\t8\n12345SUBSTRING(str,pos,len);\t#JAVA函数格式，从str串的pos位置截取len长度的子串，SUBSTRING(str,pos);\t\t#JAVA函数格式，截取str串从pos开始到结尾的子串SUBSTRING(str FROM pos);#SQL函数格式，作用同格式2SELECT SUBSTRING(&#x27;hello,世界&#x27;,2);#结果： ello,世界\n12SELECT\tINSTR(&#x27;hello world ,oh! hohoho&#x27;,&#x27;o&#x27;);#结果:\t5\n123456TRIM(str);TRIM([&#x27;removStr&#x27; FROM ]str);SELECT TRIM(&#x27;    hello world      &#x27;);#结果:\thello worldSELECT TRIM(&#x27;x&#x27; FROM &#x27;xxxxxxhelloxxxxxworldxxxxxx&#x27;);#结果:\thelloxxxxxworld\n123456LPAD(str,len,padstr);SELECT LPAD(&#x27;hello world&#x27;,15,&#x27;x&#x27;);#结果:\txxxxhello worldRPAD(str,len,padstr);SELECT RPAD(&#x27;hello world&#x27;,15,&#x27;x&#x27;);#结果:\thello worldxxxx\n12SELECT UPPER(&#x27;hello world&#x27;);#结果:\tHELLO WORLD\n12select strcmp(&#x27;a&#x27;,&#x27;b&#x27;);#结果:\t-1\n1234SELECT LEFT(&#x27;hello world&#x27;,1);#结果:\thSELECT RIGHT(&#x27;hello world&#x27;,1);#结果:\td\n¶数学函数\n数学函数用来对数学返回结果进行操作\n\n\n\n函数\n作用\n\n\n\n\nABS()\n求绝对值\n\n\nCEIL()\n向上取整\n\n\nFLOOR()\n向下取整\n\n\nROUND()\n四舍五入取整\n\n\nTRUNCATE()\n小数截断\n\n\nMOD()\n取余\n\n\n\n1select abs(-1);\n1SELECT CEIL(-1.1);\n1SELECT FLOOR(-1.1);\n12SELECT ROUND(1.55);#结果:\t2\n123TRUNCATE(X,D);\t#将X的第D位小数后的精度丢弃SELECT TRUNCATE(1.55,1);#结果:\t1.5\n12SELECT MOD(10,3);#结果:\t1\n¶日期函数\n日期函数用来进行相关的日期操作\n\n\n\n函数\n作用\n\n\n\n\nNOW()\n返回现在的年月日以及时间，NOW() = CONCAT( CURDATE() ,CURTIME() )\n\n\nCURDATE()\n返回当前日期\n\n\nCURTIME()\n返回当前时间\n\n\nDATEDIFF()\n检查两时间的差距,使用前者时间减去后者时间，算出两时间节点间的差值\n\n\nDATE_FORMAT()\n输出特定格式的时间类型\n\n\nSTR_TO_DATE()\n按指定格式解析字符串，将字符类型转为日期类型，而后可以进行关系处理\n\n\n\n\n\n\n\n12SELECT NOW();#2021-03-04 08:45:09\n12SELECT CURDATE();#2021-03-04\n12SELECT CURTIME();#08:46:12\n12SELECT DATEDIFF(&#x27;1998-7-20&#x27;,&#x27;2021-3-3&#x27;);#-8262\n12SELECT DATE_FORMAT(&#x27;1998-7-20&#x27;,&#x27;%Y年%M月%d日 %H小时%i分钟%s秒&#x27;) 出生日期;## 1998年July月20日 00时00分钟00秒\n1SELECT * FROM employees WHERE hiredate&lt;STR_TO_DATE(&#x27;3/15 1998&#x27;,&#x27;%m/%d %Y&#x27;)\n¶流程控制函数\n流程控制函数类似于 Java 中的流程控制语句\n\n\n\n函数\n作用\n\n\n\n\nIF()\n根据条件执行相应的表达式\n\n\nIFNULL(表达式 1,表达式 2)\n如果表达式 1 为 null，则显示表达式 2，否则显示表达式 1\n\n\nCASE 函数\n与 JAVA 中的switch类似，但 MySQL 中的 CASE 函数主要有两种用法\n\n\n\n123SELECT IF(100&gt;9,&#x27;正确&#x27;,&#x27;错误&#x27;);#需求：如果有奖金，则显示最终奖金，如果没有，则显示0SELECT IF(commission_pct IS NOT NULL,salary*(1+commission_pct),0) FROM employees;\n1234567# case 此格式功能与switch功能相似，根据不同值进行处理CASE 表达式WHEN 值1 THEN 结果1WHEN 值2 THEN 结果2...ELSE 结果n\t#等价于Java switch 中的 default子句END\n案例：部门编号是 30，工资显示为 2 倍，部门编号是 50，工资显示为 3 倍，部门编号是 60，工资显示为 4 倍\n12345678select department_id,salary,case department_idwhen 30 then salary*2when 50 THEN salary*3when 60 THEN salary*4else salaryend as &#x27;NewSalary&#x27;from employees;\n\n1234567# 方式二：类似于多重IF语句，实现区间判断CASEWHEN 条件1 THEN 结果1WHEN 条件2 THEN 结果2...ELSE 结果nEND\n案例：如果工资&gt;20000,显示级别 A；工资&gt;15000,显示级别 B；工资&gt;10000,显示级别 C，否则，显示 D\n12345678SELECTCASEWHEN salary&gt;20000 THEN &#x27;A&#x27;WHEN salary&gt;15000 THEN &#x27;B&#x27;WHEN salary&gt;10000 THEN &#x27;C&#x27;ELSE &#x27;D&#x27;END salaryRankFROM employees;\n\n¶分组函数\n说明：分组函数往往用于实现将一组数据进行统计计算，最终得到一个值，又称为聚合函数或统计函数\n\n\n\n函数\n作用\n\n\n\n\nsum(字段名)\n求和\n\n\navg(字段名)\n求平均值\n\n\nmax(字段名)\n求最大值\n\n\nmin(字段名)\n求最小值\n\n\ncount(字段名)\n计算非空字段值的个数\n\n\n\n案例 1 ：查询员工信息表中，所有员工的工资和、工资平均值、最低工资、最高工资、有工资的个数\n12select sum(salary),avg(salary),min(salary),max(salary),count(salary)from employees;\n查询 emp 表中记录数\n1select count(*) from employees;\t#如果一行数据存在非空值，则count(*)就统计一次\n需求：查询有员工的部门个数\n1SELECT COUNT(DISTINCT department_id)FROM employees;\t#count搭配distinct进行分组统计\n\n¶分组查询\n1234SELECT 查询列表 FROM 表名 WHERE 筛选条件GROUP BY 分组列表having 分组后筛选ORDER BY 排序列表\n✨分组查询特点：\n\n执行顺序:FROM --&gt; WHERE --&gt; GROUP BY --&gt; HAVING --&gt; SELECT --&gt; ORDER BY\n查询列表往往是：分组函数和被分组的字段\n分组查询中对条件的筛选分为两类:分组前筛选与分组后筛选\n\n\n\n\n\n分组筛选时机\n筛选的基表\n使用的关键字\n位置\n\n\n\n\n分组前筛选\nFROM 语句中包括的表\nWHERE\nGROUP BY 的前面\n\n\n分组后筛选\n分组后的结果集\nHAVING\nGOUPR BY 的后面\n\n\n\n🎶 分组函数不能放在 WHERE 语句中；如果一个筛选条件同时出现在两个筛选条件中，将此条件放在分组前筛选最佳，这样能够有效的提高查询效率\n\n¶简单分组查询案例\n案例 1：查询每个工种的员工平均工资\n123SELECT AVG(salary),job_idFROM employeesGROUP BY job_id;\n案例 2：查询每个领导的手下人数\n1234SELECT COUNT(*),manager_idFROM employeesWHERE manager_id IS NOT NULLGROUP BY manager_id;\n\n¶分组前筛选案例\n案例 1：查询邮箱中包含 a 字符的 每个部门的最高工资\n1234SELECT MAX(salary),department_idFROM employeesWHERE email LIKE &#x27;%a%&#x27; AND department_id IS NOT NULLGROUP BY department_id;\n案例 2：查询每个领导手下有奖金的员工的平均工资\n1234SELECT manager_id,AVG(salary)FROM employeesWHERE commission_pct IS NOT NULLGROUP BY manager_id\n\n¶分组后筛选案例\n案例 1：查询哪个部门的员工个数&gt;5\n1234SELECT COUNT(*),department_idFROM employeesGROUP BY department_idHAVING COUNT(*)&gt;5;\n案例 2：每个工种有奖金的员工的最高工资&gt;12000 的工种编号和最高工资\n12345SELECT MAX(salary),job_idFROM employeesWHERE commission_pct IS NOT NULLGROUP BY job_idHAVING MAX(salary)&gt;12000;\n案例 3：领导编号&gt;102,每个领导手下的最低工资大于 5000 的最低工资\n12345SELECT MIN(salary),manager_idFROM employeesWHERE manager_id &gt;102GROUP BY manager_idHAVING MIN(salary)&gt;5000;\n\n¶分组后排序案例\n案例：查询没有奖金的员工的最高工资&gt;6000 的工种编号和最高工资,按最高工资升序\n123456SELECT MAX(salary),job_idFROM employeesWHERE commission_pct IS NULLGROUP BY job_idHAVING\tMAX(salary)&gt;6000ORDER BY MAX(salary) ASC;\n¶按照多个字段分组案例\n案例：查询每个工种每个部门的最低工资,并按最低工资降序\n1234select min(salary),job_id,department_idfrom employeesgroup by job_id,department_idorder by min(salary);\n¶连接查询\n连接查询又称为多表查询,当查询语句涉及到的字段来自于多个表时,就会用到连接查询，目前存在的连接查询有两种,分别是sql 92标准与sql 99标准\n¶sql92 标准\n仅支持内连接，内连接的格式如下：\n1234567SELECT 查询列表FROM 表1 别名,表2 别名WHERE 连接条件AND 筛选条件GROUP BY 分组列表HAVING 分组后筛选ORDER BY 排序列表\n✨sql 92 标准下内连接特点: 执行顺序: FROM --&gt; WHERE --&gt; AND --&gt; GROUP BY --&gt; HAVING --&gt; SELECT --&gt; ORDER BY\n¶等值连接\n✨等值连接特点：\n\n多表等值连接的结果为多表的交集部分\nn 表连接，至少需要 n-1 各连接条件\n多表的顺序没有要求\n一般需要为表起别名，加强程序的语义性\n可以搭配前面介绍的所有子句使用，比如排序、分组、筛选\n\n\n案例 1：查询女神名和对应的男神名\n123SELECT NAME,boyNameFROM boys,beautyWHERE beauty.boyfriend_id= boys.id;\n案例 2：查询员工名和对应的部门名\n123SELECT last_name,department_nameFROM employees,departmentsWHERE employees.`department_id`=departments.`department_id`;\n案例 3：查询每个城市的部门个数\n1234SELECT COUNT(*) 个数,cityFROM departments d,locations lWHERE d.`location_id`=l.`location_id`GROUP BY city;\t#连接后进行分组查询\n案例 4：查询每个工种的工种名和员工的个数，并且按员工个数降序\n12345SELECT job_title,COUNT(*)FROM employees e,jobs jWHERE e.`job_id`=j.`job_id`GROUP BY job_titleORDER BY COUNT(*) DESC;\t#连接后进行分组查询且排序\n\n👴对表起别名总是有好处的，可以提高语句的简洁度，区分多个重名的字段；如果对表起了别名，则查询的字段就不能使用原来的表名进行条件筛选\n123456789#如此就会出错，如果存在别名，就不能使用原表名SELECT e.last_name,e.job_id,j.job_titleFROM employees  e,jobs jWHERE employees.`job_id`=jobs.`job_id`;#如此，可以正确查询SELECT e.last_name,e.job_id,j.job_titleFROM employees  e,jobs jWHERE e.`job_id`=j.`job_id`;\n¶非等值连接\n非等值连接中，一个表中的数值落在于另一个表中两列的数值范围中，以此来构成连接\n案例 1：查询员工的工资和工资级别\n1234SELECT e.`salary`,sg.`grade`FROM employees AS e,sal_grade AS sgWHERE e.`salary` BETWEEN sg.`min_salary` AND sg.`max_salary`;#使用BETWEEN...AND...进行非等值间的连接\n\n¶自连接\n查询表来自于自身，自身与自身的连接称之为自连接\n案例：查询员工名和上级的名称\n123SELECT e.employee_id,e.last_name,m.employee_id,m.last_nameFROM employees e,employees mWHERE e.`manager_id`=m.`employee_id`;\n¶sql99 标准\nsql99 支持内连接、外连接(左外和右外)+交叉连接\n\n🎶SQL 99 使用JOIN关键字代替了之前的逗号，并且将连接条件和筛选条件进行了分离，提高了阅读性\n1234567SELECT 查询列表 FROM 表名1 [AS] 别名[INNER] JOIN 表名2 [AS] 别名ON 连接条件WHERE 筛选条件GROUP BY 分组列表HAVING 分组后筛选ORDER BY 排序列表\n¶等值连接\n123456789101112131415161718192021222324252627282930313233343536373839404142#案例1：查询员工名和部门名SELECT last_name,department_nameFROM departments dINNER JOIN  employees eON e.department_id =d.department_id;#案例2：查询部门编号&gt;100的部门名和所在的城市名SELECT department_name,cityFROM departments dJOIN locations lON d.`location_id` = l.`location_id`WHERE d.`department_id`&gt;100;\t#添加筛选条件#案例3：查询每个城市的部门个数SELECT COUNT(*) 部门个数,l.`city`FROM departments dJOIN locations lON d.`location_id`=l.`location_id`GROUP BY l.`city`;\t#添加分组筛选#案例4：查询部门中员工个数&gt;10的部门名，并按员工个数降序SELECT COUNT(*) 员工个数,d.department_nameFROM employees eJOIN departments dON e.`department_id`=d.`department_id`GROUP BY d.`department_id`HAVING 员工个数&gt;10ORDER BY 员工个数 DESC;\t#添加分组、筛选、排序#案例5: 选择city在Toronto工作的员工的last_name , job_id , department_id , department_nameSELECT last_name , job_id , department_id , department_nameFROM employees eJOIN departments d ON e.`department_id` = d.`department_id`JOIN locations l ON d.`location_id` = l.`location_id`\t#多表连接，使用多次join语句WHERE city = &#x27;Toronto&#x27;;#案例6: 查询每个工种、每个部门的部门名、工种名和最低工资select j.`job_title`,d.`department_name`,min(salary)from employees as einner join jobs as j on e.`job_id` = j.`job_id`inner join departments as d on e.`department_id`=d.`department_id`group by j.`job_id`,e.`department_id`\n¶非等值连接\n1234567#案例：查询部门编号在10-90之间的员工的工资级别，并按级别进行分组SELECT COUNT(*) 个数,gradeFROM employees eJOIN sal_grade gON e.`salary` BETWEEN g.`min_salary` AND g.`max_salary`WHERE e.`department_id` BETWEEN 10 AND 90GROUP BY g.grade;\n¶自连接\n12345#案例：查询员工名和对应的领导名SELECT e.`last_name`,m.`last_name`FROM employees eJOIN employees mON e.`manager_id`=m.`employee_id`;\n¶外连接\n✨外连接特点\n\n查询结果为主表中所有的记录，如果从表有匹配项，则显示匹配项；如果从表没有匹配项，则显示 null\n应用场景:一般用于查询主表中有但从表没有的记录\n外连接分主从表，两表的顺序不能任意调换\n左连接的话、left join 左边为主表\n右连接的话、right join 右边为主表\n全连接，将两个表结合在一起，另一方表未出现的数据，均使用NULL代替，MySQL 不支持\n\n\n12345SELECT 查询列表FROM 表1 别名LEFT | RIGHT | FULL [OUTER] JOIN 表2 别名ON 连接条件WHERE 筛选条件\n123456789101112131415161718192021222324#案例1：查询所有女神记录，以及对应的男神名，如果没有对应的男神，则显示为nullselect g.`name`,b.`boyName`from beauty as gleft outer join boys as b on g.`boyfriend_id`=b.`id`;#女生为主表select g.`name`,b.`boyName`from boys as bleft outer join beauty as g on g.`boyfriend_id`=b.`id;`#男生为主表#案例2：查哪个女神没有男朋友select g.`name`from beauty as gleft outer join boys b on g.`boyfriend_id`=b.`id`where b.`boyName` is null;#案例3：查询哪个部门没有员工，并显示其部门编号和部门名SELECT d.`department_id`,d.`department_name`FROM departments dLEFT JOIN employees e ON d.`department_id` = e.`department_id`WHERE e.`employee_id` IS NULLGROUP BY d.`department_id`;#案例4：查询部门名为 SAL 或 IT 的员工信息SELECT d.*,e.*FROM departments dLEFT JOIN employees e ON d.`department_id` = e.`department_id`WHERE d.`department_name` = &#x27;SAL&#x27; OR d.`department_name`=&#x27;IT&#x27;;\n👴使用外连接时一定要清楚主表和从表，以及那些属性可以为空进行判断\n¶交叉连接\n🎶交叉连接返回的结果，是被连接的两个表中所有数据行的笛卡尔积\n123#案例1: Department表中有4个部门，employee表中有4个员工，那么，交叉连接的结果就有16条数据SELECT * FROM 表1CROSS JOIN 表2;\n👴实际开发中，不经常使用交叉连接\n¶子查询\n🎶当一个查询语句中又嵌套了另一个完整的SELECT语句，则被嵌套的 SELECT 语句称为子查询或内查询，外面的 SELECT 语句称为主查询或外查询\n\n✨子查询特点:\n\n子查询放在条件中，要求必须放在条件的右侧\n子查询一般放在小括号中\n子查询的执行优先于主查询\n单行子查询对应单行操作符(&lt;,&lt;=,&gt;,&gt;=,=,&lt;&gt;)\n多行子查询对应多行操作符(any/some,all,in)\n\n\n根据子查询所在位置不同，可以有以下的分类方式：\n\n¶子查询在 where 或 having 后面\n这种方式的子查询又进一步可以分为：单行子查询以及多行子查询\n¶单行子查询\n123456789101112131415161718192021222324252627282930313233343536373839404142#案例1：谁的工资比Abel高?SELECT  `last_name`,  salaryFROM  employeesWHERE salary &gt;  (SELECT    e.`salary`  FROM    employees AS e  WHERE e.`last_name` = &#x27;Abel&#x27;);#案例2：返回job_id与141号员工相同，salary比143号员工多的员工姓名，job_id 和工资SELECT last_name,job_id,salaryFROM employeesWHERE job_id = (\tSELECT job_id\tFROM employees\tWHERE employee_id = 141) AND salary&gt;(\tSELECT salary\tFROM employees\tWHERE employee_id = 143);#案例3：返回公司工资最少的员工的last_name,job_id和salaryselect last_name,job_id,salaryfrom employeeswhere salary = (\tSELECT MIN(salary)\tFROM employees AS e);#案例4：查询最低工资大于50号部门最低工资的部门id和其最低工资SELECT MIN(salary),department_idFROM employeesGROUP BY department_idHAVING MIN(salary)&gt;(\tSELECT MIN(salary)\tFROM employees\tWHERE department_id = 50);\n¶多行子查询\n🎶 多行操作符：in、any/some:判断某字段是否满足其中任意一个数值以及 all:判断某字段的值是否满足里面所有的数值\n123x in(1,2,3,4)x&gt;any(10,20,30,40)\t#只要大于最少值即可x&gt;all(10,20,30,40)\t#需要大于最大值\n案例 1：返回 location_id 是 1400 或 1700 的部门中的所有员工姓名\n1234SELECT last_name FROM employeesWHERE department_id IN  (SELECT department_id FROM departments  WHERE location_id IN (1400, 1700));\n案例 2：返回其它部门中比 job_id 为‘IT_PROG’部门任一工资低的员工的员工号、姓名、job_id 以及 salary\n1234567SELECT employee_id,last_name,job_id,salaryFROM employeesWHERE salary&lt;ANY(\tSELECT DISTINCT salary\tFROM employees\tWHERE job_id = &#x27;IT_PROG&#x27;);\n\n¶子查询在 SELECT 后面\n12345#案例；查询部门编号是50的员工个数SELECT(SELECT COUNT(*)FROM employeesWHERE department_id=50);\n¶子查询在 FROM 后面\n1234567#案例：查询每个部门的平均工资的工资级别select grade_levelfrom job_grades inner join (select avg(salary) avgs,department_idfrom employeesgroup by department_id) ag on ag.avgs between lowest_sal and highest_sal\n¶放在 exists 后面\n12#案例1 ：查询有无名字叫“张三丰”的员工信息select exists(SELECT last_name FROM employees WHERE last_name=&#x27;张三丰&#x27;);\n¶分页查询\n当页面上的数据，一页显示不全，则需要分页显示，基本格式如下：\n¶分页查询基本框架\n123456789SELECT 查询列表FROM 表1 别名JOIN 表2 别名ON 连接条件WHERE 筛选条件GROUP BY 分组列表HAVING 分组后筛选条件ORDER BY 排序列表LIMIT 起始条目,显示的条目数;\n✨ 分页查询特点\n\n执行顺序: FROM --&gt; JOIN --&gt; ON --&gt; WHERE --&gt; GROUP BY --&gt; HAVING --&gt; SELECT --&gt; ORDER BY --&gt; LIMIT\n起始条目索引默认为0\n\n\n¶分页显示公式\n12#假如要显示的页数时page,每页显示的条目数为sizeSELECT * FROM employees LIMIT (page-1)*size,size;\n案例 1：查询员工信息表的前 5 条\n123select * from employees limit 0,5;#等价于SELECT * FROM employees LIMIT 5;\n案例 2：查询有奖金的，且工资较高的第 11 名到第 20 名\n123SELECT * FROM employees WHERE commission_pct IS NOT NULLORDER BY salary DESCLIMIT 10,10 ;\n\n¶联合查询\n当查询结果来自于多张表，单多张表之间没有关联，这个适合就需要使用联合查询，也成为 union 查询\n123SELECT 查询列表 FROM 表1  WHERE 筛选条件UNIONSELECT 查询列表 FROM 表2  WHERE 筛选条件\n✨联合查询特点\n\n多条待联合的查询语句的查询列数必须一致，查询类型、字段含义最好一致\nunion：默认去重查询，union all:实现全部查询，包含重复项\n\n\n案例：查询所有国家的年龄&gt;20 岁的用户信息\n12SELECT * FROM usa WHERE uage &gt;20 UNIONSELECT * FROM chinese WHERE age &gt;20 ;\n案例 2：union 自动去重/union all 可以支持重复项\n123SELECT 1,&#x27;重复项1&#x27;UNION ALLSELECT 1,&#x27;重复项1&#x27;\n\n","dateCreated":"2022-01-27T09:18:46+00:00","dateModified":"2023-06-07T02:13:34+00:00","datePublished":"2022-01-27T09:18:46+00:00","description":"mysql DQL 数据查询语言，用来查询记录是学习 SQL 的重点之一","headline":"MySQL(二)DQL 数据查询语言","image":["https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/mysql.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://pineapple-man.github.io/mysql-%E4%BA%8C-dql-%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80/"},"publisher":{"@type":"Organization","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png","logo":{"@type":"ImageObject","url":"logo.png"}},"url":"https://pineapple-man.github.io/mysql-%E4%BA%8C-dql-%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80/","keywords":"MySQL","thumbnailUrl":"https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/mysql.jpg"}</script><meta name="description" content="mysql DQL 数据查询语言，用来查询记录是学习 SQL 的重点之一"><meta property="og:type" content="blog"><meta property="og:title" content="MySQL(二)DQL 数据查询语言"><meta property="og:url" content="https://pineapple-man.github.io/mysql-%E4%BA%8C-dql-%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80/"><meta property="og:site_name" content="pineapple-man"><meta property="og:description" content="mysql DQL 数据查询语言，用来查询记录是学习 SQL 的重点之一"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/MySQL%E5%87%BD%E6%95%B0.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/SQL99%E6%A0%87%E5%87%86.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/subQueryCategory.png"><meta property="article:published_time" content="2022-01-27T09:18:46.000Z"><meta property="article:modified_time" content="2023-06-07T02:13:34.007Z"><meta property="article:author" content="pineapple-man"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/MySQL%E5%87%BD%E6%95%B0.png"><meta property="og:image" content="https://pineapple-man.github.io/assets/images/logo.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/mysql.jpg"><meta class="swiftype" name="image" data-type="enum" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/mysql.jpg"><link rel="stylesheet" href="/assets/css/style-oth3meuzcjopbgwqbdvoxqknhcm0sy9wkullcc94zhkkop3pmfrpl5t4fzzz.min.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-210516333-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-210516333-1")</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"></head><body><div id="blog"><header id="header" data-behavior="5"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><div class="header-title"><a class="header-title-link" href="/" aria-label="">pineapple-man</a></div><a class="header-right-picture" href="#about" aria-label="打开链接: /#about"><img class="header-picture" src="/assets/images/logo.png" alt="作者的图片"></a></header><nav id="sidebar" data-behavior="5"><div class="sidebar-container"><div class="sidebar-profile"><a href="/#about" aria-label="阅读有关作者的更多信息"><img class="sidebar-profile-picture" src="/assets/images/logo.png" alt="作者的图片"></a><h4 class="sidebar-profile-name">pineapple-man</h4><h5 class="sidebar-profile-bio"><p>做一个菠萝：站得笔直，头戴王冠，内心甜美</p></h5></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="/" rel="noopener" title="首页"><i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i> <span class="sidebar-button-desc">首页</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-categories" rel="noopener" title="分类"><i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i> <span class="sidebar-button-desc">分类</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-tags" rel="noopener" title="标签"><i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i> <span class="sidebar-button-desc">标签</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-archives" rel="noopener" title="归档"><i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i> <span class="sidebar-button-desc">归档</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="#about" rel="noopener" title="关于"><i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i> <span class="sidebar-button-desc">关于</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="https://github.com/pineapple-man" target="_blank" rel="noopener" title="GitHub"><i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i> <span class="sidebar-button-desc">GitHub</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="mailto://mingchaohu720@gmail.com" target="_blank" rel="noopener" title="邮箱"><i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i> <span class="sidebar-button-desc">邮箱</span></a></li></ul></div></nav><div id="main" data-behavior="5" class="hasCoverMetaIn"><article class="post"><div class="post-header main-content-wrap text-center"><h1 class="post-title">MySQL(二)DQL 数据查询语言</h1><div class="post-meta"><time datetime="2022-01-27T09:18:46+00:00">1月 27, 2022 </time><span>发布在 </span><a class="category-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a> <i class="fas fa-book-open"></i> 本文共<span class="post-count"> 6.6k </span>字 <i class="far fa-clock"></i> 阅读预计<span class="post-count"> 69 </span>分钟</div></div><div class="post-content markdown"><div class="main-content-wrap"><h1 id="table-of-contents">目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2"><span class="toc-text">基础查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%88%97%E8%A1%A8%E6%98%AF%E6%9F%A5%E8%AF%A2%E5%87%BD%E6%95%B0"><span class="toc-text">查询列表是查询函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%88%97%E8%A1%A8%E8%B5%B7%E5%88%AB%E5%90%8D"><span class="toc-text">查询列表起别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E6%8B%BC%E6%8E%A5"><span class="toc-text">字段拼接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-text">查看表的结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text">条件查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%AD%9B%E9%80%89"><span class="toc-text">关系表达式筛选</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%AD%9B%E9%80%89"><span class="toc-text">逻辑表达式筛选</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-text">模糊查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#like"><span class="toc-text">like</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-text">常见的通配符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#in"><span class="toc-text">in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#between-A-AND-B"><span class="toc-text">between A AND B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#is-null"><span class="toc-text">is null</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E6%8E%A7%E5%88%B6%E6%9F%A5%E8%AF%A2%EF%BC%88dintinct%EF%BC%89"><span class="toc-text">字段控制查询（dintinct）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-text">排序查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A0%BC%E5%BC%8F"><span class="toc-text">基本格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E5%8D%95%E4%B8%AA%E5%AD%97%E6%AE%B5%E6%8E%92%E5%BA%8F"><span class="toc-text">按照单个字段排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8E%92%E5%BA%8F"><span class="toc-text">按照表达式排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E5%88%AB%E5%90%8D%E6%8E%92%E5%BA%8F"><span class="toc-text">按照别名排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E5%87%BD%E6%95%B0%E7%9A%84%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="toc-text">按照函数的结果排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E5%A4%9A%E4%B8%AA%E5%AD%97%E6%AE%B5%E6%8E%92%E5%BA%8F"><span class="toc-text">按照多个字段排序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0%EF%BC%88%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0%EF%BC%89"><span class="toc-text">常见函数（单行函数）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%87%BD%E6%95%B0"><span class="toc-text">字符函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-text">数学函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-text">日期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-text">流程控制函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-text">分组函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-text">分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="toc-text">简单分组查询案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%89%8D%E7%AD%9B%E9%80%89%E6%A1%88%E4%BE%8B"><span class="toc-text">分组前筛选案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%90%8E%E7%AD%9B%E9%80%89%E6%A1%88%E4%BE%8B"><span class="toc-text">分组后筛选案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%90%8E%E6%8E%92%E5%BA%8F%E6%A1%88%E4%BE%8B"><span class="toc-text">分组后排序案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E5%A4%9A%E4%B8%AA%E5%AD%97%E6%AE%B5%E5%88%86%E7%BB%84%E6%A1%88%E4%BE%8B"><span class="toc-text">按照多个字段分组案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sql92-%E6%A0%87%E5%87%86"><span class="toc-text">sql92 标准</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="toc-text">等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="toc-text">非等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-text">自连接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql99-%E6%A0%87%E5%87%86"><span class="toc-text">sql99 标准</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5-v2"><span class="toc-text">等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5-v2"><span class="toc-text">非等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5-v2"><span class="toc-text">自连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-text">外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5"><span class="toc-text">交叉连接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%9C%A8-where-%E6%88%96-having-%E5%90%8E%E9%9D%A2"><span class="toc-text">子查询在 where 或 having 后面</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">单行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">多行子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%9C%A8-SELECT-%E5%90%8E%E9%9D%A2"><span class="toc-text">子查询在 SELECT 后面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%9C%A8-FROM-%E5%90%8E%E9%9D%A2"><span class="toc-text">子查询在 FROM 后面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BE%E5%9C%A8-exists-%E5%90%8E%E9%9D%A2"><span class="toc-text">放在 exists 后面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">分页查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E5%9F%BA%E6%9C%AC%E6%A1%86%E6%9E%B6"><span class="toc-text">分页查询基本框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%98%BE%E7%A4%BA%E5%85%AC%E5%BC%8F"><span class="toc-text">分页显示公式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-text">联合查询</span></a></li></ol><h2 id="概述"><a class="header-anchor" href="#概述">¶</a>概述</h2><p>❓ 什么是 DQL 数据查询语言？</p><div class="alert success no-icon"><p>数据库的核心操作之一就是提供给使用者进行查询，和基础编程语言的语法相同，向数据库中查询相关的数据，也需要遵从一定的语法规范，这种语法规范而后就形成了 DQL 语言，所以本文主要考虑如何使用 DQL 语言，从数据库查询出满意的数据。</p></div><h2 id="基础查询"><a class="header-anchor" href="#基础查询">¶</a>基础查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 查询列表 <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p>✨ 查询语句具有以下特点：</p><div class="alert success no-icon"><ul><li>查询结果集，返回的是一个虚拟表，select 查询列表类似于 Java 中的 sout</li><li>执行顺序：先<font style="color:red;font-weight:700">from</font>后<font style="color:red;font-weight:700">select</font></li><li>查询列表可以是：字段、表达式、常量、函数等</li></ul></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#查询列表是常数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span>;</span><br><span class="line">#查询列表是表达式，常数不需要加单引号，如果是字段或字符需要加单引号</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span><span class="operator">%</span><span class="number">2</span>;</span><br><span class="line">#查询列表是字段</span><br><span class="line"><span class="keyword">SELECT</span> `first_name`,`last_name`,`email` <span class="keyword">FROM</span> `employees` ;</span><br><span class="line">#查询列表是函数</span><br><span class="line"><span class="keyword">SELECT</span> DATABASE();</span><br></pre></td></tr></table></figure><p>❓ 如何查找一个表的全部字段？</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `employees`;	#此种方法虽然便于书写但是语意不明确</span><br></pre></td></tr></table></figure><h3 id="查询列表是查询函数"><a class="header-anchor" href="#查询列表是查询函数">¶</a>查询列表是查询函数</h3><p>🎶 查询列表是一个函数，表示查询时调用函数，并获取函数的返回值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATABASE();  #查看当前正在使用的数据库</span><br><span class="line"><span class="keyword">SELECT</span> VERSION();   #查看MySQL的版本</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>();      #查看当前登录数据库的用户</span><br></pre></td></tr></table></figure><h3 id="查询列表起别名"><a class="header-anchor" href="#查询列表起别名">¶</a>查询列表起别名</h3><p>进行查询时，表中字段名表达的语义不够直接、明确，可以使用别名对查询的字段重命名。设置字段别名主要有<strong>两种方式</strong>：使用 AS 关键字和使用空格分隔</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 方式一：使用<span class="keyword">AS</span>关键字</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>() <span class="keyword">AS</span> <span class="string">&#x27;姓 名&#x27;</span>;	#此时返回虚拟表中的列名，从<span class="keyword">user</span>()变为姓名</span><br><span class="line"># 方式二：使用空格分隔</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>() <span class="string">&#x27;姓 名&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="字段拼接"><a class="header-anchor" href="#字段拼接">¶</a>字段拼接</h3><p>❓如果想将查询结果中两列结果合并，如何进行？</p><div class="alert success no-icon"><p>✨ <code>+</code>在不同场景下的不同作用：</p><ol><li>Java 中有两种作用：<strong>加法运算</strong>以及<strong>字符串拼接</strong></li><li>MySQL 中，只有一种作用：进行加法运算</li></ol></div><p>🎶 MySQL 中<code>+</code>运算结果</p><table><thead><tr><th style="text-align:center">加号两边操作数类型</th><th style="text-align:center">结果</th><th style="text-align:center">举例</th></tr></thead><tbody><tr><td style="text-align:center">数值型</td><td style="text-align:center">数值</td><td style="text-align:center">100+1.5 ===&gt; 101.5</td></tr><tr><td style="text-align:center">其中一个操作数为字符型</td><td style="text-align:center">字符型看作 0，之后进行加法运算</td><td style="text-align:center">‘张三’+100 ===&gt; 100</td></tr><tr><td style="text-align:center">其中一个操作数为 null</td><td style="text-align:center">null</td><td style="text-align:center">null+100 ===&gt; null</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT(first_name,last_name) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><h3 id="查看表的结构"><a class="header-anchor" href="#查看表的结构">¶</a>查看表的结构</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESC</span> employees;</span><br><span class="line"><span class="keyword">show</span> columns <span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure><h2 id="条件查询"><a class="header-anchor" href="#条件查询">¶</a>条件查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表 <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> 筛选条件;</span><br></pre></td></tr></table></figure><p>✨特点：</p><div class="alert success no-icon"><ol><li>执行顺序：FROM–&gt;WHERE–&gt;SELECT</li><li>筛选条件可以是关系表达式: <code>&gt;, &gt;=, &lt;, &lt;=, =, &lt;&gt;</code>,虽然<code>!=</code>也可以，但是不推荐 ​​</li><li>筛选条件可以是逻辑表达式:<code>and</code>,<code>or</code>,<code>not</code></li><li>模糊查询:<code>like</code>,<code>in</code>,<code>between and</code>,<code>is null</code></li></ol></div><h3 id="关系表达式筛选"><a class="header-anchor" href="#关系表达式筛选">¶</a>关系表达式筛选</h3><div class="alert warning no-icon"><p>案例 1：查询部门编号不是 100 的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">&lt;&gt;</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure><p>#案例 2：查询工资&lt;15000 的姓名、工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT(last_name, first_name) <span class="keyword">AS</span> <span class="string">&#x27;姓 名&#x27;</span>,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&lt;</span><span class="number">15000</span>;</span><br></pre></td></tr></table></figure></div><h3 id="逻辑表达式筛选"><a class="header-anchor" href="#逻辑表达式筛选">¶</a>逻辑表达式筛选</h3><div class="alert warning no-icon"><p>案例 1：查询部门编号不是 50-100 之间员工姓名、部门编号、邮箱</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#方式<span class="number">1</span>：</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_id,email</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">&lt;</span><span class="number">50</span> <span class="keyword">OR</span> department_id<span class="operator">&gt;</span><span class="number">100</span>;</span><br><span class="line">#方式<span class="number">2</span>：</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_id,email</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span>(department_id<span class="operator">&gt;=</span><span class="number">50</span> <span class="keyword">AND</span> department_id<span class="operator">&lt;=</span><span class="number">100</span>);</span><br></pre></td></tr></table></figure><p>案例 2：查询奖金率&gt;0.03 或者 员工编号在 60-110 之间的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct<span class="operator">&gt;</span><span class="number">0.03</span> <span class="keyword">OR</span> (employee_id<span class="operator">&gt;=</span><span class="number">60</span> <span class="keyword">AND</span> employee_id<span class="operator">&lt;=</span><span class="number">100</span>);</span><br></pre></td></tr></table></figure></div><h2 id="模糊查询"><a class="header-anchor" href="#模糊查询">¶</a>模糊查询</h2><p>模糊查询主要进行模糊搜索依赖于 like 、in 等关键字以及一些其他的符号</p><h3 id="like"><a class="header-anchor" href="#like">¶</a>like</h3><p>like 关键字通常和通配符搭配使用，对字符型数据进行部分匹配查询</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">LIKE</span> <span class="string">&#x27;匹配字符串&#x27;</span>;</span><br><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">&#x27;匹配字符串&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="常见的通配符"><a class="header-anchor" href="#常见的通配符">¶</a>常见的通配符</h3><table><thead><tr><th style="text-align:center">通配符</th><th style="text-align:center">含义</th></tr></thead><tbody><tr><td style="text-align:center">_（下划线）</td><td style="text-align:center">任意单个字符</td></tr><tr><td style="text-align:center">%(百分号)</td><td style="text-align:center">任意多个字符，0-多个</td></tr></tbody></table><div class="alert warning no-icon"><p>案例 1：查询姓中包含字符 a 的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>案例 2：查询姓中包含最后一个字符为 e 的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%e&#x27;</span>;</span><br></pre></td></tr></table></figure><p>案例 3：查询姓中包含第一个字符为 e 的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span>	last_name <span class="keyword">LIKE</span> <span class="string">&#x27;e%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>案例 4：查询姓中包含第三个字符为 x 的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;__x%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>案例 5：查询姓名中包含第二个字符为_的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#方式一，默认选用\作为转义字符</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;_\_%&#x27;</span>;</span><br><span class="line">#方式二，自定义转义字符</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;_$_%&#x27;</span> <span class="keyword">ESCAPE</span> <span class="string">&#x27;$&#x27;</span>;</span><br></pre></td></tr></table></figure></div><h3 id="in"><a class="header-anchor" href="#in">¶</a>in</h3><p>🎶 in 关键字用于查询某字段的值是否属于指定的列表之内</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">IN</span>(a,b,c);</span><br><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">NOT</span> <span class="keyword">IN</span>(a,b,c);</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><p>案例 1：查询部门编号是 30/50/90 的员工名、部门编号</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> department_id <span class="keyword">IN</span>(<span class="number">30</span>,<span class="number">50</span>,<span class="number">90</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id<span class="operator">=</span><span class="number">30</span> <span class="keyword">OR</span> department_id<span class="operator">=</span><span class="number">50</span> <span class="keyword">OR</span> department_id<span class="operator">=</span><span class="number">90</span>;</span><br></pre></td></tr></table></figure><p>案例 2：查询工种编号不是 SH_CLERK 或 IT_PROG 的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> job_id <span class="keyword">NOT</span> <span class="keyword">IN</span>(<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="string">&#x27;IT_PROG&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> <span class="keyword">NOT</span>(job_id <span class="operator">=</span><span class="string">&#x27;SH_CLERK&#x27;</span> <span class="keyword">OR</span> job_id<span class="operator">=</span><span class="string">&#x27;IT_PROG&#x27;</span>);</span><br></pre></td></tr></table></figure></div><h3 id="between-A-AND-B"><a class="header-anchor" href="#between-A-AND-B">¶</a>between A AND B</h3><p>🎶 betweem and 关键字用于判断某个字段的值是否介于[A,B]之间</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">between</span> minNUmber <span class="keyword">AND</span> maxNumber;</span><br><span class="line"><span class="keyword">WHERE</span> 字段 <span class="keyword">NOT</span> <span class="keyword">between</span> minNUmber <span class="keyword">AND</span> maxNumber;</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><p>案例 1：查询部门编号是 30-90 之间的部门编号、员工姓名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> department_id <span class="keyword">BETWEEN</span> <span class="number">30</span> <span class="keyword">AND</span> <span class="number">90</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> department_id<span class="operator">&gt;=</span><span class="number">30</span> <span class="keyword">AND</span> department_id<span class="operator">&lt;=</span><span class="number">90</span>;</span><br></pre></td></tr></table></figure><p>案例 2：查询年薪不是 100000-200000 之间的员工姓名、工资、年薪</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">*</span>(<span class="number">12</span><span class="operator">+</span>IFNULL(commission_pct,<span class="number">0</span>)) <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="number">10000</span> <span class="keyword">AND</span> <span class="number">20000</span>;</span><br></pre></td></tr></table></figure></div><h3 id="is-null"><a class="header-anchor" href="#is-null">¶</a>is null</h3><p>🎶 is null 用于判断当前字段是否为空</p><div class="alert warning no-icon"><p>案例 1：查询没有奖金的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><p>案例 2：查询有奖金的员工信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure></div><p>🎶 <code>=</code>与<code>IS</code>的区别：</p><div class="alert success no-icon"><ul><li><code>=</code>：只能判断普通的内容</li><li><code>IS</code>只能判断 NULL 值</li><li>&lt;=&gt;安全等于，既能判断普通内容，又能判断 NULL 值，符合表达意义不明确，不推荐使用</li></ul></div><h2 id="字段控制查询（dintinct）"><a class="header-anchor" href="#字段控制查询（dintinct）">¶</a>字段控制查询（dintinct）</h2><p>🎶 distinct 关键字用于去除重复记录</p><div class="alert warning no-icon"><p>需求：查询员工涉及到的部门编号有哪些</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure></div><h2 id="排序查询"><a class="header-anchor" href="#排序查询">¶</a>排序查询</h2><h3 id="基本格式"><a class="header-anchor" href="#基本格式">¶</a>基本格式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表,<span class="keyword">FROM</span> 表名,[<span class="keyword">WHERE</span> 筛选条件],<span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序列表 <span class="operator">&lt;</span><span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p>✨特点：</p><div class="alert success no-icon"><ol><li>执行顺序: FROM --&gt; WHERE --&gt; SELECT --&gt; ORDER BY (所以排序列表可以使用别名)</li><li>排序列表可以是：单个字段、多个字段、表达式、函数、以及这些列表的组合</li><li>排序方式有两种：升序（ASC，默认行为）、降序(DESC)</li></ol></div><h3 id="按照单个字段排序"><a class="header-anchor" href="#按照单个字段排序">¶</a>按照单个字段排序</h3><div class="alert warning no-icon"><p>案例 1：将员工编号&gt;120 的员工信息进行工资的升序(降序)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees <span class="keyword">where</span> employee_id<span class="operator">&gt;</span><span class="number">120</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> employee_id<span class="operator">&gt;</span><span class="number">120</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></div><h3 id="按照表达式排序"><a class="header-anchor" href="#按照表达式排序">¶</a>按照表达式排序</h3><div class="alert warning no-icon"><p>案例 1：对有奖金的员工，按年薪降序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="operator">*</span>,</span><br><span class="line">  salary <span class="operator">*</span> (<span class="number">1</span><span class="operator">+</span> ifnull(commission_pct, <span class="number">0</span>)) <span class="keyword">as</span> <span class="string">&#x27;年薪&#x27;</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  employees</span><br><span class="line"><span class="keyword">where</span> commission_pct <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> salary <span class="operator">*</span> (<span class="number">1</span><span class="operator">+</span> ifnull(commission_pct, <span class="number">0</span>)) <span class="keyword">desc</span> ;</span><br></pre></td></tr></table></figure></div><h3 id="按照别名排序"><a class="header-anchor" href="#按照别名排序">¶</a>按照别名排序</h3><div class="alert warning no-icon"><p>案例 1：对有奖金的员工，按年薪降序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="operator">*</span>,</span><br><span class="line">  salary <span class="operator">*</span> (<span class="number">1</span><span class="operator">+</span> commission_pct) <span class="keyword">AS</span> <span class="string">&#x27;年薪&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 年薪 <span class="keyword">DESC</span> ;</span><br></pre></td></tr></table></figure></div><h3 id="按照函数的结果排序"><a class="header-anchor" href="#按照函数的结果排序">¶</a>按照函数的结果排序</h3><div class="alert warning no-icon"><p>案例 1：按姓名的字数长度进行升序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees	<span class="keyword">ORDER</span> <span class="keyword">BY</span> LENGTH(last_name);</span><br></pre></td></tr></table></figure></div><h3 id="按照多个字段排序"><a class="header-anchor" href="#按照多个字段排序">¶</a>按照多个字段排序</h3><div class="alert warning no-icon"><p>案例 1：查询员工的姓名、工资、部门编号，先按工资升序，再按部门编号降序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  last_name,</span><br><span class="line">  salary,</span><br><span class="line">  department_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">ASC</span>,</span><br><span class="line">  department_id <span class="keyword">DESC</span> ;</span><br></pre></td></tr></table></figure></div><h2 id="常见函数（单行函数）"><a class="header-anchor" href="#常见函数（单行函数）">¶</a>常见函数（单行函数）</h2><p>🎶函数类似于 JAVA 中的方法，为了解决某个问题，将编写的一系列命令集合封装在一起，对外仅暴露方法名，供外部调用。常见函数拥有如下几类:</p><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/MySQL%E5%87%BD%E6%95%B0.png" alt=""></p><h3 id="字符函数"><a class="header-anchor" href="#字符函数">¶</a>字符函数</h3><p>主要记录对字符串进行操作的常用函数</p><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">CONCAT()</td><td style="text-align:center">拼接字符串</td></tr><tr><td style="text-align:center">LENGTH()</td><td style="text-align:center">获取字符长度</td></tr><tr><td style="text-align:center">CHAR_LENGTH()</td><td style="text-align:center">获取字符个数</td></tr><tr><td style="text-align:center">SUBSTRING()</td><td style="text-align:center">截取子串，MySQL 中子串的开始索引为<code>1</code></td></tr><tr><td style="text-align:center">INSTR()</td><td style="text-align:center">获取字符第一次出现的索引</td></tr><tr><td style="text-align:center">TRIM()</td><td style="text-align:center">去除前后指定的字符，默认是空格</td></tr><tr><td style="text-align:center">LPAD()</td><td style="text-align:center">按照指定长度，分别对字符串的左端，补充字符</td></tr><tr><td style="text-align:center">RPAD()</td><td style="text-align:center">按照指定长度，分别对字符串的右端，补充字符</td></tr><tr><td style="text-align:center">UPPER()</td><td style="text-align:center">将字符变为大写</td></tr><tr><td style="text-align:center">LOWER()</td><td style="text-align:center">将字符变为小写</td></tr><tr><td style="text-align:center">STRCMP()</td><td style="text-align:center">比较两个字符大小，使用 ASCII 码值比较，前者减后者</td></tr><tr><td style="text-align:center">LEFT()</td><td style="text-align:center">从左边截取子串</td></tr><tr><td style="text-align:center">RIGHT()</td><td style="text-align:center">从右边截取子串</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#将多个字符串进行拼接,如果其中一个字符是<span class="keyword">null</span>,拼接结果就是<span class="keyword">null</span></span><br><span class="line">CONCAT(str1,str2,...)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ELECT length(<span class="string">&#x27;hello,世界&#x27;</span>);</span><br><span class="line">#结果:	<span class="number">12</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CHAR_LENGTH</span>(<span class="string">&#x27;hello,世界&#x27;</span>);</span><br><span class="line">#结果:	<span class="number">8</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SUBSTRING</span>(str,pos,len);	#JAVA函数格式，从str串的pos位置截取len长度的子串，</span><br><span class="line"><span class="built_in">SUBSTRING</span>(str,pos);		#JAVA函数格式，截取str串从pos开始到结尾的子串</span><br><span class="line"><span class="built_in">SUBSTRING</span>(str <span class="keyword">FROM</span> pos);#<span class="keyword">SQL</span>函数格式，作用同格式<span class="number">2</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUBSTRING</span>(<span class="string">&#x27;hello,世界&#x27;</span>,<span class="number">2</span>);</span><br><span class="line">#结果： ello,世界</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>	INSTR(<span class="string">&#x27;hello world ,oh! hohoho&#x27;</span>,<span class="string">&#x27;o&#x27;</span>);</span><br><span class="line">#结果:	<span class="number">5</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">TRIM</span>(str);</span><br><span class="line"><span class="built_in">TRIM</span>([<span class="string">&#x27;removStr&#x27;</span> <span class="keyword">FROM</span> ]str);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">TRIM</span>(<span class="string">&#x27;    hello world      &#x27;</span>);</span><br><span class="line">#结果:	hello world</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">TRIM</span>(<span class="string">&#x27;x&#x27;</span> <span class="keyword">FROM</span> <span class="string">&#x27;xxxxxxhelloxxxxxworldxxxxxx&#x27;</span>);</span><br><span class="line">#结果:	helloxxxxxworld</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LPAD(str,len,padstr);</span><br><span class="line"><span class="keyword">SELECT</span> LPAD(<span class="string">&#x27;hello world&#x27;</span>,<span class="number">15</span>,<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">#结果:	xxxxhello world</span><br><span class="line">RPAD(str,len,padstr);</span><br><span class="line"><span class="keyword">SELECT</span> RPAD(<span class="string">&#x27;hello world&#x27;</span>,<span class="number">15</span>,<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">#结果:	hello worldxxxx</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">UPPER</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">#结果:	HELLO WORLD</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> strcmp(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">#结果:	<span class="number">-1</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(<span class="string">&#x27;hello world&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">#结果:	h</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;hello world&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">#结果:	d</span><br></pre></td></tr></table></figure><h3 id="数学函数"><a class="header-anchor" href="#数学函数">¶</a>数学函数</h3><p>数学函数用来对数学返回结果进行操作</p><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">ABS()</td><td style="text-align:center">求绝对值</td></tr><tr><td style="text-align:center">CEIL()</td><td style="text-align:center">向上取整</td></tr><tr><td style="text-align:center">FLOOR()</td><td style="text-align:center">向下取整</td></tr><tr><td style="text-align:center">ROUND()</td><td style="text-align:center">四舍五入取整</td></tr><tr><td style="text-align:center">TRUNCATE()</td><td style="text-align:center">小数截断</td></tr><tr><td style="text-align:center">MOD()</td><td style="text-align:center">取余</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">abs</span>(<span class="number">-1</span>);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CEIL</span>(<span class="number">-1.1</span>);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">FLOOR</span>(<span class="number">-1.1</span>);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="number">1.55</span>);</span><br><span class="line">#结果:	<span class="number">2</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span>(X,D);	#将X的第D位小数后的精度丢弃</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TRUNCATE</span>(<span class="number">1.55</span>,<span class="number">1</span>);</span><br><span class="line">#结果:	<span class="number">1.5</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MOD</span>(<span class="number">10</span>,<span class="number">3</span>);</span><br><span class="line">#结果:	<span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="日期函数"><a class="header-anchor" href="#日期函数">¶</a>日期函数</h3><p>日期函数用来进行相关的日期操作</p><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">NOW()</td><td style="text-align:center">返回现在的年月日以及时间，NOW() = CONCAT( CURDATE() ,CURTIME() )</td></tr><tr><td style="text-align:center">CURDATE()</td><td style="text-align:center">返回当前日期</td></tr><tr><td style="text-align:center">CURTIME()</td><td style="text-align:center">返回当前时间</td></tr><tr><td style="text-align:center">DATEDIFF()</td><td style="text-align:center">检查两时间的差距,使用前者时间减去后者时间，算出两时间节点间的差值</td></tr><tr><td style="text-align:center">DATE_FORMAT()</td><td style="text-align:center">输出特定格式的时间类型</td></tr><tr><td style="text-align:center">STR_TO_DATE()</td><td style="text-align:center">按指定格式解析字符串，将字符类型转为日期类型，而后可以进行关系处理</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NOW();</span><br><span class="line">#<span class="number">2021</span><span class="number">-03</span><span class="number">-04</span> <span class="number">08</span>:<span class="number">45</span>:<span class="number">09</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CURDATE();</span><br><span class="line">#<span class="number">2021</span><span class="number">-03</span><span class="number">-04</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CURTIME();</span><br><span class="line">#<span class="number">08</span>:<span class="number">46</span>:<span class="number">12</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATEDIFF(<span class="string">&#x27;1998-7-20&#x27;</span>,<span class="string">&#x27;2021-3-3&#x27;</span>);</span><br><span class="line">#<span class="number">-8262</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(<span class="string">&#x27;1998-7-20&#x27;</span>,<span class="string">&#x27;%Y年%M月%d日 %H小时%i分钟%s秒&#x27;</span>) 出生日期;</span><br><span class="line">## <span class="number">1998</span>年July月<span class="number">20</span>日 <span class="number">00</span>时<span class="number">00</span>分钟<span class="number">00</span>秒</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> hiredate<span class="operator">&lt;</span>STR_TO_DATE(<span class="string">&#x27;3/15 1998&#x27;</span>,<span class="string">&#x27;%m/%d %Y&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="流程控制函数"><a class="header-anchor" href="#流程控制函数">¶</a>流程控制函数</h3><p>流程控制函数类似于 Java 中的流程控制语句</p><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">IF()</td><td style="text-align:center">根据条件执行相应的表达式</td></tr><tr><td style="text-align:center">IFNULL(表达式 1,表达式 2)</td><td style="text-align:center">如果表达式 1 为 null，则显示表达式 2，否则显示表达式 1</td></tr><tr><td style="text-align:center">CASE 函数</td><td style="text-align:center">与 JAVA 中的<code>switch</code>类似，但 MySQL 中的 CASE 函数主要有两种用法</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> IF(<span class="number">100</span><span class="operator">&gt;</span><span class="number">9</span>,<span class="string">&#x27;正确&#x27;</span>,<span class="string">&#x27;错误&#x27;</span>);</span><br><span class="line">#需求：如果有奖金，则显示最终奖金，如果没有，则显示<span class="number">0</span></span><br><span class="line"><span class="keyword">SELECT</span> IF(commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,salary<span class="operator">*</span>(<span class="number">1</span><span class="operator">+</span>commission_pct),<span class="number">0</span>) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">case</span> 此格式功能与switch功能相似，根据不同值进行处理</span><br><span class="line"><span class="keyword">CASE</span> 表达式</span><br><span class="line"><span class="keyword">WHEN</span> 值<span class="number">1</span> <span class="keyword">THEN</span> 结果<span class="number">1</span></span><br><span class="line"><span class="keyword">WHEN</span> 值<span class="number">2</span> <span class="keyword">THEN</span> 结果<span class="number">2</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">ELSE</span> 结果n	#等价于Java switch 中的 <span class="keyword">default</span>子句</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><p>案例：部门编号是 30，工资显示为 2 倍，部门编号是 50，工资显示为 3 倍，部门编号是 60，工资显示为 4 倍</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> department_id,salary,</span><br><span class="line"><span class="keyword">case</span> department_id</span><br><span class="line"><span class="keyword">when</span> <span class="number">30</span> <span class="keyword">then</span> salary<span class="operator">*</span><span class="number">2</span></span><br><span class="line"><span class="keyword">when</span> <span class="number">50</span> <span class="keyword">THEN</span> salary<span class="operator">*</span><span class="number">3</span></span><br><span class="line"><span class="keyword">when</span> <span class="number">60</span> <span class="keyword">THEN</span> salary<span class="operator">*</span><span class="number">4</span></span><br><span class="line"><span class="keyword">else</span> salary</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">as</span> <span class="string">&#x27;NewSalary&#x27;</span></span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 方式二：类似于多重IF语句，实现区间判断</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line"><span class="keyword">WHEN</span> 条件<span class="number">1</span> <span class="keyword">THEN</span> 结果<span class="number">1</span></span><br><span class="line"><span class="keyword">WHEN</span> 条件<span class="number">2</span> <span class="keyword">THEN</span> 结果<span class="number">2</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">ELSE</span> 结果n</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><p>案例：如果工资&gt;20000,显示级别 A；工资&gt;15000,显示级别 B；工资&gt;10000,显示级别 C，否则，显示 D</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line"><span class="keyword">WHEN</span> salary<span class="operator">&gt;</span><span class="number">20000</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary<span class="operator">&gt;</span><span class="number">15000</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary<span class="operator">&gt;</span><span class="number">10000</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line"><span class="keyword">END</span> salaryRank</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure></div><h2 id="分组函数"><a class="header-anchor" href="#分组函数">¶</a>分组函数</h2><p>说明：分组函数往往用于实现将一组数据进行统计计算，最终得到一个值，又称为聚合函数或统计函数</p><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">sum(字段名)</td><td style="text-align:center">求和</td></tr><tr><td style="text-align:center">avg(字段名)</td><td style="text-align:center">求平均值</td></tr><tr><td style="text-align:center">max(字段名)</td><td style="text-align:center">求最大值</td></tr><tr><td style="text-align:center">min(字段名)</td><td style="text-align:center">求最小值</td></tr><tr><td style="text-align:center">count(字段名)</td><td style="text-align:center">计算非空字段值的个数</td></tr></tbody></table><div class="alert warning no-icon"><p>案例 1 ：查询员工信息表中，所有员工的工资和、工资平均值、最低工资、最高工资、有工资的个数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(salary),<span class="built_in">avg</span>(salary),<span class="built_in">min</span>(salary),<span class="built_in">max</span>(salary),<span class="built_in">count</span>(salary)</span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure><p>查询 emp 表中记录数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> employees;	#如果一行数据存在非空值，则<span class="built_in">count</span>(<span class="operator">*</span>)就统计一次</span><br></pre></td></tr></table></figure><p>需求：查询有员工的部门个数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> department_id)<span class="keyword">FROM</span> employees;	#count搭配<span class="keyword">distinct</span>进行分组统计</span><br></pre></td></tr></table></figure></div><h2 id="分组查询"><a class="header-anchor" href="#分组查询">¶</a>分组查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表 <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> 筛选条件</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组列表</span><br><span class="line"><span class="keyword">having</span> 分组后筛选</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序列表</span><br></pre></td></tr></table></figure><p>✨分组查询特点：</p><div class="alert success no-icon"><ol><li>执行顺序:FROM --&gt; WHERE --&gt; <font style="color:red;font-weight:700">GROUP BY</font> --&gt; <font style="color:red;font-weight:700">HAVING</font> --&gt; SELECT --&gt; ORDER BY</li><li>查询列表往往是：分组函数和被分组的字段</li><li>分组查询中对条件的筛选分为两类:<code>分组前筛选</code>与<code>分组后筛选</code></li></ol></div><table><thead><tr><th style="text-align:center">分组筛选时机</th><th style="text-align:center">筛选的基表</th><th style="text-align:center">使用的关键字</th><th style="text-align:center">位置</th></tr></thead><tbody><tr><td style="text-align:center">分组前筛选</td><td style="text-align:center">FROM 语句中包括的表</td><td style="text-align:center">WHERE</td><td style="text-align:center">GROUP BY 的前面</td></tr><tr><td style="text-align:center">分组后筛选</td><td style="text-align:center">分组后的结果集</td><td style="text-align:center">HAVING</td><td style="text-align:center">GOUPR BY 的后面</td></tr></tbody></table><div class="alert info no-icon"><p>🎶 <font style="color:red;font-weight:700">分组函数不能放在 WHERE 语句中</font>；如果一个筛选条件同时出现在两个筛选条件中，将此条件放在分组前筛选最佳，这样能够有效的提高查询效率</p></div><h3 id="简单分组查询案例"><a class="header-anchor" href="#简单分组查询案例">¶</a>简单分组查询案例</h3><div class="alert warning no-icon"><p>案例 1：查询每个工种的员工平均工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id;</span><br></pre></td></tr></table></figure><p>案例 2：查询每个领导的手下人数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),manager_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> manager_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> manager_id;</span><br></pre></td></tr></table></figure></div><h3 id="分组前筛选案例"><a class="header-anchor" href="#分组前筛选案例">¶</a>分组前筛选案例</h3><div class="alert warning no-icon"><p>案例 1：查询邮箱中包含 a 字符的 每个部门的最高工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> email <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span> <span class="keyword">AND</span> department_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br></pre></td></tr></table></figure><p>案例 2：查询每个领导手下有奖金的员工的平均工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> manager_id,<span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> manager_id</span><br></pre></td></tr></table></figure></div><h3 id="分组后筛选案例"><a class="header-anchor" href="#分组后筛选案例">¶</a>分组后筛选案例</h3><div class="alert warning no-icon"><p>案例 1：查询哪个部门的员工个数&gt;5</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>案例 2：每个工种有奖金的员工的最高工资&gt;12000 的工种编号和最高工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MAX</span>(salary)<span class="operator">&gt;</span><span class="number">12000</span>;</span><br></pre></td></tr></table></figure><p>案例 3：领导编号&gt;102,每个领导手下的最低工资大于 5000 的最低工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),manager_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> manager_id <span class="operator">&gt;</span><span class="number">102</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> manager_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MIN</span>(salary)<span class="operator">&gt;</span><span class="number">5000</span>;</span><br></pre></td></tr></table></figure></div><h3 id="分组后排序案例"><a class="header-anchor" href="#分组后排序案例">¶</a>分组后排序案例</h3><p>案例：查询没有奖金的员工的最高工资&gt;6000 的工种编号和最高工资,按最高工资升序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">HAVING</span>	<span class="built_in">MAX</span>(salary)<span class="operator">&gt;</span><span class="number">6000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">MAX</span>(salary) <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure><h3 id="按照多个字段分组案例"><a class="header-anchor" href="#按照多个字段分组案例">¶</a>按照多个字段分组案例</h3><p>案例：查询每个工种每个部门的最低工资,并按最低工资降序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(salary),job_id,department_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job_id,department_id</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">min</span>(salary);</span><br></pre></td></tr></table></figure><h2 id="连接查询"><a class="header-anchor" href="#连接查询">¶</a>连接查询</h2><p>连接查询又称为多表查询,当查询语句涉及到的字段来自于多个表时,就会用到连接查询，目前存在的连接查询有两种,分别是<code>sql 92标准</code>与<code>sql 99标准</code></p><h3 id="sql92-标准"><a class="header-anchor" href="#sql92-标准">¶</a>sql92 标准</h3><p><font style="color:red;font-weight:700">仅支持内连接</font>，内连接的格式如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表</span><br><span class="line"><span class="keyword">FROM</span> 表<span class="number">1</span> 别名,表<span class="number">2</span> 别名</span><br><span class="line"><span class="keyword">WHERE</span> 连接条件</span><br><span class="line"><span class="keyword">AND</span> 筛选条件</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组列表</span><br><span class="line"><span class="keyword">HAVING</span> 分组后筛选</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序列表</span><br></pre></td></tr></table></figure><p>✨sql 92 标准下内连接特点: 执行顺序: FROM --&gt; WHERE --&gt; AND --&gt; GROUP BY --&gt; HAVING --&gt; SELECT --&gt; ORDER BY</p><h4 id="等值连接"><a class="header-anchor" href="#等值连接">¶</a>等值连接</h4><p>✨等值连接特点：</p><div class="alert success no-icon"><ol><li>多表等值连接的结果为多表的交集部分</li><li>n 表连接，至少需要 n-1 各连接条件</li><li>多表的顺序没有要求</li><li>一般需要为表起别名，加强程序的语义性</li><li>可以搭配前面介绍的所有子句使用，比如排序、分组、筛选</li></ol></div><div class="alert warning no-icon"><p>案例 1：查询女神名和对应的男神名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NAME,boyName</span><br><span class="line"><span class="keyword">FROM</span> boys,beauty</span><br><span class="line"><span class="keyword">WHERE</span> beauty.boyfriend_id<span class="operator">=</span> boys.id;</span><br></pre></td></tr></table></figure><p>案例 2：查询员工名和对应的部门名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees,departments</span><br><span class="line"><span class="keyword">WHERE</span> employees.`department_id`<span class="operator">=</span>departments.`department_id`;</span><br></pre></td></tr></table></figure><p>案例 3：查询每个城市的部门个数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) 个数,city</span><br><span class="line"><span class="keyword">FROM</span> departments d,locations l</span><br><span class="line"><span class="keyword">WHERE</span> d.`location_id`<span class="operator">=</span>l.`location_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> city;	#连接后进行分组查询</span><br></pre></td></tr></table></figure><p>案例 4：查询每个工种的工种名和员工的个数，并且按员工个数降序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> job_title,<span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> employees e,jobs j</span><br><span class="line"><span class="keyword">WHERE</span> e.`job_id`<span class="operator">=</span>j.`job_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_title</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">DESC</span>;	#连接后进行分组查询且排序</span><br></pre></td></tr></table></figure></div><p>👴对表起别名总是有好处的，可以提高语句的简洁度，区分多个重名的字段；如果<font style="color:red;font-weight:700">对表起了别名</font>，则查询的字段就<font style="color:red;font-weight:700">不能使用原来的表名进行条件筛选</font></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#如此就会出错，如果存在别名，就不能使用原表名</span><br><span class="line"><span class="keyword">SELECT</span> e.last_name,e.job_id,j.job_title</span><br><span class="line"><span class="keyword">FROM</span> employees  e,jobs j</span><br><span class="line"><span class="keyword">WHERE</span> employees.`job_id`<span class="operator">=</span>jobs.`job_id`;</span><br><span class="line"></span><br><span class="line">#如此，可以正确查询</span><br><span class="line"><span class="keyword">SELECT</span> e.last_name,e.job_id,j.job_title</span><br><span class="line"><span class="keyword">FROM</span> employees  e,jobs j</span><br><span class="line"><span class="keyword">WHERE</span> e.`job_id`<span class="operator">=</span>j.`job_id`;</span><br></pre></td></tr></table></figure><h4 id="非等值连接"><a class="header-anchor" href="#非等值连接">¶</a>非等值连接</h4><p>非等值连接中，一个表中的数值落在于另一个表中两列的数值范围中，以此来构成连接</p><div class="alert warning no-icon"><p>案例 1：查询员工的工资和工资级别</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.`salary`,sg.`grade`</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="keyword">AS</span> e,sal_grade <span class="keyword">AS</span> sg</span><br><span class="line"><span class="keyword">WHERE</span> e.`salary` <span class="keyword">BETWEEN</span> sg.`min_salary` <span class="keyword">AND</span> sg.`max_salary`;</span><br><span class="line">#使用BETWEEN...AND...进行非等值间的连接</span><br></pre></td></tr></table></figure></div><h4 id="自连接"><a class="header-anchor" href="#自连接">¶</a>自连接</h4><p>查询表来自于自身，<font style="color:red;font-weight:700">自身与自身的连接</font>称之为自连接</p><p>案例：查询员工名和上级的名称</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.employee_id,e.last_name,m.employee_id,m.last_name</span><br><span class="line"><span class="keyword">FROM</span> employees e,employees m</span><br><span class="line"><span class="keyword">WHERE</span> e.`manager_id`<span class="operator">=</span>m.`employee_id`;</span><br></pre></td></tr></table></figure><h3 id="sql99-标准"><a class="header-anchor" href="#sql99-标准">¶</a>sql99 标准</h3><p>sql99 支持内连接、外连接(左外和右外)+交叉连接</p><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/SQL99%E6%A0%87%E5%87%86.png" alt=""></p><p>🎶SQL 99 使用<code>JOIN</code>关键字代替了之前的逗号，并且将连接条件和筛选条件进行了分离，提高了阅读性</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表 <span class="keyword">FROM</span> 表名<span class="number">1</span> [<span class="keyword">AS</span>] 别名</span><br><span class="line">[<span class="keyword">INNER</span>] <span class="keyword">JOIN</span> 表名<span class="number">2</span> [<span class="keyword">AS</span>] 别名</span><br><span class="line"><span class="keyword">ON</span> 连接条件</span><br><span class="line"><span class="keyword">WHERE</span> 筛选条件</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组列表</span><br><span class="line"><span class="keyword">HAVING</span> 分组后筛选</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序列表</span><br></pre></td></tr></table></figure><h4 id="等值连接-v2"><a class="header-anchor" href="#等值连接-v2">¶</a>等值连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#案例<span class="number">1</span>：查询员工名和部门名</span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span>  employees e</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span>d.department_id;</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询部门编号<span class="operator">&gt;</span><span class="number">100</span>的部门名和所在的城市名</span><br><span class="line"><span class="keyword">SELECT</span> department_name,city</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.`location_id` <span class="operator">=</span> l.`location_id`</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_id`<span class="operator">&gt;</span><span class="number">100</span>;	#添加筛选条件</span><br><span class="line"></span><br><span class="line">#案例<span class="number">3</span>：查询每个城市的部门个数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) 部门个数,l.`city`</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.`location_id`<span class="operator">=</span>l.`location_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> l.`city`;	#添加分组筛选</span><br><span class="line"></span><br><span class="line">#案例<span class="number">4</span>：查询部门中员工个数<span class="operator">&gt;</span><span class="number">10</span>的部门名，并按员工个数降序</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) 员工个数,d.department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> d.`department_id`</span><br><span class="line"><span class="keyword">HAVING</span> 员工个数<span class="operator">&gt;</span><span class="number">10</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 员工个数 <span class="keyword">DESC</span>;	#添加分组、筛选、排序</span><br><span class="line"></span><br><span class="line">#案例<span class="number">5</span>: 选择city在Toronto工作的员工的last_name , job_id , department_id , department_name</span><br><span class="line"><span class="keyword">SELECT</span> last_name , job_id , department_id , department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`</span><br><span class="line"><span class="keyword">JOIN</span> locations l <span class="keyword">ON</span> d.`location_id` <span class="operator">=</span> l.`location_id`	#多表连接，使用多次<span class="keyword">join</span>语句</span><br><span class="line"><span class="keyword">WHERE</span> city <span class="operator">=</span> <span class="string">&#x27;Toronto&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#案例<span class="number">6</span>: 查询每个工种、每个部门的部门名、工种名和最低工资</span><br><span class="line"><span class="keyword">select</span> j.`job_title`,d.`department_name`,<span class="built_in">min</span>(salary)</span><br><span class="line"><span class="keyword">from</span> employees <span class="keyword">as</span> e</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> jobs <span class="keyword">as</span> j <span class="keyword">on</span> e.`job_id` <span class="operator">=</span> j.`job_id`</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> departments <span class="keyword">as</span> d <span class="keyword">on</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> j.`job_id`,e.`department_id`</span><br></pre></td></tr></table></figure><h4 id="非等值连接-v2"><a class="header-anchor" href="#非等值连接-v2">¶</a>非等值连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#案例：查询部门编号在<span class="number">10</span><span class="number">-90</span>之间的员工的工资级别，并按级别进行分组</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) 个数,grade</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> sal_grade g</span><br><span class="line"><span class="keyword">ON</span> e.`salary` <span class="keyword">BETWEEN</span> g.`min_salary` <span class="keyword">AND</span> g.`max_salary`</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id` <span class="keyword">BETWEEN</span> <span class="number">10</span> <span class="keyword">AND</span> <span class="number">90</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> g.grade;</span><br></pre></td></tr></table></figure><h4 id="自连接-v2"><a class="header-anchor" href="#自连接-v2">¶</a>自连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#案例：查询员工名和对应的领导名</span><br><span class="line"><span class="keyword">SELECT</span> e.`last_name`,m.`last_name`</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> employees m</span><br><span class="line"><span class="keyword">ON</span> e.`manager_id`<span class="operator">=</span>m.`employee_id`;</span><br></pre></td></tr></table></figure><h4 id="外连接"><a class="header-anchor" href="#外连接">¶</a>外连接</h4><p>✨外连接特点</p><div class="alert success no-icon"><ol><li>查询结果为主表中所有的记录，如果从表有匹配项，则显示匹配项；如果从表没有匹配项，则显示 null</li><li>应用场景:一般用于查询主表中有但从表没有的记录</li><li>外连接分主从表，两表的顺序不能任意调换</li><li>左连接的话、left join 左边为主表</li><li>右连接的话、right join 右边为主表</li><li>全连接，将两个表结合在一起，另一方表未出现的数据，均使用<code>NULL</code>代替，MySQL 不支持</li></ol></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表</span><br><span class="line"><span class="keyword">FROM</span> 表<span class="number">1</span> 别名</span><br><span class="line"><span class="keyword">LEFT</span> <span class="operator">|</span> <span class="keyword">RIGHT</span> <span class="operator">|</span> <span class="keyword">FULL</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> 表<span class="number">2</span> 别名</span><br><span class="line"><span class="keyword">ON</span> 连接条件</span><br><span class="line"><span class="keyword">WHERE</span> 筛选条件</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#案例<span class="number">1</span>：查询所有女神记录，以及对应的男神名，如果没有对应的男神，则显示为<span class="keyword">null</span></span><br><span class="line"><span class="keyword">select</span> g.`name`,b.`boyName`</span><br><span class="line"><span class="keyword">from</span> beauty <span class="keyword">as</span> g</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> boys <span class="keyword">as</span> b <span class="keyword">on</span> g.`boyfriend_id`<span class="operator">=</span>b.`id`;#女生为主表</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> g.`name`,b.`boyName`</span><br><span class="line"><span class="keyword">from</span> boys <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> beauty <span class="keyword">as</span> g <span class="keyword">on</span> g.`boyfriend_id`<span class="operator">=</span>b.`id;`#男生为主表</span><br><span class="line">#案例<span class="number">2</span>：查哪个女神没有男朋友</span><br><span class="line"><span class="keyword">select</span> g.`name`</span><br><span class="line"><span class="keyword">from</span> beauty <span class="keyword">as</span> g</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> boys b <span class="keyword">on</span> g.`boyfriend_id`<span class="operator">=</span>b.`id`</span><br><span class="line"><span class="keyword">where</span> b.`boyName` <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line">#案例<span class="number">3</span>：查询哪个部门没有员工，并显示其部门编号和部门名</span><br><span class="line"><span class="keyword">SELECT</span> d.`department_id`,d.`department_name`</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employees e <span class="keyword">ON</span> d.`department_id` <span class="operator">=</span> e.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> e.`employee_id` <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> d.`department_id`;</span><br><span class="line">#案例<span class="number">4</span>：查询部门名为 SAL 或 IT 的员工信息</span><br><span class="line"><span class="keyword">SELECT</span> d.<span class="operator">*</span>,e.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employees e <span class="keyword">ON</span> d.`department_id` <span class="operator">=</span> e.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_name` <span class="operator">=</span> <span class="string">&#x27;SAL&#x27;</span> <span class="keyword">OR</span> d.`department_name`<span class="operator">=</span><span class="string">&#x27;IT&#x27;</span>;</span><br></pre></td></tr></table></figure><p>👴使用外连接时一定要清楚主表和从表，以及那些属性可以为空进行判断</p><h4 id="交叉连接"><a class="header-anchor" href="#交叉连接">¶</a>交叉连接</h4><p>🎶交叉连接返回的结果，是被连接的两个表中所有数据行的笛卡尔积</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#案例<span class="number">1</span>: Department表中有<span class="number">4</span>个部门，employee表中有<span class="number">4</span>个员工，那么，交叉连接的结果就有<span class="number">16</span>条数据</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表<span class="number">1</span></span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> 表<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p>👴实际开发中，不经常使用交叉连接</p><h2 id="子查询"><a class="header-anchor" href="#子查询">¶</a>子查询</h2><p>🎶当一个查询语句中又嵌套了另一个完整的<code>SELECT</code>语句，则被嵌套的 SELECT 语句称为子查询或内查询，外面的 SELECT 语句称为主查询或外查询</p><blockquote><p>✨子查询特点:</p><ol><li>子查询放在条件中，要求必须放在条件的右侧</li><li>子查询一般放在小括号中</li><li>子查询的执行优先于主查询</li><li>单行子查询对应单行操作符(&lt;,&lt;=,&gt;,&gt;=,=,&lt;&gt;)</li><li>多行子查询对应多行操作符(any/some,all,in)</li></ol></blockquote><p>根据子查询所在位置不同，可以有以下的分类方式：</p><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mysql/subQueryCategory.png" alt=""></p><h3 id="子查询在-where-或-having-后面"><a class="header-anchor" href="#子查询在-where-或-having-后面">¶</a>子查询在 where 或 having 后面</h3><p>这种方式的子查询又进一步可以分为：单行子查询以及多行子查询</p><h4 id="单行子查询"><a class="header-anchor" href="#单行子查询">¶</a>单行子查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#案例<span class="number">1</span>：谁的工资比Abel高?</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  `last_name`,  salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&gt;</span></span><br><span class="line">  (<span class="keyword">SELECT</span></span><br><span class="line">    e.`salary`</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">    employees <span class="keyword">AS</span> e</span><br><span class="line">  <span class="keyword">WHERE</span> e.`last_name` <span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：返回job_id与<span class="number">141</span>号员工相同，salary比<span class="number">143</span>号员工多的员工姓名，job_id 和工资</span><br><span class="line"><span class="keyword">SELECT</span> last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> job_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">141</span></span><br><span class="line">) <span class="keyword">AND</span> salary<span class="operator">&gt;</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> salary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">143</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#案例<span class="number">3</span>：返回公司工资最少的员工的last_name,job_id和salary</span><br><span class="line"><span class="keyword">select</span> last_name,job_id,salary</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">where</span> salary <span class="operator">=</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees <span class="keyword">AS</span> e);</span><br><span class="line"></span><br><span class="line">#案例<span class="number">4</span>：查询最低工资大于<span class="number">50</span>号部门最低工资的部门id和其最低工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MIN</span>(salary)<span class="operator">&gt;</span>(</span><br><span class="line"></span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> department_id <span class="operator">=</span> <span class="number">50</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="多行子查询"><a class="header-anchor" href="#多行子查询">¶</a>多行子查询</h4><p>🎶 多行操作符：<code>in</code>、<code>any/some</code>:判断某字段是否满足其中任意一个数值以及 <code>all</code>:判断某字段的值是否满足里面所有的数值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x <span class="keyword">in</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">x<span class="operator">&gt;</span><span class="keyword">any</span>(<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>)	#只要大于最少值即可</span><br><span class="line">x<span class="operator">&gt;</span><span class="keyword">all</span>(<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>)	#需要大于最大值</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><p>案例 1：返回 location_id 是 1400 或 1700 的部门中的所有员工姓名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span></span><br><span class="line">  (<span class="keyword">SELECT</span> department_id <span class="keyword">FROM</span> departments</span><br><span class="line">  <span class="keyword">WHERE</span> location_id <span class="keyword">IN</span> (<span class="number">1400</span>, <span class="number">1700</span>));</span><br></pre></td></tr></table></figure><p>案例 2：返回其它部门中比 job_id 为‘IT_PROG’部门任一工资低的员工的员工号、姓名、job_id 以及 salary</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&lt;</span><span class="keyword">ANY</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;IT_PROG&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></div><h3 id="子查询在-SELECT-后面"><a class="header-anchor" href="#子查询在-SELECT-后面">¶</a>子查询在 SELECT 后面</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#案例；查询部门编号是<span class="number">50</span>的员工个数</span><br><span class="line"><span class="keyword">SELECT</span>(<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id<span class="operator">=</span><span class="number">50</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="子查询在-FROM-后面"><a class="header-anchor" href="#子查询在-FROM-后面">¶</a>子查询在 FROM 后面</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#案例：查询每个部门的平均工资的工资级别</span><br><span class="line"><span class="keyword">select</span> grade_level</span><br><span class="line"><span class="keyword">from</span> job_grades <span class="keyword">inner</span> <span class="keyword">join</span> (</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(salary) avgs,department_id</span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> department_id</span><br><span class="line">) ag <span class="keyword">on</span> ag.avgs <span class="keyword">between</span> lowest_sal <span class="keyword">and</span> highest_sal</span><br></pre></td></tr></table></figure><h3 id="放在-exists-后面"><a class="header-anchor" href="#放在-exists-后面">¶</a>放在 exists 后面</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#案例<span class="number">1</span> ：查询有无名字叫“张三丰”的员工信息</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">exists</span>(<span class="keyword">SELECT</span> last_name <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> last_name<span class="operator">=</span><span class="string">&#x27;张三丰&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="分页查询"><a class="header-anchor" href="#分页查询">¶</a>分页查询</h2><p>当页面上的数据，一页显示不全，则需要分页显示，基本格式如下：</p><h3 id="分页查询基本框架"><a class="header-anchor" href="#分页查询基本框架">¶</a>分页查询基本框架</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表</span><br><span class="line"><span class="keyword">FROM</span> 表<span class="number">1</span> 别名</span><br><span class="line"><span class="keyword">JOIN</span> 表<span class="number">2</span> 别名</span><br><span class="line"><span class="keyword">ON</span> 连接条件</span><br><span class="line"><span class="keyword">WHERE</span> 筛选条件</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组列表</span><br><span class="line"><span class="keyword">HAVING</span> 分组后筛选条件</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序列表</span><br><span class="line">LIMIT 起始条目,显示的条目数;</span><br></pre></td></tr></table></figure><p>✨ 分页查询特点</p><div class="alert success no-icon"><ol><li>执行顺序: FROM --&gt; JOIN --&gt; ON --&gt; WHERE --&gt; GROUP BY --&gt; HAVING --&gt; SELECT --&gt; ORDER BY --&gt; LIMIT</li><li>起始条目索引默认为<code>0</code></li></ol></div><h3 id="分页显示公式"><a class="header-anchor" href="#分页显示公式">¶</a>分页显示公式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#假如要显示的页数时page,每页显示的条目数为size</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees LIMIT (page<span class="number">-1</span>)<span class="operator">*</span>size,size;</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><p>案例 1：查询员工信息表的前 5 条</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees limit <span class="number">0</span>,<span class="number">5</span>;</span><br><span class="line">#等价于</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees LIMIT <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>案例 2：查询有奖金的，且工资较高的第 11 名到第 20 名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">10</span>,<span class="number">10</span> ;</span><br></pre></td></tr></table></figure></div><h2 id="联合查询"><a class="header-anchor" href="#联合查询">¶</a>联合查询</h2><p>当查询结果来自于多张表，单多张表之间没有关联，这个适合就需要使用联合查询，也成为 union 查询</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表 <span class="keyword">FROM</span> 表<span class="number">1</span>  <span class="keyword">WHERE</span> 筛选条件</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> 查询列表 <span class="keyword">FROM</span> 表<span class="number">2</span>  <span class="keyword">WHERE</span> 筛选条件</span><br></pre></td></tr></table></figure><p>✨联合查询特点</p><div class="alert success no-icon"><ol><li>多条待联合的查询语句的查询列数必须一致，查询类型、字段含义最好一致</li><li>union：默认去重查询，union all:实现全部查询，包含重复项</li></ol></div><div class="alert warning no-icon"><p>案例：查询所有国家的年龄&gt;20 岁的用户信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> usa <span class="keyword">WHERE</span> uage <span class="operator">&gt;</span><span class="number">20</span> <span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> chinese <span class="keyword">WHERE</span> age <span class="operator">&gt;</span><span class="number">20</span> ;</span><br></pre></td></tr></table></figure><p>案例 2：union 自动去重/union all 可以支持重复项</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>,<span class="string">&#x27;重复项1&#x27;</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>,<span class="string">&#x27;重复项1&#x27;</span></span><br></pre></td></tr></table></figure></div></div></div><div id="post-footer" class="post-footer main-content-wrap"><div class="post-footer-tags"><span class="text-color-light text-small">标签</span><br><a class="tag tag--primary tag--small t-none-link" href="/tags/MySQL/" rel="tag">MySQL</a></div><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F-%E2%98%9E-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" data-tooltip="结构型模式 ☞ 代理模式" aria-label="上一篇: 结构型模式 ☞ 代理模式"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">上一篇</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mysql-%E4%B8%80-%E6%A6%82%E8%BF%B0%E4%B8%8E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" data-tooltip="MySQL(一)概述与环境搭建" aria-label="下一篇: MySQL(一)概述与环境搭建"><span class="hide-xs hide-sm text-small icon-mr">下一篇</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></article><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><footer id="footer" class="main-content-wrap"><span class="copyrights">Copyrights &copy; 2023 pineapple-man. All Rights Reserved.</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><br>Total <span id="busuanzi_value_site_pv"></span> views. 您是pineapple-man的第<span id="busuanzi_value_site_uv"></span>个小伙伴<br><i class="fas fa-book-open"></i> <span class="post-count">博客字数统计：370.7k</span><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></footer></div><div id="bottom-bar" class="post-bottom-bar" data-behavior="5"><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F-%E2%98%9E-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" data-tooltip="结构型模式 ☞ 代理模式" aria-label="上一篇: 结构型模式 ☞ 代理模式"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">上一篇</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mysql-%E4%B8%80-%E6%A6%82%E8%BF%B0%E4%B8%8E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" data-tooltip="MySQL(一)概述与环境搭建" aria-label="下一篇: MySQL(一)概述与环境搭建"><span class="hide-xs hide-sm text-small icon-mr">下一篇</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="目录"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></div><div id="about"><div id="about-card"><div id="about-btn-close"><i class="fa fa-times"></i></div><img id="about-card-picture" src="/assets/images/logo.png" alt="作者的图片"><h4 id="about-card-name">pineapple-man</h4><div id="about-card-bio"><p>做一个菠萝：站得笔直，头戴王冠，内心甜美</p></div><div id="about-card-job"><i class="fa fa-briefcase"></i><br><p>刚毕业就失业</p></div><div id="about-card-location"><i class="fa fa-map-marker-alt"></i><br>西安</div></div></div><div id="cover" style="background-image:url(/assets/images/cover-v1.2.0.jpg)"></div><script src="/assets/js/script-kcoiyt1nxfue7qgcpkrcixymglcc3cuxeg98fy01hqww4nblnhd2ees6j6yc.min.js"></script></body></html>