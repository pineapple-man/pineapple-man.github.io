<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="pineapple-man"><title>MyBatisæ˜ å°„æ–‡ä»¶ - pineapple-man</title><meta name="author" content="pineapple-man"><meta name="keywords" content="MyBatisæ˜ å°„æ–‡ä»¶"><link rel="icon" href="https://pineapple-man.github.io/assets/images/logo.svg"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png"},"articleBody":"\nÂ¶XML æ˜ å°„å™¨\nMyBatis çš„çœŸæ­£å¼ºå¤§åœ¨äºå®ƒçš„è¯­å¥æ˜ å°„ï¼ŒSQL æ˜ å°„æ–‡ä»¶åªæœ‰å¾ˆå°‘çš„å‡ ä¸ªé¡¶çº§å…ƒç´ ï¼ˆæ ¹æ®åº”è¢«å®šä¹‰çš„é¡ºåºåˆ—å‡ºï¼‰ï¼š\n\n\n\næ ‡ç­¾\nå«ä¹‰\n\n\n\n\ncache\nè¯¥å‘½åç©ºé—´çš„ç¼“å­˜é…ç½®\n\n\ncache-ref\nå¼•ç”¨å…¶ä»–å‘½ä»¤ç©ºé—´çš„ç¼“å­˜é…ç½®\n\n\nresultMap\næè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­åŠ è½½å¯¹è±¡ï¼Œæ—¶æœ€å¤æ‚ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„å…ƒç´ \n\n\nsql\nå¯è¢«å…¶å®ƒè¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯­å¥å—\n\n\ninsert\næ˜ å°„æ’å…¥è¯­å¥\n\n\nupdate\næ˜ å°„æ›´æ–°è¯­å¥\n\n\ndelete\næ˜ å°„åˆ é™¤è¯­å¥\n\n\nselect\næ˜ å°„æŸ¥è¯¢è¯­å¥\n\n\n\nÂ¶&lt;select&gt;\nå¤šæ•°åº”ç”¨éƒ½æ˜¯æŸ¥è¯¢å¯†é›†å‹ï¼Œæ‰€ä»¥å…ˆä»æŸ¥è¯¢å¼€å§‹\nğŸ¶ MyBatis çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€æ˜¯ï¼šåœ¨æ¯ä¸ªæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤æ“ä½œä¹‹é—´ï¼Œé€šå¸¸ä¼šæ‰§è¡Œå¤šä¸ªæŸ¥è¯¢æ“ä½œ\nÂ¶å¸¸è§é…ç½®\n123&lt;select id=&quot;selectPerson&quot; parameterType=&quot;int&quot; resultType=&quot;hashmap&quot;&gt;  SELECT * FROM PERSON WHERE ID = #&#123;id&#125;&lt;/select&gt;\nâœ¨è¯­å¥ç‰¹ç‚¹\n\nè¿™ä¸ªè¯­å¥åæ˜¯selectPerson\næ¥å—ä¸€ä¸ªint(Integer)ç±»å‹çš„å‚æ•°\nè¿”å›ä¸€ä¸ªHashMapç±»å‹çš„å¯¹è±¡ï¼Œå…¶ä¸­é”®æ˜¯åˆ—åï¼Œå€¼ä¾¿æ˜¯ç»“æœè¡Œä¸­çš„å¯¹åº”å€¼\nå‚æ•°ä½¿ç”¨#&#123;&#125;è¿›è¡Œè·å–\n\nÂ¶åº•å±‚è®¾è®¡\nä»¥ä¸Šçš„æŸ¥è¯¢è¯­å¥ï¼Œå…¶å®å°±æ˜¯å‘Šè¯‰ MyBatis åˆ›å»ºä¸€ä¸ªé¢„å¤„ç†è¯­å¥(PreparedStatement)å‚æ•°\n123String selectPerson = &quot;SELECT * FROM PERSON WHERE ID=?&quot;;PreparedStatement ps = conn.prepareStatement(selectPerson);ps.setInt(1,id);\nÂ¶å±æ€§\nselect å…ƒç´ å¯ä»¥é…ç½®å¾ˆå¤šå±æ€§æ¥é…ç½®æ¯æ¡è¯­å¥çš„è¡Œä¸ºç»†èŠ‚\n123456789101112&lt;select  id=&quot;selectPerson&quot;  parameterType=&quot;int&quot;  parameterMap=&quot;deprecated&quot;  resultType=&quot;hashmap&quot;  resultMap=&quot;personResultMap&quot;  flushCache=&quot;false&quot;  useCache=&quot;true&quot;  timeout=&quot;10&quot;  fetchSize=&quot;256&quot;  statementType=&quot;PREPARED&quot;  resultSetType=&quot;FORWARD_ONLY&quot;&gt;\n\n\n\nå±æ€§\næè¿°\n\n\n\n\nresultType\næœŸæœ›ä»è¿™æ¡è¯­å¥ä¸­è¿”å›ç»“æœçš„ç±»å…¨é™å®šåæˆ–åˆ«åã€‚ æ³¨æ„ï¼Œå¦‚æœè¿”å›çš„æ˜¯é›†åˆï¼Œé‚£åº”è¯¥è®¾ç½®ä¸ºé›†åˆåŒ…å«çš„ç±»å‹ï¼Œè€Œä¸æ˜¯é›†åˆæœ¬èº«çš„ç±»å‹ã€‚ resultType å’Œ resultMap ä¹‹é—´åªèƒ½åŒæ—¶ä½¿ç”¨ä¸€ä¸ªã€‚\n\n\n\nÂ¶insert,update&amp;delete\næ•°æ®å˜æ›´è¯­å¥ insertï¼Œupdate å’Œ delete çš„å®ç°éå¸¸æ¥è¿‘ï¼š\n1234567891011121314151617181920212223&lt;insert  id=&quot;insertAuthor&quot;  parameterType=&quot;domain.blog.Author&quot;  flushCache=&quot;true&quot;  statementType=&quot;PREPARED&quot;  keyProperty=&quot;&quot;  keyColumn=&quot;&quot;  useGeneratedKeys=&quot;&quot;  timeout=&quot;20&quot;&gt;&lt;update  id=&quot;updateAuthor&quot;  parameterType=&quot;domain.blog.Author&quot;  flushCache=&quot;true&quot;  statementType=&quot;PREPARED&quot;  timeout=&quot;20&quot;&gt;&lt;delete  id=&quot;deleteAuthor&quot;  parameterType=&quot;domain.blog.Author&quot;  flushCache=&quot;true&quot;  statementType=&quot;PREPARED&quot;  timeout=&quot;20&quot;&gt;\nÂ¶è·å–è‡ªå¢ä¸»é”®çš„å€¼\nmysql æ”¯æŒè‡ªå¢ä¸»é”®ï¼Œè‡ªå¢ä¸»é”®å€¼çš„è·å–ï¼Œmybatis åˆ©ç”¨statement.getGeneratedKeys()\nuseGenerateKeys=&quot;true&quot;ä½¿ç”¨è‡ªå¢ä¸»é”®è·å–ä¸»é”®å€¼ç­–ç•¥\nkeyPropertyæŒ‡å®šå¯¹åº”çš„ä¸»é”®å±æ€§ï¼Œä¹Ÿå°±æ˜¯ mybatis è·å–åˆ°ä¸»é”®å€¼ä»¥åï¼Œå°†è¿™ä¸ªå€¼å°è£…ç»™ javabean çš„é‚£ä¸ªå±æ€§\n\n\n\nå±æ€§\næè¿°\n\n\n\n\ndatabaseId\nå¦‚æœé…ç½®äº†æ•°æ®åº“å‚å•†æ ‡è¯†ï¼ˆdatabaseIdProviderï¼‰ï¼ŒMyBatis ä¼šåŠ è½½æ‰€æœ‰ä¸å¸¦ databaseId æˆ–åŒ¹é…å½“å‰ databaseId çš„è¯­å¥ï¼›å¦‚æœå¸¦å’Œä¸å¸¦çš„è¯­å¥éƒ½æœ‰ï¼Œåˆ™ä¸å¸¦çš„ä¼šè¢«å¿½ç•¥ã€‚\n\n\n\n123456&lt;!-- public void addEmp(Employee employee); --&gt;&lt;insert id=&quot;addEmp&quot; parameterType=&quot;com.atguigu.mybatis.bean.Employee&quot;   useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot; databaseId=&quot;mysql&quot;&gt;   insert into tbl_employee(last_name,email,gender)   values(#&#123;lastName&#125;,#&#123;email&#125;,#&#123;gender&#125;)&lt;/insert&gt;\nÂ¶è·å–éè‡ªå¢ä¸»é”®çš„å€¼\nOracle ä¸æ”¯æŒè‡ªå¢ä½¿çš„æ•°æ®åº“ï¼Œä½¿ç”¨ selectKey å­å…ƒç´ \nâœ¨selectKey å…ƒç´ å°†ä¼šé¦–å…ˆè¿è¡Œï¼Œ id ä¼šè¢«è®¾ç½®ï¼Œ ç„¶åæ’å…¥è¯­å¥ä¼šè¢«è°ƒç”¨\n\n\n\nå±æ€§\næè¿°\n\n\n\n\nkeyProperty\nä»…é€‚ç”¨äº insert å’Œ updateï¼ŒæŒ‡å®šèƒ½å¤Ÿå”¯ä¸€è¯†åˆ«å¯¹è±¡çš„å±æ€§ï¼ŒMyBatis ä¼šä½¿ç”¨ getGeneratedKeys çš„è¿”å›å€¼æˆ– insert è¯­å¥çš„ selectKey å­å…ƒç´ è®¾ç½®å®ƒçš„å€¼ï¼Œé»˜è®¤å€¼ï¼šæœªè®¾ç½®ï¼ˆunsetï¼‰ã€‚å¦‚æœç”Ÿæˆåˆ—ä¸æ­¢ä¸€ä¸ªï¼Œå¯ä»¥ç”¨é€—å·åˆ†éš”å¤šä¸ªå±æ€§åç§°ã€‚\n\n\norder\nâ€œBEFOREâ€:å½“å‰ sql åœ¨æ’å…¥ sql ä¹‹å‰è¿è¡Œâ€œAFTERâ€ï¼šå½“å‰ sql åœ¨æ’å…¥ sql ä¹‹åè¿è¡Œ\n\n\n\nğŸ¶BEFORE ä¸ AFTER çš„è¿è¡Œé¡ºåº\n\nBEFORE:\n\nå…ˆè¿è¡Œ selectKey æŸ¥è¯¢ id çš„ sqlï¼›æŸ¥å‡º id å€¼å°è£…ç»™ javaBean çš„ id å±æ€§\nå†è¿è¡Œæ’å…¥çš„ sqlï¼›å°±å¯ä»¥å–å‡º id å±æ€§å¯¹åº”çš„å€¼\n\n\nAFTER\n\nå…ˆè¿è¡Œæ’å…¥çš„ sqlï¼ˆä»åºåˆ—ä¸­å–å‡ºæ–°å€¼ä½œä¸º idï¼‰ï¼›\nå†è¿è¡Œ selectKey æŸ¥è¯¢ id çš„ sqlï¼›\n\n\n\n12345678&lt;insert id=&quot;addEmp&quot; databaseId=&quot;oracle&quot;&gt;    &lt;selectKey keyProperty=&quot;id&quot; order=&quot;BEFORE&quot; resultType=&quot;Integer&quot;&gt;        select EMPLOYEES_SEQ.nextval from dual    &lt;/selectKey&gt;    &lt;!-- æ’å…¥æ—¶çš„ä¸»é”®æ˜¯ä»åºåˆ—ä¸­æ‹¿åˆ°çš„ --&gt;    insert into employees(EMPLOYEE_ID,LAST_NAME,EMAIL)    values(#&#123;id&#125;,#&#123;lastName&#125;,#&#123;email,jdbcType=NULL&#125;)&lt;/insert&gt;\nÂ¶å‚æ•°å¤„ç†\nDAO å’Œ MyBatis Mapper ä¹‹é—´å‚æ•°ä¼ é€’çš„å¤„ç†\nÂ¶å•ä¸ªå‚æ•°\nå¯ä»¥æ¥å—åŸºæœ¬ç±»å‹ï¼Œ å¯¹è±¡ç±»å‹ã€‚ è¿™ç§æƒ…å†µ MyBatis å¯ç›´æ¥ä½¿ç”¨è¿™ä¸ªå‚æ•°ï¼Œ ä¸éœ€è¦ç»è¿‡ä»»ä½•å¤„ç†\n1#&#123;å‚æ•°å/ä»»æ„å&#125;\nÂ¶å¤šä¸ªå‚æ•°\nä»»æ„å¤šä¸ªå‚æ•°ï¼Œ éƒ½ä¼šè¢« MyBatis é‡æ–°åŒ…è£…æˆä¸€ä¸ª Map ä¼ å…¥\nâœ¨Map çš„ key æ˜¯ param1ï¼Œparam2ï¼Œ æˆ–è€… 0ï¼Œ 1â€¦ï¼Œ å€¼å°±æ˜¯å‚æ•°çš„å€¼\n123key: param1 .. paramNvalueï¼šä¼ å…¥çš„å‚æ•°å€¼#&#123;param1&#125;å°±æ˜¯ä»mapä¸­è·å–æŒ‡å®šçš„keyçš„å€¼\nÂ¶å‘½åå‚æ•°\nğŸ¶æ˜ç¡®æŒ‡å®šå°è£…å‚æ•°æ—¶ map çš„ key @Param(&quot;id&quot;)\n123key:ä½¿ç”¨@Paramæ³¨è§£æŒ‡å®šçš„å€¼value:å‚æ•°å€¼#&#123;æŒ‡å®šçš„key&#125;å–å‡ºå¯¹åº”çš„å‚æ•°å€¼\nÂ¶POJO\nå¦‚æœå¤šä¸ªå‚æ•°æ­£å¥½æ˜¯æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘çš„æ•°æ®æ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä¼ å…¥ POJO\n1#&#123;å±æ€§å&#125;:å–å‡ºä¼ å…¥çš„pojoçš„å±æ€§å€¼\nÂ¶Map\nå¦‚æœå¤šä¸ªå‚æ•°ä¸æ˜¯ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ï¼Œæ²¡æœ‰å¯¹åº”çš„ pojoï¼Œä¸ç»å¸¸ä½¿ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¼ å…¥ map\n1#&#123;key&#125;:å–å‡ºmapä¸­å¯¹åº”çš„å€¼\nÂ¶TO\nå¦‚æœå¤šä¸ªå‚æ•°ä¸æ˜¯ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯ç»å¸¸è¦ä½¿ç”¨ï¼Œæ¨èç¼–å†™ä¸€ä¸ª TOï¼ˆTransfer Objectï¼‰æ•°æ®ä¼ è¾“å¯¹è±¡\n1234Page&#123;\tint index;\tint size;&#125;\nÂ¶Demo\n123456public Employee getEmp(@Param(&quot;id&quot;)Integer id,String lastName);id ==&gt; #&#123;id&#125;lastName ==&gt; #&#123;param2&#125;public Employee getEmp(Integer id,@Param(&quot;e&quot;)Employee emp);id ==&gt; #&#123;id&#125;lastName ==&gt; #&#123;param2.lastName&#125;|#&#123;e.lastName&#125;\nğŸ¶å¦‚æœæ˜¯Collection(List,Set)ç±»å‹æˆ–è€…æ•°ç»„ï¼Œä¹Ÿä¼šç‰¹æ®Šå¤„ç†ï¼Œä¹Ÿæ˜¯æŠŠä¼ å…¥çš„listæˆ–è€…æ•°ç»„å°è£…åœ¨mapä¸­\n\n\n\nç±»å‹\nkey\n\n\n\n\nCollection\ncollection\n\n\nList\nlist\n\n\næ•°ç»„\narray\n\n\n\n12public Employee getEmpById(List&lt;Integer&gt; ids);//å–å‡ºç¬¬ä¸€ä¸ª id çš„å€¼ï¼š#&#123;list[0]&#125;\nğŸ¶å‚æ•°å¤šæ—¶ä¼šå°è£… mapï¼Œä¸ºäº†ä¸æ··ä¹±ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Paramæ¥æŒ‡å®šå°è£…æ—¶ä½¿ç”¨çš„key\nå¯¹äºå¤§å¤šæ•°ç®€å•çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸éœ€è¦ä½¿ç”¨å¤æ‚çš„å‚æ•°\n12345&lt;select id=&quot;selectUsers&quot; resultType=&quot;User&quot;&gt;  select id, username, password  from users  where id = #&#123;id&#125;&lt;/select&gt;\næ ¹æ®å‚æ•°ç±»å‹ï¼ˆparameterTypeï¼‰ä¼šè¢«è‡ªåŠ¨è®¾ç½®ä¸ºintï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥éšæ„å‘½å\nåŸå§‹ç±»å‹æˆ–ç®€å•æ•°æ®ç±»å‹ï¼ˆæ¯”å¦‚Integerå’ŒStringï¼‰å› ä¸ºæ²¡æœ‰å…¶ä»–å±æ€§ï¼Œä¼šç”¨å®ƒä»¬çš„å€¼æ¥ä½œä¸ºå‚æ•°ï¼Œç„¶è€Œï¼Œå¦‚æœä¼ å…¥ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œè¡Œä¸ºå°±ä¼šä¸ä¸€æ ·äº†\n1234&lt;insert id=&quot;insertUser&quot; parameterType=&quot;User&quot;&gt;  insert into users (id, username, password)  values (#&#123;id&#125;, #&#123;username&#125;, #&#123;password&#125;)&lt;/insert&gt;\nå¦‚æœ User ç±»å‹çš„å‚æ•°å¯¹è±¡ä¼ é€’åˆ°äº†è¯­å¥ä¸­ï¼Œä¼šæŸ¥æ‰¾ idã€username å’Œ password å±æ€§ï¼Œç„¶åå°†å®ƒä»¬çš„å€¼ä¼ å…¥é¢„å¤„ç†è¯­å¥çš„å‚æ•°ä¸­\nå‚æ•°ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®ç±»å‹\n1#&#123;property,javaType=int,jdbcType=NUMERIC&#125;\nå‡ ä¹æ€»æ˜¯å¯ä»¥æ ¹æ®å‚æ•°å¯¹è±¡çš„ç±»å‹ç¡®å®š javaTypeï¼Œé™¤éè¯¥å¯¹è±¡æ˜¯ä¸€ä¸ª HashMapã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½ éœ€è¦æ˜¾å¼æŒ‡å®š javaType æ¥ç¡®ä¿æ­£ç¡®çš„ç±»å‹å¤„ç†å™¨ï¼ˆTypeHandlerï¼‰è¢«ä½¿ç”¨ã€‚\nğŸ¶JDBC è¦æ±‚ï¼Œå¦‚æœä¸€ä¸ªåˆ—å…è®¸ä½¿ç”¨ null å€¼ï¼Œå¹¶ä¸”ä¼šä½¿ç”¨å€¼ä¸º null çš„å‚æ•°ï¼Œå°±å¿…é¡»è¦æŒ‡å®š JDBC ç±»å‹ï¼ˆjdbcTypeï¼‰\nè¦æ›´è¿›ä¸€æ­¥åœ°è‡ªå®šä¹‰ç±»å‹å¤„ç†æ–¹å¼ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹å¤„ç†å™¨ç±»ï¼ˆæˆ–åˆ«åï¼‰\n1#&#123;age,javaType=int,jdbcType=NUMERIC,typeHandler=MyTypeHandler&#125;\nå¯¹äºæ•°å€¼ç±»å‹ï¼Œè¿˜å¯ä»¥è®¾ç½® numericScale æŒ‡å®šå°æ•°ç‚¹åä¿ç•™çš„ä½æ•°\n1#&#123;height,javaType=double,jdbcType=NUMERIC,numericScale=2&#125;\nğŸ‘´å‚æ•°çš„é…ç½®å¥½åƒè¶Šæ¥è¶Šç¹çäº†ï¼Œä½†å®é™…ä¸Šï¼Œå¾ˆå°‘éœ€è¦å¦‚æ­¤ç¹ççš„é…ç½®\nmode å±æ€§å…è®¸ä½ æŒ‡å®š INï¼ŒOUT æˆ– INOUT å‚æ•°ã€‚å¦‚æœå‚æ•°çš„ mode ä¸º OUT æˆ– INOUTï¼Œå°†ä¼šä¿®æ”¹å‚æ•°å¯¹è±¡çš„å±æ€§å€¼ï¼Œä»¥ä¾¿ä½œä¸ºè¾“å‡ºå‚æ•°è¿”å›ã€‚ å¦‚æœ mode ä¸º OUTï¼ˆæˆ– INOUTï¼‰ï¼Œè€Œä¸” jdbcType ä¸º CURSORï¼ˆä¹Ÿå°±æ˜¯ Oracle çš„ REFCURSORï¼‰ï¼Œä½ å¿…é¡»æŒ‡å®šä¸€ä¸ª resultMap å¼•ç”¨æ¥å°†ç»“æœé›† ResultMap æ˜ å°„åˆ°å‚æ•°çš„ç±»å‹ä¸Šã€‚è¦æ³¨æ„è¿™é‡Œçš„ javaType å±æ€§æ˜¯å¯é€‰çš„ï¼Œå¦‚æœç•™ç©ºå¹¶ä¸” jdbcType æ˜¯ CURSORï¼Œå®ƒä¼šè¢«è‡ªåŠ¨åœ°è¢«è®¾ä¸º ResultMap\n1#&#123;department, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=departmentResultMap&#125;\nğŸ¶å¤§å¤šæ—¶å€™ï¼Œä½ åªé¡»ç®€å•æŒ‡å®šå±æ€§åï¼Œé¡¶å¤šè¦ä¸ºå¯èƒ½ä¸ºç©ºçš„åˆ—æŒ‡å®š jdbcTypeï¼Œå…¶ä»–çš„äº‹æƒ…äº¤ç»™ MyBatis è‡ªå·±å»æ¨æ–­å°±è¡Œäº†\n123#&#123;firstName&#125;#&#123;middleInitial,jdbcType=VARCHAR&#125;#&#123;lastName&#125;\nÂ¶å­—ç¬¦ä¸²æ›¿æ¢\n\n\n\nè¡¨è¾¾å¼\nå«ä¹‰\n\n\n\n\n#{}\nå¯ä»¥è·å– map ä¸­çš„å€¼æˆ–è€… pojo å¯¹è±¡å±æ€§çš„å€¼ï¼›æ˜¯ä»¥é¢„ç¼–è¯‘çš„å½¢å¼ï¼Œå°†å‚æ•°è®¾ç½®åˆ°sqlè¯­å¥ä¸­ï¼›ä½¿ç”¨PreparedStatementï¼›é˜²æ­¢ sql æ³¨å…¥\n\n\n${}\nå¯ä»¥è·å– map ä¸­çš„å€¼æˆ–è€… pojo å¯¹è±¡å±æ€§çš„å€¼ï¼›å–å‡ºçš„å€¼ç›´æ¥æ‹¼æ¥åœ¨sqlè¯­å¥ä¸­;å­˜åœ¨å®‰å…¨é—®é¢˜\n\n\n\nåŸç”Ÿ jdbc ä¸æ”¯æŒå ä½ç¬¦çš„åœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨$&#123;&#125;è¿›è¡Œå–å€¼ï¼Œå¦‚ï¼šåˆ†è¡¨ã€æ’åº\nå½“ SQL è¯­å¥ä¸­çš„å…ƒæ•°æ®ï¼ˆå¦‚è¡¨åæˆ–åˆ—åï¼‰æ˜¯åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²æ›¿æ¢å°†ä¼šéå¸¸æœ‰ç”¨ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ æƒ³ select ä¸€ä¸ªè¡¨ä»»æ„ä¸€åˆ—çš„æ•°æ®æ—¶ï¼Œä¸éœ€è¦è¿™æ ·å†™ï¼š\n12345678910@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)User findById(@Param(&quot;id&quot;) long id);@Select(&quot;select * from user where name = #&#123;name&#125;&quot;)User findByName(@Param(&quot;name&quot;) String name);@Select(&quot;select * from user where email = #&#123;email&#125;&quot;)User findByEmail(@Param(&quot;email&quot;) String email);// å…¶å®ƒçš„ &quot;findByXxx&quot; æ–¹æ³•\nè€Œæ˜¯å¯ä»¥åªå†™è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼š\n12@Select(&quot;select * from user where $&#123;column&#125; = #&#123;value&#125;&quot;)User findByColumn(@Param(&quot;column&quot;) String column, @Param(&quot;value&quot;) String value);\nå…¶ä¸­ $&#123;column&#125; ä¼šè¢«ç›´æ¥æ›¿æ¢ï¼Œè€Œ #&#123;value&#125; ä¼šä½¿ç”¨ ? é¢„å¤„ç†ã€‚ è¿™æ ·ï¼Œå°±èƒ½å®ŒæˆåŒæ ·çš„ä»»åŠ¡ï¼š\n123User userOfId1 = userMapper.findByColumn(&quot;id&quot;, 1L);User userOfNameKid = userMapper.findByColumn(&quot;name&quot;, &quot;kid&quot;);User userOfEmail = userMapper.findByColumn(&quot;email&quot;, &quot;noone@nowhere.com&quot;);\nè¿™ç§æ–¹å¼ä¹ŸåŒæ ·é€‚ç”¨äºæ›¿æ¢è¡¨åçš„æƒ…å†µ\nğŸ¶ç”¨è¿™ç§æ–¹å¼æ¥å—ç”¨æˆ·çš„è¾“å…¥ï¼Œå¹¶ç”¨ä½œè¯­å¥å‚æ•°æ˜¯ä¸å®‰å…¨çš„ï¼Œä¼šå¯¼è‡´æ½œåœ¨çš„ SQL æ³¨å…¥æ”»å‡»ï¼Œå› æ­¤ï¼Œè¦ä¹ˆä¸å…è®¸ç”¨æˆ·è¾“å…¥è¿™äº›å­—æ®µï¼Œè¦ä¹ˆè‡ªè¡Œè½¬ä¹‰å¹¶æ£€éªŒè¿™äº›å‚æ•°\nğŸ‘´å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å–å‚æ•°çš„å€¼éƒ½åº”è¯¥æ˜¯ä½¿ç”¨#&#123;&#125;\nÂ¶ç»“æœæ˜ å°„\nResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼šå¯¹ç®€å•çš„è¯­å¥åšåˆ°é›¶é…ç½®ï¼Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼Œåªéœ€è¦æè¿°è¯­å¥ä¹‹å‰çš„å…³ç³»å°±å¯ä»¥äº†\nå¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªé›†åˆï¼Œè¦å†™é›†åˆä¸­å…ƒç´ çš„ç±»å‹\n12@MapKey(&quot;lastName&quot;)public Map&lt;String, Employee&gt; getEmpByLastNameLikeReturnMap(String lastName);\n@Mapkeyå‘Šè¯‰ mybatis å°è£…è¿™ä¸ª map çš„æ—¶å€™ä½¿ç”¨é‚£ä¸ªå±æ€§ä½œä¸º map çš„ key\nè¿”å›ä¸€æ¡è®°å½•çš„ mapï¼Œkey æ˜¯åˆ—åï¼Œå€¼æ˜¯å¯¹åº”çš„å€¼\n1public Map&lt;String, Object&gt; getEmpByIdReturnMap(Integer id);\nÂ¶&lt;resultMap&gt;\nè‡ªå®šä¹‰ç»“æœé›†æ˜ å°„è§„åˆ™ï¼Œå®ç°é«˜çº§ç»“æœé›†æ˜ å°„\n\n\n\næ ‡ç­¾\nå«ä¹‰\n\n\n\n\n&lt;id&gt;\nå®šä¹‰ä¸»é”®åˆ—å°è£…è§„åˆ™ï¼Œåº•å±‚æœ‰ä¼˜åŒ–\n\n\n&lt;result&gt;\nå®šä¹‰æ™®é€šåˆ—å°è£…è§„åˆ™\n\n\n\n123456789&lt;resultMap type=&quot;com.atguigu.mybatis.bean.Employee&quot; id=&quot;MySimpleEmp&quot;&gt;   &lt;!--columnï¼šæŒ‡å®šå“ªä¸€åˆ— propertyï¼šæŒ‡å®šå¯¹åº”çš„javaBeanå±æ€§--&gt;\t&lt;!--å®šä¹‰ä¸»é”®åˆ—å°è£…è§„åˆ™--&gt;    &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;    &lt;!-- å®šä¹‰æ™®é€šåˆ—å°è£…è§„åˆ™ --&gt;    &lt;result column=&quot;last_name&quot; property=&quot;lastName&quot;/&gt;    &lt;result column=&quot;email&quot; property=&quot;email&quot;/&gt;    &lt;result column=&quot;gender&quot; property=&quot;gender&quot;/&gt;&lt;/resultMap&gt;\nğŸ‘´å…¶ä»–ä¸æŒ‡å®šçš„åˆ—ä¼šè‡ªåŠ¨å°è£…ï¼›åªè¦å†™ resultMap å°±æŠŠå…¨éƒ¨çš„æ˜ å°„è§„åˆ™éƒ½å†™ä¸Š\nå„ä¸ªå±æ€§å«ä¹‰ä¿¡æ¯\n\n\n\nå±æ€§\nå«ä¹‰\n\n\n\n\nproperty\næ˜ å°„åˆ° Java Bean çš„å±æ€§\n\n\ncolumn\næ•°æ®è¡¨çš„åˆ—å‘½\n\n\njavaType\nä¸€ä¸ª Java ç±»çš„å®Œå…¨é™å®šåï¼Œæˆ–ä¸€ä¸ªç±»å‹åˆ«åã€‚å¦‚æœæ˜ å°„åˆ°ä¸€ä¸ª Java Beanï¼ŒMyBatis é€šå¸¸å¯ä»¥æ–­å®šç±»å‹\n\n\njdbcType\nJDBC ç±»å‹æ˜¯ä»…ä»…éœ€è¦å¯¹æ’å…¥ï¼Œæ›´æ–°å’Œåˆ é™¤æ“ä½œå¯èƒ½ä¸ºç©ºçš„åˆ—è¿›è¡Œå¤„ç†\n\n\ntypeHandler\nç±»å‹å¤„ç†å™¨ï¼Œä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥è¦†ç›–é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ï¼Œè¿™ä¸ªå±æ€§å€¼æ˜¯ç±»çš„å®Œå…¨é™å®šåæˆ–è€…æ˜¯ä¸€ä¸ªç±»å‹å¤„ç†å™¨çš„å®ç°ï¼Œæˆ–è€…æ˜¯ç±»å‹åˆ«å\n\n\n\nÂ¶åœºæ™¯ä¸€ï¼šè”åˆæŸ¥è¯¢\næŸ¥è¯¢ Employee çš„åŒæ—¶æŸ¥è¯¢å‘˜å·¥å¯¹åº”çš„éƒ¨é—¨\n12345678&lt;resultMap type=&quot;com.atguigu.mybatis.bean.Employee&quot; id=&quot;MyDifEmp&quot;&gt;\t&lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;\t&lt;result column=&quot;last_name&quot; property=&quot;lastName&quot;/&gt;    &lt;result column=&quot;gender&quot; property=&quot;gender&quot;/&gt;    &lt;!--çº§è”èµ‹å€¼--&gt;    &lt;result column=&quot;did&quot; property=&quot;dept.id&quot;/&gt;    &lt;result column=&quot;dept_name&quot; property=&quot;dept.departmentName&quot;/&gt;&lt;/resultMap&gt;\nä½¿ç”¨&lt;association&gt;å®šä¹‰å…³è”çš„å•ä¸ªå¯¹è±¡çš„å°è£…è§„åˆ™,association æŒ‡å®šè”åˆçš„ javaBean å¯¹è±¡\n12345&lt;!--propertyæŒ‡å®šé‚£ä¸ªå±æ€§æ˜¯è”åˆå¯¹è±¡ï¼ŒjavaType:æŒ‡å®šè¿™ä¸ªå±æ€§å¯¹è±¡çš„ç±»å‹--&gt;&lt;association property=&quot;dept&quot; javaType=&quot;com.atguigu.mybatis.bean.Department&quot;&gt;    &lt;id column=&quot;did&quot; property=&quot;id&quot;/&gt;    &lt;result column=&quot;dept_name&quot; property=&quot;departmentName&quot;/&gt;&lt;/association&gt;\nÂ¶åœºæ™¯ä¸€ï¼šåˆ†æ­¥æŸ¥è¯¢\nä½¿ç”¨ association è¿›è¡Œåˆ†å¸ƒæŸ¥è¯¢\n\nå…ˆæŒ‰ç…§å‘˜å·¥ id æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯\næ ¹æ®æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ä¸­çš„ d_id å€¼å»éƒ¨é—¨è¡¨æŸ¥å‡ºéƒ¨é—¨ä¿¡æ¯\néƒ¨é—¨ä¿¡æ¯è®¾ç½®åˆ°å‘˜å·¥ä¸­\n\n12345678910111213141516&lt;result column=&quot;gender&quot; property=&quot;gender&quot;/&gt;   &lt;!-- associationå®šä¹‰å…³è”å¯¹è±¡çš„å°è£…è§„åˆ™      select:è¡¨æ˜å½“å‰å±æ€§æ˜¯è°ƒç”¨selectæŒ‡å®šçš„æ–¹æ³•æŸ¥å‡ºçš„ç»“æœ      column:æŒ‡å®šå°†å“ªä¸€åˆ—çš„å€¼ä¼ ç»™è¿™ä¸ªæ–¹æ³•      æµç¨‹ï¼šä½¿ç”¨selectæŒ‡å®šçš„æ–¹æ³•ï¼ˆä¼ å…¥columnæŒ‡å®šçš„è¿™åˆ—å‚æ•°çš„å€¼ï¼‰æŸ¥å‡ºå¯¹è±¡ï¼Œå¹¶å°è£…ç»™propertyæŒ‡å®šçš„å±æ€§    --&gt;   &lt;association property=&quot;dept&quot;      select=&quot;com.atguigu.mybatis.dao.DepartmentMapper.getDeptById&quot;      column=&quot;d_id&quot;&gt;   &lt;/association&gt;&lt;/resultMap&gt;&lt;!--  public Employee getEmpByIdStep(Integer id);--&gt;&lt;select id=&quot;getEmpByIdStep&quot; resultMap=&quot;MyEmpByStep&quot;&gt;   select * from tbl_employee where id=#&#123;id&#125;&lt;/select&gt;\nåˆ†æ®µæŸ¥è¯¢çš„åŸºç¡€ä¹‹ä¸ŠåŠ ä¸Šä¸¤ä¸ªé…ç½®ï¼Œå¯ä»¥å®ç°å»¶è¿ŸåŠ è½½ï¼ˆæ‡’åŠ è½½ã€æŒ‰éœ€åŠ è½½ï¼‰\n123456&lt;settings&gt;\t&lt;setting name=&quot;jdbcTypeForNull&quot; value=&quot;NULL&quot;/&gt;\t&lt;!--æ˜¾ç¤ºçš„æŒ‡å®šæ¯ä¸ªæˆ‘ä»¬éœ€è¦æ›´æ”¹çš„é…ç½®çš„å€¼ï¼Œå³ä½¿ä»–æ˜¯é»˜è®¤çš„ã€‚é˜²æ­¢ç‰ˆæœ¬æ›´æ–°å¸¦æ¥çš„é—®é¢˜  --&gt;\t&lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;\t&lt;setting name=&quot;aggressiveLazyLoading&quot; value=&quot;false&quot;/&gt;&lt;/settings&gt;\nÂ¶åœºæ™¯äºŒï¼šè”åˆæŸ¥è¯¢\næŸ¥è¯¢éƒ¨é—¨çš„æ—¶å€™å°†éƒ¨é—¨å¯¹åº”çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ä¹ŸæŸ¥è¯¢å‡ºæ¥\n123456public class Department &#123;   private Integer id;   private String departmentName;   private List&lt;Employee&gt; emps;&#125;\n123456789@Alias(&quot;emp&quot;)public class Employee &#123;   private Integer id;   private String lastName;   private String email;   private String gender;   private Department dept;&#125;\n12345678910111213141516171819202122232425&lt;!--åµŒå¥—ç»“æœé›†çš„æ–¹å¼ï¼Œä½¿ç”¨collectionæ ‡ç­¾å®šä¹‰å…³è”çš„é›†åˆç±»å‹çš„å±æ€§å°è£…è§„åˆ™  --&gt;&lt;resultMap type=&quot;com.atguigu.mybatis.bean.Department&quot; id=&quot;MyDept&quot;&gt;   &lt;id column=&quot;did&quot; property=&quot;id&quot;/&gt;   &lt;result column=&quot;dept_name&quot; property=&quot;departmentName&quot;/&gt;   &lt;!--      collectionå®šä¹‰å…³è”é›†åˆç±»å‹çš„å±æ€§çš„å°è£…è§„åˆ™      ofType:æŒ‡å®šé›†åˆé‡Œé¢å…ƒç´ çš„ç±»å‹   --&gt;   &lt;collection property=&quot;emps&quot; ofType=&quot;com.atguigu.mybatis.bean.Employee&quot;&gt;      &lt;!-- å®šä¹‰è¿™ä¸ªé›†åˆä¸­å…ƒç´ çš„å°è£…è§„åˆ™ --&gt;      &lt;id column=&quot;eid&quot; property=&quot;id&quot;/&gt;      &lt;result column=&quot;last_name&quot; property=&quot;lastName&quot;/&gt;      &lt;result column=&quot;email&quot; property=&quot;email&quot;/&gt;      &lt;result column=&quot;gender&quot; property=&quot;gender&quot;/&gt;   &lt;/collection&gt;&lt;/resultMap&gt;&lt;!-- public Department getDeptByIdPlus(Integer id); --&gt;&lt;select id=&quot;getDeptByIdPlus&quot; resultMap=&quot;MyDept&quot;&gt;   SELECT d.id did,d.dept_name dept_name,         e.id eid,e.last_name last_name,e.email email,e.gender gender   FROM tbl_dept d   LEFT JOIN tbl_employee e   ON d.id=e.d_id   WHERE d.id=#&#123;id&#125;&lt;/select&gt;\nÂ¶åœºæ™¯äºŒï¼šåˆ†æ­¥æŸ¥è¯¢\n1234567891011&lt;resultMap type=&quot;com.atguigu.mybatis.bean.Department&quot; id=&quot;MyDeptStep&quot;&gt;   &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;   &lt;id column=&quot;dept_name&quot; property=&quot;departmentName&quot;/&gt;   &lt;collection property=&quot;emps&quot;      select=&quot;com.atguigu.mybatis.dao.EmployeeMapperPlus.getEmpsByDeptId&quot;      column=&quot;&#123;deptId=id&#125;&quot; fetchType=&quot;lazy&quot;&gt;&lt;/collection&gt;&lt;/resultMap&gt;&lt;!-- public Department getDeptByIdStep(Integer id); --&gt;&lt;select id=&quot;getDeptByIdStep&quot; resultMap=&quot;MyDeptStep&quot;&gt;   select id,dept_name from tbl_dept where id=#&#123;id&#125;&lt;/select&gt;\nğŸ“–å¤šåˆ—çš„å€¼ä¼ é€’è¿‡å»ï¼šå°†å¤šåˆ—çš„å€¼å°è£… map ä¼ é€’ï¼›column=â€œ{key1=column1,key2=column2}â€\nfetchType=â€œlazyâ€ï¼šè¡¨ç¤ºä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼›- lazyï¼šå»¶è¿Ÿ- eagerï¼šç«‹å³\nÂ¶discriminatorï¼ˆé‰´åˆ«å™¨ï¼‰\nmybatis å¯ä»¥ä½¿ç”¨ discriminator åˆ¤æ–­æŸåˆ—çš„å€¼ï¼Œç„¶åæ ¹æ®æŸåˆ—çš„å€¼æ”¹å˜å°è£…è¡Œä¸º\nå°è£… Employeeï¼š\n\nå¦‚æœæŸ¥å‡ºçš„æ˜¯å¥³ç”Ÿï¼šå°±æŠŠéƒ¨é—¨ä¿¡æ¯æŸ¥è¯¢å‡ºæ¥ï¼Œå¦åˆ™ä¸æŸ¥è¯¢ï¼›\nå¦‚æœæ˜¯ç”·ç”Ÿï¼ŒæŠŠ last_name è¿™ä¸€åˆ—çš„å€¼èµ‹å€¼ç»™ email;\n\n\n12345678910111213141516171819202122232425&lt;resultMap type=&quot;com.atguigu.mybatis.bean.Employee&quot; id=&quot;MyEmpDis&quot;&gt;    &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;    &lt;result column=&quot;last_name&quot; property=&quot;lastName&quot;/&gt;    &lt;result column=&quot;email&quot; property=&quot;email&quot;/&gt;    &lt;result column=&quot;gender&quot; property=&quot;gender&quot;/&gt;    &lt;!--      columnï¼šæŒ‡å®šåˆ¤å®šçš„åˆ—å      javaTypeï¼šåˆ—å€¼å¯¹åº”çš„javaç±»å‹  --&gt;    &lt;discriminator javaType=&quot;string&quot; column=&quot;gender&quot;&gt;        &lt;!--å¥³ç”Ÿ  resultType:æŒ‡å®šå°è£…çš„ç»“æœç±»å‹ï¼›ä¸èƒ½ç¼ºå°‘ã€‚/resultMap--&gt;        &lt;case value=&quot;0&quot; resultType=&quot;com.atguigu.mybatis.bean.Employee&quot;&gt;            &lt;association property=&quot;dept&quot;                         select=&quot;com.atguigu.mybatis.dao.DepartmentMapper.getDeptById&quot;                         column=&quot;d_id&quot;&gt;            &lt;/association&gt;        &lt;/case&gt;        &lt;!--ç”·ç”Ÿ ;å¦‚æœæ˜¯ç”·ç”Ÿï¼ŒæŠŠlast_nameè¿™ä¸€åˆ—çš„å€¼èµ‹å€¼ç»™email; --&gt;        &lt;case value=&quot;1&quot; resultType=&quot;com.atguigu.mybatis.bean.Employee&quot;&gt;            &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;            &lt;result column=&quot;last_name&quot; property=&quot;lastName&quot;/&gt;            &lt;result column=&quot;last_name&quot; property=&quot;email&quot;/&gt;            &lt;result column=&quot;gender&quot; property=&quot;gender&quot;/&gt;        &lt;/case&gt;    &lt;/discriminator&gt;&lt;/resultMap&gt;\n","dateCreated":"2021-11-26T07:20:14+00:00","dateModified":"2023-06-07T02:13:34+00:00","datePublished":"2021-11-26T07:20:14+00:00","description":"æœ¬æ–‡ä¸»è¦è®°å½• MyBatis æ˜ å°„æ–‡ä»¶çš„ä¹¦å†™æ ¼å¼","headline":"MyBatisæ˜ å°„æ–‡ä»¶","image":["https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mybatis.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://pineapple-man.github.io/mybatis%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6/"},"publisher":{"@type":"Organization","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png","logo":{"@type":"ImageObject","url":"logo.png"}},"url":"https://pineapple-man.github.io/mybatis%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6/","keywords":"MyBatis","thumbnailUrl":"https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mybatis.jpg"}</script><meta name="description" content="æœ¬æ–‡ä¸»è¦è®°å½• MyBatis æ˜ å°„æ–‡ä»¶çš„ä¹¦å†™æ ¼å¼"><meta property="og:type" content="blog"><meta property="og:title" content="MyBatisæ˜ å°„æ–‡ä»¶"><meta property="og:url" content="https://pineapple-man.github.io/mybatis%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6/"><meta property="og:site_name" content="pineapple-man"><meta property="og:description" content="æœ¬æ–‡ä¸»è¦è®°å½• MyBatis æ˜ å°„æ–‡ä»¶çš„ä¹¦å†™æ ¼å¼"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-11-26T07:20:14.000Z"><meta property="article:modified_time" content="2023-06-07T02:13:34.015Z"><meta property="article:author" content="pineapple-man"><meta property="article:tag" content="MyBatis"><meta name="twitter:card" content="summary"><meta property="og:image" content="https://pineapple-man.github.io/assets/images/logo.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mybatis.jpg"><meta class="swiftype" name="image" data-type="enum" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/mybatis.jpg"><link rel="stylesheet" href="/assets/css/style-oth3meuzcjopbgwqbdvoxqknhcm0sy9wkullcc94zhkkop3pmfrpl5t4fzzz.min.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-210516333-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-210516333-1")</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"></head><body><div id="blog"><header id="header" data-behavior="5"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><div class="header-title"><a class="header-title-link" href="/" aria-label="">pineapple-man</a></div><a class="header-right-picture" href="#about" aria-label="æ‰“å¼€é“¾æ¥: /#about"><img class="header-picture" src="/assets/images/logo.png" alt="ä½œè€…çš„å›¾ç‰‡"></a></header><nav id="sidebar" data-behavior="5"><div class="sidebar-container"><div class="sidebar-profile"><a href="/#about" aria-label="é˜…è¯»æœ‰å…³ä½œè€…çš„æ›´å¤šä¿¡æ¯"><img class="sidebar-profile-picture" src="/assets/images/logo.png" alt="ä½œè€…çš„å›¾ç‰‡"></a><h4 class="sidebar-profile-name">pineapple-man</h4><h5 class="sidebar-profile-bio"><p>åšä¸€ä¸ªè èï¼šç«™å¾—ç¬”ç›´ï¼Œå¤´æˆ´ç‹å† ï¼Œå†…å¿ƒç”œç¾</p></h5></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="/" rel="noopener" title="é¦–é¡µ"><i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i> <span class="sidebar-button-desc">é¦–é¡µ</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-categories" rel="noopener" title="åˆ†ç±»"><i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i> <span class="sidebar-button-desc">åˆ†ç±»</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-tags" rel="noopener" title="æ ‡ç­¾"><i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i> <span class="sidebar-button-desc">æ ‡ç­¾</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-archives" rel="noopener" title="å½’æ¡£"><i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i> <span class="sidebar-button-desc">å½’æ¡£</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="#about" rel="noopener" title="å…³äº"><i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i> <span class="sidebar-button-desc">å…³äº</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="https://github.com/pineapple-man" target="_blank" rel="noopener" title="GitHub"><i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i> <span class="sidebar-button-desc">GitHub</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="mailto://mingchaohu720@gmail.com" target="_blank" rel="noopener" title="é‚®ç®±"><i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i> <span class="sidebar-button-desc">é‚®ç®±</span></a></li></ul></div></nav><div id="main" data-behavior="5" class="hasCoverMetaIn"><article class="post"><div class="post-header main-content-wrap text-center"><h1 class="post-title">MyBatisæ˜ å°„æ–‡ä»¶</h1><div class="post-meta"><time datetime="2021-11-26T07:20:14+00:00">11æœˆ 26, 2021 </time><span>å‘å¸ƒåœ¨ </span><a class="category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">ä¸­é—´ä»¶</a> <i class="fas fa-book-open"></i> æœ¬æ–‡å…±<span class="post-count"> 4.4k </span>å­— <i class="far fa-clock"></i> é˜…è¯»é¢„è®¡<span class="post-count"> 48 </span>åˆ†é’Ÿ</div></div><div class="post-content markdown"><div class="main-content-wrap"><h1 id="table-of-contents">ç›®å½•</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#XML-%E6%98%A0%E5%B0%84%E5%99%A8"><span class="toc-text">XML æ˜ å°„å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#select"><span class="toc-text">&lt;select&gt;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE"><span class="toc-text">å¸¸è§é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%95%E5%B1%82%E8%AE%BE%E8%AE%A1"><span class="toc-text">åº•å±‚è®¾è®¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-text">å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#insert-update-delete"><span class="toc-text">insert,update&amp;delete</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%87%AA%E5%A2%9E%E4%B8%BB%E9%94%AE%E7%9A%84%E5%80%BC"><span class="toc-text">è·å–è‡ªå¢ä¸»é”®çš„å€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%9D%9E%E8%87%AA%E5%A2%9E%E4%B8%BB%E9%94%AE%E7%9A%84%E5%80%BC"><span class="toc-text">è·å–éè‡ªå¢ä¸»é”®çš„å€¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86"><span class="toc-text">å‚æ•°å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-text">å•ä¸ªå‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-text">å¤šä¸ªå‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E5%90%8D%E5%8F%82%E6%95%B0"><span class="toc-text">å‘½åå‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#POJO"><span class="toc-text">POJO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Map"><span class="toc-text">Map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TO"><span class="toc-text">TO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Demo"><span class="toc-text">Demo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9B%BF%E6%8D%A2"><span class="toc-text">å­—ç¬¦ä¸²æ›¿æ¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E6%98%A0%E5%B0%84"><span class="toc-text">ç»“æœæ˜ å°„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#resultMap"><span class="toc-text">&lt;resultMap&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E4%B8%80%EF%BC%9A%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-text">åœºæ™¯ä¸€ï¼šè”åˆæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E4%B8%80%EF%BC%9A%E5%88%86%E6%AD%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">åœºæ™¯ä¸€ï¼šåˆ†æ­¥æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E4%BA%8C%EF%BC%9A%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-text">åœºæ™¯äºŒï¼šè”åˆæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E4%BA%8C%EF%BC%9A%E5%88%86%E6%AD%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">åœºæ™¯äºŒï¼šåˆ†æ­¥æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discriminator%EF%BC%88%E9%89%B4%E5%88%AB%E5%99%A8%EF%BC%89"><span class="toc-text">discriminatorï¼ˆé‰´åˆ«å™¨ï¼‰</span></a></li></ol></li></ol><h2 id="XML-æ˜ å°„å™¨"><a class="header-anchor" href="#XML-æ˜ å°„å™¨">Â¶</a>XML æ˜ å°„å™¨</h2><p>MyBatis çš„çœŸæ­£å¼ºå¤§åœ¨äºå®ƒçš„è¯­å¥æ˜ å°„ï¼ŒSQL æ˜ å°„æ–‡ä»¶åªæœ‰å¾ˆå°‘çš„å‡ ä¸ªé¡¶çº§å…ƒç´ ï¼ˆæ ¹æ®åº”è¢«å®šä¹‰çš„é¡ºåºåˆ—å‡ºï¼‰ï¼š</p><table><thead><tr><th style="text-align:center">æ ‡ç­¾</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center"><code>cache</code></td><td style="text-align:center">è¯¥å‘½åç©ºé—´çš„ç¼“å­˜é…ç½®</td></tr><tr><td style="text-align:center"><code>cache-ref</code></td><td style="text-align:center">å¼•ç”¨å…¶ä»–å‘½ä»¤ç©ºé—´çš„ç¼“å­˜é…ç½®</td></tr><tr><td style="text-align:center"><code>resultMap</code></td><td style="text-align:center">æè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­åŠ è½½å¯¹è±¡ï¼Œæ—¶æœ€å¤æ‚ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„å…ƒç´ </td></tr><tr><td style="text-align:center"><code>sql</code></td><td style="text-align:center">å¯è¢«å…¶å®ƒè¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯­å¥å—</td></tr><tr><td style="text-align:center"><code>insert</code></td><td style="text-align:center">æ˜ å°„æ’å…¥è¯­å¥</td></tr><tr><td style="text-align:center"><code>update</code></td><td style="text-align:center">æ˜ å°„æ›´æ–°è¯­å¥</td></tr><tr><td style="text-align:center"><code>delete</code></td><td style="text-align:center">æ˜ å°„åˆ é™¤è¯­å¥</td></tr><tr><td style="text-align:center"><code>select</code></td><td style="text-align:center">æ˜ å°„æŸ¥è¯¢è¯­å¥</td></tr></tbody></table><h2 id="select"><a class="header-anchor" href="#select">Â¶</a><code>&lt;select&gt;</code></h2><p>å¤šæ•°åº”ç”¨éƒ½æ˜¯<strong>æŸ¥è¯¢å¯†é›†å‹</strong>ï¼Œæ‰€ä»¥å…ˆä»æŸ¥è¯¢å¼€å§‹</p><p>ğŸ¶ MyBatis çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€æ˜¯ï¼šåœ¨æ¯ä¸ªæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤æ“ä½œä¹‹é—´ï¼Œé€šå¸¸ä¼šæ‰§è¡Œå¤šä¸ªæŸ¥è¯¢æ“ä½œ</p><h3 id="å¸¸è§é…ç½®"><a class="header-anchor" href="#å¸¸è§é…ç½®">Â¶</a>å¸¸è§é…ç½®</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectPerson&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;hashmap&quot;</span>&gt;</span></span><br><span class="line">  SELECT * FROM PERSON WHERE ID = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>âœ¨è¯­å¥ç‰¹ç‚¹</p><ol><li>è¿™ä¸ªè¯­å¥åæ˜¯<code>selectPerson</code></li><li>æ¥å—ä¸€ä¸ª<code>int(Integer)</code>ç±»å‹çš„å‚æ•°</li><li>è¿”å›ä¸€ä¸ª<code>HashMap</code>ç±»å‹çš„å¯¹è±¡ï¼Œå…¶ä¸­é”®æ˜¯åˆ—åï¼Œå€¼ä¾¿æ˜¯ç»“æœè¡Œä¸­çš„å¯¹åº”å€¼</li><li>å‚æ•°ä½¿ç”¨<code>#&#123;&#125;</code>è¿›è¡Œè·å–</li></ol><h3 id="åº•å±‚è®¾è®¡"><a class="header-anchor" href="#åº•å±‚è®¾è®¡">Â¶</a>åº•å±‚è®¾è®¡</h3><p>ä»¥ä¸Šçš„æŸ¥è¯¢è¯­å¥ï¼Œå…¶å®å°±æ˜¯å‘Šè¯‰ MyBatis åˆ›å»ºä¸€ä¸ªé¢„å¤„ç†è¯­å¥(PreparedStatement)å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">selectPerson</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM PERSON WHERE ID=?&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(selectPerson);</span><br><span class="line">ps.setInt(<span class="number">1</span>,id);</span><br></pre></td></tr></table></figure><h3 id="å±æ€§"><a class="header-anchor" href="#å±æ€§">Â¶</a>å±æ€§</h3><p>select å…ƒç´ å¯ä»¥é…ç½®å¾ˆå¤šå±æ€§æ¥é…ç½®æ¯æ¡è¯­å¥çš„è¡Œä¸ºç»†èŠ‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;selectPerson&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">parameterMap</span>=<span class="string">&quot;deprecated&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">resultType</span>=<span class="string">&quot;hashmap&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">resultMap</span>=<span class="string">&quot;personResultMap&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">flushCache</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">useCache</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">timeout</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">fetchSize</span>=<span class="string">&quot;256&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">statementType</span>=<span class="string">&quot;PREPARED&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">resultSetType</span>=<span class="string">&quot;FORWARD_ONLY&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">å±æ€§</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">resultType</td><td style="text-align:center">æœŸæœ›ä»è¿™æ¡è¯­å¥ä¸­è¿”å›ç»“æœçš„ç±»å…¨é™å®šåæˆ–åˆ«åã€‚ æ³¨æ„ï¼Œå¦‚æœè¿”å›çš„æ˜¯é›†åˆï¼Œé‚£åº”è¯¥è®¾ç½®ä¸ºé›†åˆåŒ…å«çš„ç±»å‹ï¼Œè€Œä¸æ˜¯é›†åˆæœ¬èº«çš„ç±»å‹ã€‚ resultType å’Œ resultMap ä¹‹é—´åªèƒ½åŒæ—¶ä½¿ç”¨ä¸€ä¸ªã€‚</td></tr></tbody></table><h2 id="insert-update-delete"><a class="header-anchor" href="#insert-update-delete">Â¶</a><code>insert</code>,<code>update</code>&amp;<code>delete</code></h2><p>æ•°æ®å˜æ›´è¯­å¥ insertï¼Œupdate å’Œ delete çš„å®ç°éå¸¸æ¥è¿‘ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;insertAuthor&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">parameterType</span>=<span class="string">&quot;domain.blog.Author&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">flushCache</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">statementType</span>=<span class="string">&quot;PREPARED&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">keyProperty</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">keyColumn</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">timeout</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;updateAuthor&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">parameterType</span>=<span class="string">&quot;domain.blog.Author&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">flushCache</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">statementType</span>=<span class="string">&quot;PREPARED&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">timeout</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;deleteAuthor&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">parameterType</span>=<span class="string">&quot;domain.blog.Author&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">flushCache</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">statementType</span>=<span class="string">&quot;PREPARED&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">timeout</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="è·å–è‡ªå¢ä¸»é”®çš„å€¼"><a class="header-anchor" href="#è·å–è‡ªå¢ä¸»é”®çš„å€¼">Â¶</a>è·å–è‡ªå¢ä¸»é”®çš„å€¼</h3><p>mysql æ”¯æŒè‡ªå¢ä¸»é”®ï¼Œè‡ªå¢ä¸»é”®å€¼çš„è·å–ï¼Œmybatis åˆ©ç”¨<code>statement.getGeneratedKeys()</code></p><p><code>useGenerateKeys=&quot;true&quot;</code>ä½¿ç”¨è‡ªå¢ä¸»é”®è·å–ä¸»é”®å€¼ç­–ç•¥</p><p><code>keyProperty</code>æŒ‡å®šå¯¹åº”çš„ä¸»é”®å±æ€§ï¼Œä¹Ÿå°±æ˜¯ mybatis è·å–åˆ°ä¸»é”®å€¼ä»¥åï¼Œå°†è¿™ä¸ªå€¼å°è£…ç»™ javabean çš„é‚£ä¸ªå±æ€§</p><table><thead><tr><th style="text-align:center">å±æ€§</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center"><code>databaseId</code></td><td style="text-align:center">å¦‚æœé…ç½®äº†æ•°æ®åº“å‚å•†æ ‡è¯†ï¼ˆdatabaseIdProviderï¼‰ï¼ŒMyBatis ä¼šåŠ è½½æ‰€æœ‰ä¸å¸¦ databaseId æˆ–åŒ¹é…å½“å‰ databaseId çš„è¯­å¥ï¼›å¦‚æœå¸¦å’Œä¸å¸¦çš„è¯­å¥éƒ½æœ‰ï¼Œåˆ™ä¸å¸¦çš„ä¼šè¢«å¿½ç•¥ã€‚</td></tr></tbody></table><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- public void addEmp(Employee employee); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addEmp&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Employee&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">databaseId</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">   insert into tbl_employee(last_name,email,gender)</span><br><span class="line">   values(#&#123;lastName&#125;,#&#123;email&#125;,#&#123;gender&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="è·å–éè‡ªå¢ä¸»é”®çš„å€¼"><a class="header-anchor" href="#è·å–éè‡ªå¢ä¸»é”®çš„å€¼">Â¶</a>è·å–éè‡ªå¢ä¸»é”®çš„å€¼</h3><p>Oracle ä¸æ”¯æŒè‡ªå¢ä½¿çš„æ•°æ®åº“ï¼Œä½¿ç”¨ selectKey å­å…ƒç´ </p><p>âœ¨selectKey å…ƒç´ å°†ä¼šé¦–å…ˆè¿è¡Œï¼Œ id ä¼šè¢«è®¾ç½®ï¼Œ ç„¶åæ’å…¥è¯­å¥ä¼šè¢«è°ƒç”¨</p><table><thead><tr><th style="text-align:center">å±æ€§</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">keyProperty</td><td style="text-align:center">ä»…é€‚ç”¨äº insert å’Œ updateï¼ŒæŒ‡å®šèƒ½å¤Ÿå”¯ä¸€è¯†åˆ«å¯¹è±¡çš„å±æ€§ï¼ŒMyBatis ä¼šä½¿ç”¨ getGeneratedKeys çš„è¿”å›å€¼æˆ– insert è¯­å¥çš„ selectKey å­å…ƒç´ è®¾ç½®å®ƒçš„å€¼ï¼Œé»˜è®¤å€¼ï¼šæœªè®¾ç½®ï¼ˆ<code>unset</code>ï¼‰ã€‚å¦‚æœç”Ÿæˆåˆ—ä¸æ­¢ä¸€ä¸ªï¼Œå¯ä»¥ç”¨é€—å·åˆ†éš”å¤šä¸ªå±æ€§åç§°ã€‚</td></tr><tr><td style="text-align:center">order</td><td style="text-align:center">â€œBEFOREâ€:å½“å‰ sql åœ¨æ’å…¥ sql ä¹‹å‰è¿è¡Œ<br>â€œAFTERâ€ï¼šå½“å‰ sql åœ¨æ’å…¥ sql ä¹‹åè¿è¡Œ</td></tr></tbody></table><p>ğŸ¶BEFORE ä¸ AFTER çš„è¿è¡Œé¡ºåº</p><ul><li><code>BEFORE</code>:<ul><li>å…ˆè¿è¡Œ selectKey æŸ¥è¯¢ id çš„ sqlï¼›æŸ¥å‡º id å€¼å°è£…ç»™ javaBean çš„ id å±æ€§</li><li>å†è¿è¡Œæ’å…¥çš„ sqlï¼›å°±å¯ä»¥å–å‡º id å±æ€§å¯¹åº”çš„å€¼</li></ul></li><li><code>AFTER</code><ul><li>å…ˆè¿è¡Œæ’å…¥çš„ sqlï¼ˆä»åºåˆ—ä¸­å–å‡ºæ–°å€¼ä½œä¸º idï¼‰ï¼›</li><li>å†è¿è¡Œ selectKey æŸ¥è¯¢ id çš„ sqlï¼›</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addEmp&quot;</span> <span class="attr">databaseId</span>=<span class="string">&quot;oracle&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">order</span>=<span class="string">&quot;BEFORE&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Integer&quot;</span>&gt;</span></span><br><span class="line">        select EMPLOYEES_SEQ.nextval from dual</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ’å…¥æ—¶çš„ä¸»é”®æ˜¯ä»åºåˆ—ä¸­æ‹¿åˆ°çš„ --&gt;</span></span><br><span class="line">    insert into employees(EMPLOYEE_ID,LAST_NAME,EMAIL)</span><br><span class="line">    values(#&#123;id&#125;,#&#123;lastName&#125;,#&#123;email,jdbcType=NULL&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å‚æ•°å¤„ç†"><a class="header-anchor" href="#å‚æ•°å¤„ç†">Â¶</a>å‚æ•°å¤„ç†</h2><p>DAO å’Œ MyBatis Mapper ä¹‹é—´å‚æ•°ä¼ é€’çš„å¤„ç†</p><h3 id="å•ä¸ªå‚æ•°"><a class="header-anchor" href="#å•ä¸ªå‚æ•°">Â¶</a>å•ä¸ªå‚æ•°</h3><p>å¯ä»¥æ¥å—åŸºæœ¬ç±»å‹ï¼Œ å¯¹è±¡ç±»å‹ã€‚ è¿™ç§æƒ…å†µ MyBatis å¯ç›´æ¥ä½¿ç”¨è¿™ä¸ªå‚æ•°ï¼Œ ä¸éœ€è¦ç»è¿‡ä»»ä½•å¤„ç†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;å‚æ•°å/ä»»æ„å&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤šä¸ªå‚æ•°"><a class="header-anchor" href="#å¤šä¸ªå‚æ•°">Â¶</a>å¤šä¸ªå‚æ•°</h3><p>ä»»æ„å¤šä¸ªå‚æ•°ï¼Œ éƒ½ä¼šè¢« MyBatis <strong>é‡æ–°åŒ…è£…æˆä¸€ä¸ª Map ä¼ å…¥</strong></p><p>âœ¨Map çš„ key æ˜¯ param1ï¼Œparam2ï¼Œ æˆ–è€… 0ï¼Œ 1â€¦ï¼Œ å€¼å°±æ˜¯å‚æ•°çš„å€¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key: param1 .. paramN</span><br><span class="line">valueï¼šä¼ å…¥çš„å‚æ•°å€¼</span><br><span class="line">#&#123;param1&#125;å°±æ˜¯ä»mapä¸­è·å–æŒ‡å®šçš„keyçš„å€¼</span><br></pre></td></tr></table></figure><h3 id="å‘½åå‚æ•°"><a class="header-anchor" href="#å‘½åå‚æ•°">Â¶</a>å‘½åå‚æ•°</h3><p>ğŸ¶æ˜ç¡®æŒ‡å®šå°è£…å‚æ•°æ—¶ map çš„ key <code>@Param(&quot;id&quot;)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key:ä½¿ç”¨@Paramæ³¨è§£æŒ‡å®šçš„å€¼</span><br><span class="line">value:å‚æ•°å€¼</span><br><span class="line">#&#123;æŒ‡å®šçš„key&#125;å–å‡ºå¯¹åº”çš„å‚æ•°å€¼</span><br></pre></td></tr></table></figure><h3 id="POJO"><a class="header-anchor" href="#POJO">Â¶</a>POJO</h3><p>å¦‚æœå¤šä¸ªå‚æ•°æ­£å¥½æ˜¯æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘çš„æ•°æ®æ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä¼ å…¥ POJO</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;å±æ€§å&#125;:å–å‡ºä¼ å…¥çš„pojoçš„å±æ€§å€¼</span><br></pre></td></tr></table></figure><h3 id="Map"><a class="header-anchor" href="#Map">Â¶</a>Map</h3><p>å¦‚æœå¤šä¸ªå‚æ•°ä¸æ˜¯ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ï¼Œæ²¡æœ‰å¯¹åº”çš„ pojoï¼Œä¸ç»å¸¸ä½¿ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¼ å…¥ map</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;key&#125;:å–å‡ºmapä¸­å¯¹åº”çš„å€¼</span><br></pre></td></tr></table></figure><h3 id="TO"><a class="header-anchor" href="#TO">Â¶</a>TO</h3><p>å¦‚æœå¤šä¸ªå‚æ•°ä¸æ˜¯ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯ç»å¸¸è¦ä½¿ç”¨ï¼Œæ¨èç¼–å†™ä¸€ä¸ª TOï¼ˆTransfer Objectï¼‰æ•°æ®ä¼ è¾“å¯¹è±¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Page&#123;</span><br><span class="line">	int index;</span><br><span class="line">	int size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Demo"><a class="header-anchor" href="#Demo">Â¶</a>Demo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Employee <span class="title function_">getEmp</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span>Integer id,String lastName)</span>;</span><br><span class="line">id ==&gt; #&#123;id&#125;</span><br><span class="line">lastName ==&gt; #&#123;param2&#125;</span><br><span class="line"><span class="keyword">public</span> Employee <span class="title function_">getEmp</span><span class="params">(Integer id,<span class="meta">@Param(&quot;e&quot;)</span>Employee emp)</span>;</span><br><span class="line">id ==&gt; #&#123;id&#125;</span><br><span class="line">lastName ==&gt; #&#123;param2.lastName&#125;|#&#123;e.lastName&#125;</span><br></pre></td></tr></table></figure><p>ğŸ¶å¦‚æœæ˜¯<code>Collection(List,Set)</code>ç±»å‹æˆ–è€…æ•°ç»„ï¼Œä¹Ÿä¼šç‰¹æ®Šå¤„ç†ï¼Œä¹Ÿæ˜¯æŠŠä¼ å…¥çš„<code>list</code>æˆ–è€…æ•°ç»„å°è£…åœ¨<code>map</code>ä¸­</p><table><thead><tr><th style="text-align:center">ç±»å‹</th><th style="text-align:center">key</th></tr></thead><tbody><tr><td style="text-align:center">Collection</td><td style="text-align:center">collection</td></tr><tr><td style="text-align:center">List</td><td style="text-align:center">list</td></tr><tr><td style="text-align:center">æ•°ç»„</td><td style="text-align:center">array</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Employee <span class="title function_">getEmpById</span><span class="params">(List&lt;Integer&gt; ids)</span>;</span><br><span class="line"><span class="comment">//å–å‡ºç¬¬ä¸€ä¸ª id çš„å€¼ï¼š#&#123;list[0]&#125;</span></span><br></pre></td></tr></table></figure><p>ğŸ¶å‚æ•°å¤šæ—¶ä¼šå°è£… mapï¼Œä¸ºäº†ä¸æ··ä¹±ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>@Param</code>æ¥æŒ‡å®šå°è£…æ—¶ä½¿ç”¨çš„<code>key</code></p><p>å¯¹äºå¤§å¤šæ•°ç®€å•çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸éœ€è¦ä½¿ç”¨å¤æ‚çš„å‚æ•°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUsers&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">  select id, username, password</span><br><span class="line">  from users</span><br><span class="line">  where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®å‚æ•°ç±»å‹ï¼ˆ<code>parameterType</code>ï¼‰ä¼šè¢«è‡ªåŠ¨è®¾ç½®ä¸º<code>int</code>ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥<strong>éšæ„å‘½å</strong></p><p>åŸå§‹ç±»å‹æˆ–ç®€å•æ•°æ®ç±»å‹ï¼ˆæ¯”å¦‚<code>Integer</code>å’Œ<code>String</code>ï¼‰å› ä¸ºæ²¡æœ‰å…¶ä»–å±æ€§ï¼Œä¼šç”¨å®ƒä»¬çš„å€¼æ¥ä½œä¸ºå‚æ•°ï¼Œç„¶è€Œï¼Œå¦‚æœä¼ å…¥ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œè¡Œä¸ºå°±ä¼šä¸ä¸€æ ·äº†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">  insert into users (id, username, password)</span><br><span class="line">  values (#&#123;id&#125;, #&#123;username&#125;, #&#123;password&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœ User ç±»å‹çš„å‚æ•°å¯¹è±¡ä¼ é€’åˆ°äº†è¯­å¥ä¸­ï¼Œä¼šæŸ¥æ‰¾ idã€username å’Œ password å±æ€§ï¼Œç„¶åå°†å®ƒä»¬çš„å€¼ä¼ å…¥é¢„å¤„ç†è¯­å¥çš„å‚æ•°ä¸­</p><p>å‚æ•°ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®ç±»å‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;property,javaType=int,jdbcType=NUMERIC&#125;</span><br></pre></td></tr></table></figure><p>å‡ ä¹æ€»æ˜¯å¯ä»¥æ ¹æ®å‚æ•°å¯¹è±¡çš„ç±»å‹ç¡®å®š javaTypeï¼Œé™¤éè¯¥å¯¹è±¡æ˜¯ä¸€ä¸ª <code>HashMap</code>ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½ éœ€è¦æ˜¾å¼æŒ‡å®š <code>javaType</code> æ¥ç¡®ä¿æ­£ç¡®çš„ç±»å‹å¤„ç†å™¨ï¼ˆ<code>TypeHandler</code>ï¼‰è¢«ä½¿ç”¨ã€‚</p><p>ğŸ¶JDBC è¦æ±‚ï¼Œå¦‚æœä¸€ä¸ªåˆ—å…è®¸ä½¿ç”¨ null å€¼ï¼Œå¹¶ä¸”ä¼šä½¿ç”¨å€¼ä¸º null çš„å‚æ•°ï¼Œå°±å¿…é¡»è¦æŒ‡å®š JDBC ç±»å‹ï¼ˆjdbcTypeï¼‰</p><p>è¦æ›´è¿›ä¸€æ­¥åœ°è‡ªå®šä¹‰ç±»å‹å¤„ç†æ–¹å¼ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹å¤„ç†å™¨ç±»ï¼ˆæˆ–åˆ«åï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;age,javaType=int,jdbcType=NUMERIC,typeHandler=MyTypeHandler&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºæ•°å€¼ç±»å‹ï¼Œè¿˜å¯ä»¥è®¾ç½® <code>numericScale</code> æŒ‡å®šå°æ•°ç‚¹åä¿ç•™çš„ä½æ•°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;height,javaType=double,jdbcType=NUMERIC,numericScale=2&#125;</span><br></pre></td></tr></table></figure><p>ğŸ‘´å‚æ•°çš„é…ç½®å¥½åƒè¶Šæ¥è¶Šç¹çäº†ï¼Œä½†å®é™…ä¸Šï¼Œå¾ˆå°‘éœ€è¦å¦‚æ­¤ç¹ççš„é…ç½®</p><p>mode å±æ€§å…è®¸ä½ æŒ‡å®š <code>IN</code>ï¼Œ<code>OUT</code> æˆ– <code>INOUT</code> å‚æ•°ã€‚å¦‚æœå‚æ•°çš„ <code>mode</code> ä¸º <code>OUT</code> æˆ– <code>INOUT</code>ï¼Œå°†ä¼šä¿®æ”¹å‚æ•°å¯¹è±¡çš„å±æ€§å€¼ï¼Œä»¥ä¾¿ä½œä¸ºè¾“å‡ºå‚æ•°è¿”å›ã€‚ å¦‚æœ <code>mode</code> ä¸º <code>OUT</code>ï¼ˆæˆ– <code>INOUT</code>ï¼‰ï¼Œè€Œä¸” <code>jdbcType</code> ä¸º <code>CURSOR</code>ï¼ˆä¹Ÿå°±æ˜¯ Oracle çš„ REFCURSORï¼‰ï¼Œä½ å¿…é¡»æŒ‡å®šä¸€ä¸ª <code>resultMap</code> å¼•ç”¨æ¥å°†ç»“æœé›† <code>ResultMap</code> æ˜ å°„åˆ°å‚æ•°çš„ç±»å‹ä¸Šã€‚è¦æ³¨æ„è¿™é‡Œçš„ <code>javaType</code> å±æ€§æ˜¯å¯é€‰çš„ï¼Œå¦‚æœç•™ç©ºå¹¶ä¸” jdbcType æ˜¯ <code>CURSOR</code>ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨åœ°è¢«è®¾ä¸º <code>ResultMap</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#123;department, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=departmentResultMap&#125;</span><br></pre></td></tr></table></figure><p>ğŸ¶å¤§å¤šæ—¶å€™ï¼Œä½ åªé¡»ç®€å•æŒ‡å®šå±æ€§åï¼Œé¡¶å¤šè¦ä¸ºå¯èƒ½ä¸ºç©ºçš„åˆ—æŒ‡å®š <code>jdbcType</code>ï¼Œå…¶ä»–çš„äº‹æƒ…äº¤ç»™ MyBatis è‡ªå·±å»æ¨æ–­å°±è¡Œäº†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#&#123;firstName&#125;</span><br><span class="line">#&#123;middleInitial,jdbcType=VARCHAR&#125;</span><br><span class="line">#&#123;lastName&#125;</span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²æ›¿æ¢"><a class="header-anchor" href="#å­—ç¬¦ä¸²æ›¿æ¢">Â¶</a>å­—ç¬¦ä¸²æ›¿æ¢</h2><table><thead><tr><th style="text-align:center">è¡¨è¾¾å¼</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">#{}</td><td style="text-align:center">å¯ä»¥è·å– map ä¸­çš„å€¼æˆ–è€… pojo å¯¹è±¡å±æ€§çš„å€¼ï¼›<br>æ˜¯ä»¥é¢„ç¼–è¯‘çš„å½¢å¼ï¼Œå°†å‚æ•°è®¾ç½®åˆ°<code>sql</code>è¯­å¥ä¸­ï¼›<br>ä½¿ç”¨<code>PreparedStatement</code>ï¼›é˜²æ­¢ sql æ³¨å…¥</td></tr><tr><td style="text-align:center">${}</td><td style="text-align:center">å¯ä»¥è·å– map ä¸­çš„å€¼æˆ–è€… pojo å¯¹è±¡å±æ€§çš„å€¼ï¼›<br>å–å‡ºçš„å€¼ç›´æ¥æ‹¼æ¥åœ¨<code>sql</code>è¯­å¥ä¸­;<br>å­˜åœ¨å®‰å…¨é—®é¢˜</td></tr></tbody></table><p>åŸç”Ÿ jdbc ä¸æ”¯æŒå ä½ç¬¦çš„åœ°æ–¹æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>$&#123;&#125;</code>è¿›è¡Œå–å€¼ï¼Œå¦‚ï¼šåˆ†è¡¨ã€æ’åº</p><p>å½“ SQL è¯­å¥ä¸­çš„å…ƒæ•°æ®ï¼ˆå¦‚è¡¨åæˆ–åˆ—åï¼‰æ˜¯åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²æ›¿æ¢å°†ä¼šéå¸¸æœ‰ç”¨ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ æƒ³ <code>select</code> ä¸€ä¸ªè¡¨ä»»æ„ä¸€åˆ—çš„æ•°æ®æ—¶ï¼Œä¸éœ€è¦è¿™æ ·å†™ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">User <span class="title function_">findById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">long</span> id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Select(&quot;select * from user where name = #&#123;name&#125;&quot;)</span></span><br><span class="line">User <span class="title function_">findByName</span><span class="params">(<span class="meta">@Param(&quot;name&quot;)</span> String name)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Select(&quot;select * from user where email = #&#123;email&#125;&quot;)</span></span><br><span class="line">User <span class="title function_">findByEmail</span><span class="params">(<span class="meta">@Param(&quot;email&quot;)</span> String email)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶å®ƒçš„ &quot;findByXxx&quot; æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p>è€Œæ˜¯å¯ä»¥åªå†™è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;select * from user where $&#123;column&#125; = #&#123;value&#125;&quot;)</span></span><br><span class="line">User <span class="title function_">findByColumn</span><span class="params">(<span class="meta">@Param(&quot;column&quot;)</span> String column, <span class="meta">@Param(&quot;value&quot;)</span> String value)</span>;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>$&#123;column&#125;</code> ä¼šè¢«ç›´æ¥æ›¿æ¢ï¼Œè€Œ <code>#&#123;value&#125;</code> ä¼šä½¿ç”¨ <code>?</code> é¢„å¤„ç†ã€‚ è¿™æ ·ï¼Œå°±èƒ½å®ŒæˆåŒæ ·çš„ä»»åŠ¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">User</span> <span class="variable">userOfId1</span> <span class="operator">=</span> userMapper.findByColumn(<span class="string">&quot;id&quot;</span>, <span class="number">1L</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">userOfNameKid</span> <span class="operator">=</span> userMapper.findByColumn(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;kid&quot;</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">userOfEmail</span> <span class="operator">=</span> userMapper.findByColumn(<span class="string">&quot;email&quot;</span>, <span class="string">&quot;noone@nowhere.com&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼ä¹ŸåŒæ ·é€‚ç”¨äºæ›¿æ¢è¡¨åçš„æƒ…å†µ</p><p>ğŸ¶ç”¨è¿™ç§æ–¹å¼æ¥å—ç”¨æˆ·çš„è¾“å…¥ï¼Œå¹¶ç”¨ä½œè¯­å¥å‚æ•°æ˜¯ä¸å®‰å…¨çš„ï¼Œä¼šå¯¼è‡´æ½œåœ¨çš„ SQL æ³¨å…¥æ”»å‡»ï¼Œå› æ­¤ï¼Œè¦ä¹ˆä¸å…è®¸ç”¨æˆ·è¾“å…¥è¿™äº›å­—æ®µï¼Œè¦ä¹ˆè‡ªè¡Œè½¬ä¹‰å¹¶æ£€éªŒè¿™äº›å‚æ•°</p><p>ğŸ‘´å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å–å‚æ•°çš„å€¼éƒ½åº”è¯¥æ˜¯ä½¿ç”¨<code>#&#123;&#125;</code></p><h2 id="ç»“æœæ˜ å°„"><a class="header-anchor" href="#ç»“æœæ˜ å°„">Â¶</a>ç»“æœæ˜ å°„</h2><p>ResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼šå¯¹ç®€å•çš„è¯­å¥åšåˆ°é›¶é…ç½®ï¼Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼Œåªéœ€è¦æè¿°è¯­å¥ä¹‹å‰çš„å…³ç³»å°±å¯ä»¥äº†</p><p>å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªé›†åˆï¼Œè¦å†™é›†åˆä¸­å…ƒç´ çš„ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapKey(&quot;lastName&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Employee&gt; <span class="title function_">getEmpByLastNameLikeReturnMap</span><span class="params">(String lastName)</span>;</span><br></pre></td></tr></table></figure><p><code>@Mapkey</code>å‘Šè¯‰ mybatis å°è£…è¿™ä¸ª map çš„æ—¶å€™ä½¿ç”¨é‚£ä¸ªå±æ€§ä½œä¸º map çš„ key</p><p>è¿”å›ä¸€æ¡è®°å½•çš„ mapï¼Œkey æ˜¯åˆ—åï¼Œå€¼æ˜¯å¯¹åº”çš„å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">getEmpByIdReturnMap</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure><h3 id="resultMap"><a class="header-anchor" href="#resultMap">Â¶</a><code>&lt;resultMap&gt;</code></h3><p>è‡ªå®šä¹‰ç»“æœé›†æ˜ å°„è§„åˆ™ï¼Œå®ç°é«˜çº§ç»“æœé›†æ˜ å°„</p><table><thead><tr><th style="text-align:center">æ ‡ç­¾</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;id&gt;</code></td><td style="text-align:center">å®šä¹‰ä¸»é”®åˆ—å°è£…è§„åˆ™ï¼Œåº•å±‚æœ‰ä¼˜åŒ–</td></tr><tr><td style="text-align:center"><code>&lt;result&gt;</code></td><td style="text-align:center">å®šä¹‰æ™®é€šåˆ—å°è£…è§„åˆ™</td></tr></tbody></table><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Employee&quot;</span> <span class="attr">id</span>=<span class="string">&quot;MySimpleEmp&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--columnï¼šæŒ‡å®šå“ªä¸€åˆ— propertyï¼šæŒ‡å®šå¯¹åº”çš„javaBeanå±æ€§--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--å®šä¹‰ä¸»é”®åˆ—å°è£…è§„åˆ™--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å®šä¹‰æ™®é€šåˆ—å°è£…è§„åˆ™ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;last_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;lastName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gender&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ğŸ‘´å…¶ä»–ä¸æŒ‡å®šçš„åˆ—ä¼šè‡ªåŠ¨å°è£…ï¼›åªè¦å†™ resultMap å°±æŠŠå…¨éƒ¨çš„æ˜ å°„è§„åˆ™éƒ½å†™ä¸Š</p><p>å„ä¸ªå±æ€§å«ä¹‰ä¿¡æ¯</p><table><thead><tr><th style="text-align:center">å±æ€§</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">property</td><td style="text-align:center">æ˜ å°„åˆ° Java Bean çš„å±æ€§</td></tr><tr><td style="text-align:center">column</td><td style="text-align:center">æ•°æ®è¡¨çš„åˆ—å‘½</td></tr><tr><td style="text-align:center">javaType</td><td style="text-align:center">ä¸€ä¸ª Java ç±»çš„å®Œå…¨é™å®šåï¼Œæˆ–ä¸€ä¸ªç±»å‹åˆ«åã€‚å¦‚æœæ˜ å°„åˆ°ä¸€ä¸ª Java Beanï¼ŒMyBatis é€šå¸¸å¯ä»¥æ–­å®šç±»å‹</td></tr><tr><td style="text-align:center">jdbcType</td><td style="text-align:center">JDBC ç±»å‹æ˜¯ä»…ä»…éœ€è¦å¯¹æ’å…¥ï¼Œæ›´æ–°å’Œåˆ é™¤æ“ä½œå¯èƒ½ä¸ºç©ºçš„åˆ—è¿›è¡Œå¤„ç†</td></tr><tr><td style="text-align:center">typeHandler</td><td style="text-align:center">ç±»å‹å¤„ç†å™¨ï¼Œä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥è¦†ç›–é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ï¼Œè¿™ä¸ªå±æ€§å€¼æ˜¯ç±»çš„å®Œå…¨é™å®šåæˆ–è€…æ˜¯ä¸€ä¸ªç±»å‹å¤„ç†å™¨çš„å®ç°ï¼Œæˆ–è€…æ˜¯ç±»å‹åˆ«å</td></tr></tbody></table><h3 id="åœºæ™¯ä¸€ï¼šè”åˆæŸ¥è¯¢"><a class="header-anchor" href="#åœºæ™¯ä¸€ï¼šè”åˆæŸ¥è¯¢">Â¶</a>åœºæ™¯ä¸€ï¼šè”åˆæŸ¥è¯¢</h3><p>æŸ¥è¯¢ Employee çš„åŒæ—¶æŸ¥è¯¢å‘˜å·¥å¯¹åº”çš„éƒ¨é—¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Employee&quot;</span> <span class="attr">id</span>=<span class="string">&quot;MyDifEmp&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;last_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;lastName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gender&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--çº§è”èµ‹å€¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dept.id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dept.departmentName&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>&lt;association&gt;</code>å®šä¹‰å…³è”çš„å•ä¸ªå¯¹è±¡çš„å°è£…è§„åˆ™,association æŒ‡å®šè”åˆçš„ javaBean å¯¹è±¡</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--propertyæŒ‡å®šé‚£ä¸ªå±æ€§æ˜¯è”åˆå¯¹è±¡ï¼ŒjavaType:æŒ‡å®šè¿™ä¸ªå±æ€§å¯¹è±¡çš„ç±»å‹--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Department&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;departmentName&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯ä¸€ï¼šåˆ†æ­¥æŸ¥è¯¢"><a class="header-anchor" href="#åœºæ™¯ä¸€ï¼šåˆ†æ­¥æŸ¥è¯¢">Â¶</a>åœºæ™¯ä¸€ï¼šåˆ†æ­¥æŸ¥è¯¢</h3><p>ä½¿ç”¨ association è¿›è¡Œåˆ†å¸ƒæŸ¥è¯¢</p><ol><li>å…ˆæŒ‰ç…§å‘˜å·¥ id æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯</li><li>æ ¹æ®æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ä¸­çš„ d_id å€¼å»éƒ¨é—¨è¡¨æŸ¥å‡ºéƒ¨é—¨ä¿¡æ¯</li><li>éƒ¨é—¨ä¿¡æ¯è®¾ç½®åˆ°å‘˜å·¥ä¸­</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gender&quot;</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- associationå®šä¹‰å…³è”å¯¹è±¡çš„å°è£…è§„åˆ™</span></span><br><span class="line"><span class="comment">      select:è¡¨æ˜å½“å‰å±æ€§æ˜¯è°ƒç”¨selectæŒ‡å®šçš„æ–¹æ³•æŸ¥å‡ºçš„ç»“æœ</span></span><br><span class="line"><span class="comment">      column:æŒ‡å®šå°†å“ªä¸€åˆ—çš„å€¼ä¼ ç»™è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      æµç¨‹ï¼šä½¿ç”¨selectæŒ‡å®šçš„æ–¹æ³•ï¼ˆä¼ å…¥columnæŒ‡å®šçš„è¿™åˆ—å‚æ•°çš„å€¼ï¼‰æŸ¥å‡ºå¯¹è±¡ï¼Œå¹¶å°è£…ç»™propertyæŒ‡å®šçš„å±æ€§</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">select</span>=<span class="string">&quot;com.atguigu.mybatis.dao.DepartmentMapper.getDeptById&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">column</span>=<span class="string">&quot;d_id&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  public Employee getEmpByIdStep(Integer id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByIdStep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;MyEmpByStep&quot;</span>&gt;</span></span><br><span class="line">   select * from tbl_employee where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ†æ®µæŸ¥è¯¢çš„åŸºç¡€ä¹‹ä¸ŠåŠ ä¸Šä¸¤ä¸ªé…ç½®ï¼Œå¯ä»¥å®ç°å»¶è¿ŸåŠ è½½ï¼ˆæ‡’åŠ è½½ã€æŒ‰éœ€åŠ è½½ï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;jdbcTypeForNull&quot;</span> <span class="attr">value</span>=<span class="string">&quot;NULL&quot;</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--æ˜¾ç¤ºçš„æŒ‡å®šæ¯ä¸ªæˆ‘ä»¬éœ€è¦æ›´æ”¹çš„é…ç½®çš„å€¼ï¼Œå³ä½¿ä»–æ˜¯é»˜è®¤çš„ã€‚é˜²æ­¢ç‰ˆæœ¬æ›´æ–°å¸¦æ¥çš„é—®é¢˜  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;aggressiveLazyLoading&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯äºŒï¼šè”åˆæŸ¥è¯¢"><a class="header-anchor" href="#åœºæ™¯äºŒï¼šè”åˆæŸ¥è¯¢">Â¶</a>åœºæ™¯äºŒï¼šè”åˆæŸ¥è¯¢</h3><p>æŸ¥è¯¢éƒ¨é—¨çš„æ—¶å€™å°†éƒ¨é—¨å¯¹åº”çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ä¹ŸæŸ¥è¯¢å‡ºæ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Department</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> Integer id;</span><br><span class="line">   <span class="keyword">private</span> String departmentName;</span><br><span class="line">   <span class="keyword">private</span> List&lt;Employee&gt; emps;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Alias(&quot;emp&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> Integer id;</span><br><span class="line">   <span class="keyword">private</span> String lastName;</span><br><span class="line">   <span class="keyword">private</span> String email;</span><br><span class="line">   <span class="keyword">private</span> String gender;</span><br><span class="line">   <span class="keyword">private</span> Department dept;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åµŒå¥—ç»“æœé›†çš„æ–¹å¼ï¼Œä½¿ç”¨collectionæ ‡ç­¾å®šä¹‰å…³è”çš„é›†åˆç±»å‹çš„å±æ€§å°è£…è§„åˆ™  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Department&quot;</span> <span class="attr">id</span>=<span class="string">&quot;MyDept&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;departmentName&quot;</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      collectionå®šä¹‰å…³è”é›†åˆç±»å‹çš„å±æ€§çš„å°è£…è§„åˆ™</span></span><br><span class="line"><span class="comment">      ofType:æŒ‡å®šé›†åˆé‡Œé¢å…ƒç´ çš„ç±»å‹</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Employee&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- å®šä¹‰è¿™ä¸ªé›†åˆä¸­å…ƒç´ çš„å°è£…è§„åˆ™ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;last_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;lastName&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gender&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- public Department getDeptByIdPlus(Integer id); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptByIdPlus&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;MyDept&quot;</span>&gt;</span></span><br><span class="line">   SELECT d.id did,d.dept_name dept_name,</span><br><span class="line">         e.id eid,e.last_name last_name,e.email email,e.gender gender</span><br><span class="line">   FROM tbl_dept d</span><br><span class="line">   LEFT JOIN tbl_employee e</span><br><span class="line">   ON d.id=e.d_id</span><br><span class="line">   WHERE d.id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯äºŒï¼šåˆ†æ­¥æŸ¥è¯¢"><a class="header-anchor" href="#åœºæ™¯äºŒï¼šåˆ†æ­¥æŸ¥è¯¢">Â¶</a>åœºæ™¯äºŒï¼šåˆ†æ­¥æŸ¥è¯¢</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Department&quot;</span> <span class="attr">id</span>=<span class="string">&quot;MyDeptStep&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;dept_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;departmentName&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">select</span>=<span class="string">&quot;com.atguigu.mybatis.dao.EmployeeMapperPlus.getEmpsByDeptId&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">column</span>=<span class="string">&quot;&#123;deptId=id&#125;&quot;</span> <span class="attr">fetchType</span>=<span class="string">&quot;lazy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- public Department getDeptByIdStep(Integer id); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptByIdStep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;MyDeptStep&quot;</span>&gt;</span></span><br><span class="line">   select id,dept_name from tbl_dept where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ğŸ“–å¤šåˆ—çš„å€¼ä¼ é€’è¿‡å»ï¼šå°†å¤šåˆ—çš„å€¼å°è£… map ä¼ é€’ï¼›column=â€œ{key1=column1,key2=column2}â€<br>fetchType=â€œlazyâ€ï¼šè¡¨ç¤ºä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼›- lazyï¼šå»¶è¿Ÿ- eagerï¼šç«‹å³</p><h3 id="discriminatorï¼ˆé‰´åˆ«å™¨ï¼‰"><a class="header-anchor" href="#discriminatorï¼ˆé‰´åˆ«å™¨ï¼‰">Â¶</a>discriminatorï¼ˆé‰´åˆ«å™¨ï¼‰</h3><p>mybatis å¯ä»¥ä½¿ç”¨ discriminator åˆ¤æ–­æŸåˆ—çš„å€¼ï¼Œç„¶åæ ¹æ®æŸåˆ—çš„å€¼æ”¹å˜å°è£…è¡Œä¸º</p><div class="alert warning no-icon"><p>å°è£… Employeeï¼š</p><ul><li>å¦‚æœæŸ¥å‡ºçš„æ˜¯å¥³ç”Ÿï¼šå°±æŠŠéƒ¨é—¨ä¿¡æ¯æŸ¥è¯¢å‡ºæ¥ï¼Œå¦åˆ™ä¸æŸ¥è¯¢ï¼›</li><li>å¦‚æœæ˜¯ç”·ç”Ÿï¼ŒæŠŠ last_name è¿™ä¸€åˆ—çš„å€¼èµ‹å€¼ç»™ email;</li></ul></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Employee&quot;</span> <span class="attr">id</span>=<span class="string">&quot;MyEmpDis&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;last_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;lastName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;email&quot;</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gender&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      columnï¼šæŒ‡å®šåˆ¤å®šçš„åˆ—å</span></span><br><span class="line"><span class="comment">      javaTypeï¼šåˆ—å€¼å¯¹åº”çš„javaç±»å‹  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">discriminator</span> <span class="attr">javaType</span>=<span class="string">&quot;string&quot;</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¥³ç”Ÿ  resultType:æŒ‡å®šå°è£…çš„ç»“æœç±»å‹ï¼›ä¸èƒ½ç¼ºå°‘ã€‚/resultMap--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Employee&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">select</span>=<span class="string">&quot;com.atguigu.mybatis.dao.DepartmentMapper.getDeptById&quot;</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">column</span>=<span class="string">&quot;d_id&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç”·ç”Ÿ ;å¦‚æœæ˜¯ç”·ç”Ÿï¼ŒæŠŠlast_nameè¿™ä¸€åˆ—çš„å€¼èµ‹å€¼ç»™email; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">case</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.Employee&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;last_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;lastName&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;last_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;email&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">property</span>=<span class="string">&quot;gender&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">case</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">discriminator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure></div></div><div id="post-footer" class="post-footer main-content-wrap"><div class="post-footer-tags"><span class="text-color-light text-small">æ ‡ç­¾</span><br><a class="tag tag--primary tag--small t-none-link" href="/tags/MyBatis/" rel="tag">MyBatis</a></div><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mybatis-%E5%8A%A8%E6%80%81sql/" data-tooltip="MyBatis åŠ¨æ€Sql" aria-label="ä¸Šä¸€ç¯‡: MyBatis åŠ¨æ€Sql"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">ä¸Šä¸€ç¯‡</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mybatis-%E5%A4%9A%E8%A1%A8%E8%81%94%E5%90%88%E5%A4%84%E7%90%86/" data-tooltip="MyBatis å¤šè¡¨è”åˆå¤„ç†" aria-label="ä¸‹ä¸€ç¯‡: MyBatis å¤šè¡¨è”åˆå¤„ç†"><span class="hide-xs hide-sm text-small icon-mr">ä¸‹ä¸€ç¯‡</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="ç›®å½•"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></article><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><footer id="footer" class="main-content-wrap"><span class="copyrights">Copyrights &copy; 2023 pineapple-man. All Rights Reserved.</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><br>Total <span id="busuanzi_value_site_pv"></span> views. æ‚¨æ˜¯pineapple-mançš„ç¬¬<span id="busuanzi_value_site_uv"></span>ä¸ªå°ä¼™ä¼´<br><i class="fas fa-book-open"></i> <span class="post-count">åšå®¢å­—æ•°ç»Ÿè®¡ï¼š370.7k</span><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></footer></div><div id="bottom-bar" class="post-bottom-bar" data-behavior="5"><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mybatis-%E5%8A%A8%E6%80%81sql/" data-tooltip="MyBatis åŠ¨æ€Sql" aria-label="ä¸Šä¸€ç¯‡: MyBatis åŠ¨æ€Sql"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">ä¸Šä¸€ç¯‡</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mybatis-%E5%A4%9A%E8%A1%A8%E8%81%94%E5%90%88%E5%A4%84%E7%90%86/" data-tooltip="MyBatis å¤šè¡¨è”åˆå¤„ç†" aria-label="ä¸‹ä¸€ç¯‡: MyBatis å¤šè¡¨è”åˆå¤„ç†"><span class="hide-xs hide-sm text-small icon-mr">ä¸‹ä¸€ç¯‡</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="ç›®å½•"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></div><div id="about"><div id="about-card"><div id="about-btn-close"><i class="fa fa-times"></i></div><img id="about-card-picture" src="/assets/images/logo.png" alt="ä½œè€…çš„å›¾ç‰‡"><h4 id="about-card-name">pineapple-man</h4><div id="about-card-bio"><p>åšä¸€ä¸ªè èï¼šç«™å¾—ç¬”ç›´ï¼Œå¤´æˆ´ç‹å† ï¼Œå†…å¿ƒç”œç¾</p></div><div id="about-card-job"><i class="fa fa-briefcase"></i><br><p>åˆšæ¯•ä¸šå°±å¤±ä¸š</p></div><div id="about-card-location"><i class="fa fa-map-marker-alt"></i><br>è¥¿å®‰</div></div></div><div id="cover" style="background-image:url(/assets/images/cover-v1.2.0.jpg)"></div><script src="/assets/js/script-kcoiyt1nxfue7qgcpkrcixymglcc3cuxeg98fy01hqww4nblnhd2ees6j6yc.min.js"></script></body></html>