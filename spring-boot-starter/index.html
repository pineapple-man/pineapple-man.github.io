<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="pineapple-man"><title>spring boot Starter - pineapple-man</title><meta name="author" content="pineapple-man"><meta name="keywords" content="spring boot starter"><link rel="icon" href="https://pineapple-man.github.io/assets/images/logo.svg"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png"},"articleBody":"\nSpring Boot å¤§å¤§ç®€åŒ–äº†é¡¹ç›®åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹ï¼Œè€Œè¿™äº›éƒ½æ˜¯é€šè¿‡ Spring Boot æä¾›çš„ starter æ¥å®Œæˆçš„ï¼Œä¸€ä¸ªé¡¹ç›®ä¸­çš„åŸºç¡€æ¨¡å—æœ¬è´¨å°±æ˜¯ä¸€ä¸ª Starterï¼Œæœ¬æ–‡ä¸»è¦å¯¹ Spring boot çš„ starter è¿›è¡Œæ¯”è¾ƒå…¨é¢æ·±å…¥çš„è®°å½•ã€‚\nÂ¶æ¦‚è¿°\nspring boot åœ¨é…ç½®ä¸Šç›¸æ¯” spring è¦ç®€å•è®¸å¤š, å…¶æ ¸å¿ƒåœ¨äº spring-boot-starter, åœ¨ä½¿ç”¨ spring boot æ¥æ­å»ºä¸€ä¸ªé¡¹ç›®æ—¶, åªéœ€è¦å¼•å…¥å®˜æ–¹æä¾›çš„ starter, å°±å¯ä»¥ç›´æ¥ä½¿ç”¨, å…å»äº†å„ç§é…ç½®ã€‚starter ç®€å•æ¥è®²å°±æ˜¯å¼•å…¥äº†ä¸€äº›ç›¸å…³ä¾èµ–å’Œä¸€äº›åˆå§‹åŒ–çš„é…ç½®ã€‚\nSpring å®˜æ–¹æä¾›äº†å¾ˆå¤š starterï¼Œç¬¬ä¸‰æ–¹ä¹Ÿå¯ä»¥å®šä¹‰ starterã€‚ä¸ºäº†åŠ ä»¥åŒºåˆ†ï¼Œstarter ä»åç§°ä¸Šè¿›è¡Œäº†å¦‚ä¸‹è§„èŒƒï¼š\n\nSpring å®˜æ–¹æä¾›çš„ starter åç§°ä¸ºï¼šspring-boot-starter-xxxï¼Œä¾‹å¦‚ Spring å®˜æ–¹æä¾›çš„ spring-boot-starter-web\nç¬¬ä¸‰æ–¹æä¾›çš„ starter åç§°ä¸ºï¼šxxx-spring-boot-starterï¼Œä¾‹å¦‚ç”± mybatis æä¾›çš„ mybatis-spring-boot-starter\n\n\nSpring Boot ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¸®æˆ‘ä»¬ç®€åŒ–é¡¹ç›®çš„æ­å»ºå’Œå¼€å‘è¿‡ç¨‹ï¼Œä¸»è¦æ˜¯åŸºäºå®ƒæä¾›çš„èµ·æ­¥ä¾èµ–å’Œè‡ªåŠ¨é…ç½®\nÂ¶èµ·æ­¥ä¾èµ–\nèµ·æ­¥ä¾èµ–å…¶å®å°±æ˜¯å°†å…·å¤‡æŸç§åŠŸèƒ½çš„åæ ‡æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œå¯ä»¥ç®€åŒ–ä¾èµ–å¯¼å…¥çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯¼å…¥ spring-boot-starter-web è¿™ä¸ª starterï¼Œåˆ™å’Œ web å¼€å‘ç›¸å…³çš„ jar åŒ…éƒ½ä¸€èµ·å¯¼å…¥åˆ°é¡¹ç›®ä¸­äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n\nÂ¶è‡ªåŠ¨é…ç½®\nè‡ªåŠ¨é…ç½®ï¼Œå°±æ˜¯æ— é¡»æ‰‹åŠ¨é…ç½® xmlï¼Œè‡ªåŠ¨é…ç½®å¹¶ç®¡ç† beanï¼Œé‚£ä¹ˆ Spring Boot æ˜¯å¦‚ä½•å®Œæˆè‡ªåŠ¨é…ç½®çš„å°¼ï¼Ÿ\nâ›µ è‡ªåŠ¨é…ç½®æ¶‰åŠåˆ°å¦‚ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š\n\nåŸºäº Java ä»£ç çš„ bean é…ç½®\næ¿€åŠ¨é…ç½®æ¡ä»¶ä¾èµ–\nBean å‚æ•°è·å–\nBean çš„å‘ç°\nBean çš„åŠ è½½\n\n\næ¥ä¸‹æ¥ä»¥Mybatis-spring-boot-starteræ¥è¯´æ˜è‡ªåŠ¨é…ç½®çš„å®ç°è¿‡ç¨‹\nÂ¶åŸºäº Java ä»£ç çš„ Bean é…ç½®\nå½“æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¯¼å…¥äº†mybatis-spring-boot-starterè¿™ä¸ª jar åï¼Œå¯ä»¥çœ‹åˆ°å®ƒåŒ…æ‹¬äº†å¾ˆå¤šç›¸å…³çš„ jar åŒ…\n12345&lt;dependency&gt;  &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;  &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;  &lt;version&gt;1.3.2&lt;/version&gt;&lt;/dependency&gt;\n\nå…¶ä¸­åœ¨ mybatis-spring-boot-autoconfigure è¿™ä¸ª jar åŒ…ä¸­æœ‰å¦‚ä¸‹ä¸€ä¸ªMybatisAutoConfigurationè‡ªåŠ¨é…ç½®ç±»\n\næ‰“å¼€è¿™ä¸ªç±»ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\n12345678910111213@Configuration@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)@ConditionalOnBean(&#123;DataSource.class&#125;)@EnableConfigurationProperties(&#123;MybatisProperties.class&#125;)@AutoConfigureAfter(&#123;DataSourceAutoConfiguration.class&#125;)public class MybatisAutoConfiguration &#123;  @Bean  @ConditionalOnMissingBean  public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception&#123;...&#125;  @Bean  @ConditionalOnMissingBean  public SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory)&#123;...&#125;&#125;\n@Configurationå’Œ @Bean è¿™ä¸¤ä¸ªæ³¨è§£ä¸€èµ·ä½¿ç”¨å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸºäº java ä»£ç çš„é…ç½®ç±»ï¼Œå¯ä»¥ç”¨æ¥æ›¿ä»£ä¼ ç»Ÿçš„ xml é…ç½®æ–‡ä»¶ï¼Œä¸¤ä¸ªæ³¨è§£å…·ä½“çš„å«ä¹‰å¦‚ä¸‹ï¼š\n\n\n\næ³¨è§£\nå«ä¹‰\n\n\n\n\n@Configuration\nåœ¨ç±»ä¸Šæ ‡æ³¨ï¼Œè¡¨æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»\n\n\n@Bean\nè¡¨æ˜éœ€è¦å‘ Spring IoC å®¹å™¨ä¸­æ³¨å…¥çš„ Bean\n\n\n\næ‰€ä»¥ä¸Šé¢çš„MybatisAutoConfigurationè¿™ä¸ªç±»ï¼Œè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆäº† SqlSessionFactory å’Œ SqlSessionTemplate è¿™äº› Mybatis çš„é‡è¦å®ä¾‹å¹¶äº¤ç»™ spring å®¹å™¨ç®¡ç†ï¼Œä»è€Œå®Œæˆ bean çš„è‡ªåŠ¨æ³¨å†Œ\nÂ¶è‡ªåŠ¨é…ç½®æ¡ä»¶ä¾èµ–\nä»MybatisAutoConfigurationè¿™ä¸ªç±»ä¸­ä½¿ç”¨çš„æ³¨è§£å¯ä»¥çœ‹å‡ºï¼Œè¦å®Œæˆè‡ªåŠ¨é…ç½®æ˜¯æœ‰ä¾èµ–æ¡ä»¶çš„\n12@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)@ConditionalOnBean(&#123;DataSource.class&#125;)\næ‰€ä»¥è¦å®Œæˆ Mybatis çš„è‡ªåŠ¨é…ç½®ï¼Œéœ€è¦åœ¨ç±»è·¯å¾„ä¸­å­˜åœ¨SqlSessionFactoryã€SqlSessionFactoryBeanè¿™ä¸¤ä¸ªç±»ï¼ŒåŒæ—¶éœ€è¦å­˜åœ¨ DataSource è¿™ä¸ª bean ä¸”è¿™ä¸ª bean å®Œæˆè‡ªåŠ¨æ³¨å†Œ\nSpring boot ä¸­å¸¸è§çš„æ¡ä»¶ä¾èµ–æ³¨è§£æœ‰ï¼š\n\n\n\næ³¨è§£\nåŠŸèƒ½è¯´æ˜\n\n\n\n\n@ConditionalOnBean\nä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­å­˜åœ¨æŸä¸ª bean æ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean\n\n\n@ConditionalOnClass\næŸä¸ª class ä½äºç±»è·¯å¾„ä¸Šï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean\n\n\n@ConditionalOnExpression\nå½“è¡¨è¾¾å¼ä¸º true çš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean\n\n\n@ConditionalOnMissingBean\nä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­ä¸å­˜åœ¨æŸä¸ª bean æ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Beanï¼Œé˜²æ­¢é‡å¤åˆ›å»º\n\n\n@ConditionalOnMissingClass\næŸä¸ª class åœ¨ç±»è·¯å¾„ä¸Šä¸å­˜åœ¨çš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean\n\n\n@ConditionalOnNotWebApplication\nä¸æ˜¯ web åº”ç”¨æ—¶æ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean\n\n\n@AutoConfigureAfter\nåœ¨æŸä¸ª bean å®Œæˆè‡ªåŠ¨é…ç½®åå®ä¾‹åŒ–è¿™ä¸ª bean\n\n\n@AutoConfigureBefore\nåœ¨æŸä¸ª bean å®Œæˆè‡ªåŠ¨é…ç½®å‰å®ä¾‹åŒ–è¿™ä¸ª bean\n\n\n\nÂ¶Bean å‚æ•°è·å–\nè¦å®Œæˆ mybatis çš„è‡ªåŠ¨é…ç½®ï¼Œéœ€è¦æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­æä¾›æ•°æ®æºç›¸å…³çš„é…ç½®å‚æ•°ï¼Œä¾‹å¦‚æ•°æ®åº“é©±åŠ¨ã€è¿æ¥ urlã€æ•°æ®åº“ç”¨æˆ·åã€å¯†ç ç­‰ã€‚é‚£ä¹ˆ spring boot æ˜¯å¦‚ä½•è¯»å– yml æˆ–è€… properites é…ç½®æ–‡ä»¶çš„çš„å±æ€§æ¥åˆ›å»ºæ•°æ®æºå¯¹è±¡çš„ï¼Ÿ\n\nåœ¨æˆ‘ä»¬å¯¼å…¥ mybatis-spring-boot-starter è¿™ä¸ª jar åŒ…åä¼šä¼ é€’è¿‡æ¥ä¸€ä¸ª spring-boot-autoconfigure åŒ…ï¼Œåœ¨è¿™ä¸ªåŒ…ä¸­æœ‰ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»DataSourceAutoConfigurationï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n12345@Configuration@ConditionalOnClass(&#123;DataSource.class, EmbeddedDatabaseType.class&#125;)@EnableConfigurationProperties(&#123;DataSourceProperties.class&#125;)@Import(&#123;Registrar.class, DataSourcePoolMetadataProvidersConfiguration.class&#125;)public class DataSourceAutoConfiguration &#123;&#125;\nä¸Šé¢è¿™ä¸ªç±»åŠ å…¥äº†EnableConfigurationPropertiesæ³¨è§£ï¼ŒDataSourceProperties è¿™ä¸ªç±»å¦‚ä¸‹ï¼š\n1234@ConfigurationProperties(    prefix = &quot;spring.datasource&quot;)public class DataSourceProperties implements BeanClassLoaderAware, EnvironmentAware, InitializingBean &#123;&#125;\nä¸Šé¢è¿™ä¸ªç±»ä¸ŠåŠ å…¥äº†ConfigurationPropertiesæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£çš„ä½œç”¨å°±æ˜¯æŠŠ yml æˆ–è€… properties é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®å‚æ•°ä¿¡æ¯å°è£…åˆ°ConfigurationPropertiesæ³¨è§£æ ‡æ³¨çš„ bean(å³DataSourceProperties)çš„ç›¸åº”å±æ€§ä¸Šã€‚\n@EnableConfigurationPropertiesæ³¨è§£çš„ä½œç”¨æ˜¯ä½¿@ConfigurationPropertiesæ³¨è§£ç”Ÿæ•ˆï¼Œå¹¶ä¸”å°†@ConfigurationPropertiesæ ‡æ³¨çš„ Bean æ³¨å…¥åˆ° @EnablelConfigurationPropertiesç±»ä¸­ã€‚\n\nå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼Œæœ€ç»ˆ DataSourceProperties ç±»å°†æ³¨å…¥åˆ° DataSourceAutoConfigurationä¸­ä½¿ç”¨ï¼Œéšå Spring å°†æ ¹æ®DataSourceAutoConfigurationç±»ä¸­çš„é…ç½®ï¼Œè‡ªåŠ¨æ³¨å…¥æ–°çš„ Bean\n12345@Bean@ConditionalOnMissingBeanpublic DataSourceInitializer dataSourceInitializer(DataSourceProperties properties, ApplicationContext applicationContext) &#123;    return new DataSourceInitializer(properties, applicationContext);&#125;\nÂ¶Bean çš„å‘ç°\nspring boot é»˜è®¤æ‰«æå¯åŠ¨ç±»æ‰€åœ¨çš„åŒ…ä¸‹çš„ä¸»ç±»ä¸å­ç±»çš„æ‰€æœ‰ç»„ä»¶ï¼Œä½†å¹¶æ²¡æœ‰åŒ…æ‹¬ä¾èµ–åŒ…ä¸­çš„ç±»ï¼Œé‚£ä¹ˆä¾èµ–åŒ…ä¸­çš„ bean æ˜¯å¦‚ä½•è¢«å‘ç°å’ŒåŠ è½½çš„ï¼Ÿ\n\nä¸€èˆ¬ Spring boot åº”ç”¨ç¨‹åºçš„å¯åŠ¨ç±»éƒ½æœ‰ @SpringBootApplication æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£çš„æºç å¦‚ä¸‹ï¼š\n12345678910111213141516@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Inherited@SpringBootConfiguration@EnableAutoConfiguration@ComponentScan(    excludeFilters = &#123;@Filter(    type = FilterType.CUSTOM,    classes = &#123;TypeExcludeFilter.class&#125;), @Filter(    type = FilterType.CUSTOM,    classes = &#123;AutoConfigurationExcludeFilter.class&#125;)&#125;)public @interface SpringBootApplication &#123;...&#125;\nå…¶ä¸­æ¯”è¾ƒé‡è¦æ˜¯ä¸‹é¢è¿™ä¸‰ä¸ªæ³¨è§£ï¼š\n\n@SpringBootConfigurationï¼šä½œç”¨å°±ç›¸å½“@Configurationæ³¨è§£ï¼Œè¢«æ³¨è§£çš„ç±»å°†æˆä¸ºä¸€ä¸ª bean é…ç½®ç±»\n@ComponentScanï¼šä½œç”¨å°±æ˜¯è‡ªåŠ¨æ‰«æå¹¶åŠ è½½ç¬¦åˆæ¡ä»¶çš„ç»„ä»¶ï¼Œæœ€ç»ˆå°†è¿™äº› bean åŠ è½½åˆ° spring å®¹å™¨ä¸­\n@EnableAutoConfigurationï¼šè¿™ä¸ªæ³¨è§£å¾ˆé‡è¦ï¼Œå€ŸåŠ©@Importçš„æ”¯æŒï¼Œæ”¶é›†å’Œæ³¨å†Œä¾èµ–åŒ…ä¸­ç›¸å…³çš„ Bean å®šä¹‰\n\n\nç»§ç»­è¿½è¸ª@EnableAutoConfigurationæ³¨è§£æºç ï¼Œè¿™ä¸ªæ³¨è§£å¼•ç”¨äº†@Importæ³¨è§£ï¼Œ@Importæ³¨è§£èƒ½å¤Ÿå¯¼å…¥éœ€è¦è‡ªåŠ¨é…ç½®çš„ç»„ä»¶ï¼Œæ­¤å¤„å°±è‡ªåŠ¨å¯¼å…¥ç±»EnableAutoConfigurationImportSelector\n12345678910111213@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Inherited@AutoConfigurationPackage@Import(&#123;EnableAutoConfigurationImportSelector.class&#125;)public @interface EnableAutoConfiguration &#123;    String ENABLED_OVERRIDE_PROPERTY = &quot;spring.boot.enableautoconfiguration&quot;;    Class&lt;?&gt;[] exclude() default &#123;&#125;;    String[] excludeName() default &#123;&#125;;&#125;\nEnableAutoConfigurationImportSelectorç±»çš„æºç å¦‚ä¸‹ï¼Œç”±äºå¦‚ä»Šè¿™ä¸ªç±»å·²ç»è¢«å¼ƒç”¨ï¼Œæ‰€å“Ÿè¯¦ç»†çš„ç»†èŠ‚æŸ¥çœ‹çˆ¶ç±»AutoConfigurationImportSelector\n12345678public class EnableAutoConfigurationImportSelector extends AutoConfigurationImportSelector &#123;    public EnableAutoConfigurationImportSelector() &#123;    &#125;    protected boolean isEnabled(AnnotationMetadata metadata) &#123;        return this.getClass().equals(EnableAutoConfigurationImportSelector.class) ? (Boolean)this.getEnvironment().getProperty(&quot;spring.boot.enableautoconfiguration&quot;, Boolean.class, true) : true;    &#125;&#125;\nAutoConfigurationImportSelectorç±»ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯getCandidateConfigurationsæ–¹æ³•\n123456789public class AutoConfigurationImportSelector implements DeferredImportSelector, BeanClassLoaderAware, ResourceLoaderAware, BeanFactoryAware, EnvironmentAware, Ordered &#123;  //...      protected List&lt;String&gt; getCandidateConfigurations(AnnotationMetadata metadata, AnnotationAttributes attributes) &#123;        List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(this.getSpringFactoriesLoaderFactoryClass(), this.getBeanClassLoader());        Assert.notEmpty(configurations, &quot;No auto configuration classes found in META-INF/spring.factories. If you are using a custom packaging, make sure that file is correct.&quot;);        return configurations;    &#125;  //...&#125;\ngetCandidateConfigurations() æ–¹æ³•ä¸­è°ƒç”¨äº† SpringFactoriesLoader ç±»çš„ loadFactoryNames æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¸ªæºç ï¼š\n12345678910111213141516171819public static List&lt;String&gt; loadFactoryNames(Class&lt;?&gt; factoryClass, ClassLoader classLoader) &#123;    String factoryClassName = factoryClass.getName();    try &#123;        Enumeration&lt;URL&gt; urls = classLoader != null ? classLoader.getResources(&quot;META-INF/spring.factories&quot;) : ClassLoader.getSystemResources(&quot;META-INF/spring.factories&quot;);        ArrayList result = new ArrayList();        while(urls.hasMoreElements()) &#123;            URL url = (URL)urls.nextElement();            Properties properties = PropertiesLoaderUtils.loadProperties(new UrlResource(url));            String factoryClassNames = properties.getProperty(factoryClassName);            result.addAll(Arrays.asList(StringUtils.commaDelimitedListToStringArray(factoryClassNames)));        &#125;        return result;    &#125; catch (IOException var8) &#123;        throw new IllegalArgumentException(&quot;Unable to load [&quot; + factoryClass.getName() + &quot;] factories from location [&quot; + &quot;META-INF/spring.factories&quot; + &quot;]&quot;, var8);    &#125;&#125;\nä»¥ä¸Š SpringFactoriesLoaderçš„loadeFactoryNamesé™æ€æ–¹æ³•å¯ä»¥ä»æ‰€æœ‰çš„ jar ä¸­è¯»å– META_INF/spring.factoriesæ–‡ä»¶ï¼Œè€Œè‡ªåŠ¨è£…é…çš„ç±»å°±åœ¨è¿™ä¸ªæ–‡ä»¶æ±‡æ€»è¿›è¡Œé…ç½®\nä¾‹å¦‚ï¼ŒMybatis-spring-boot-starterä¸­å°±æœ‰æ­¤æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š\n\nå…¶ä¸­çš„å†…å®¹å¦‚ä¸‹ï¼š\n123# Auto Configureorg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration\n\nè¿™æ · Spring Boot å°±å¯ä»¥åŠ è½½åˆ° MybatisAutoConfiguration è¿™ä¸ªé…ç½®ç±»äº†\nÂ¶Bean åˆ°åŠ è½½\nåœ¨ Spring Boot åº”ç”¨ä¸­è¦è®©ä¸€ä¸ªæ™®é€šç±»äº¤ç»™ Spring å®¹å™¨ç®¡ç†ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š\n\nä½¿ç”¨ @Configurationä¸@Bean æ³¨è§£\nä½¿ç”¨@Controllerã€@Serviceã€ @Repositoryã€ @Component æ³¨è§£æ ‡æ³¨è¯¥ç±»å¹¶ä¸”å¯ç”¨@ComponentScanè‡ªåŠ¨æ‰«æ\nä½¿ç”¨@Importæ³¨è§£ä»¥åŠå¯¹åº”çš„æ–¹æ³•\n\n\nå…¶ä¸­ Spring Boot å®ç°è‡ªåŠ¨é…ç½®ä½¿ç”¨çš„æ˜¯@Importæ³¨è§£è¿™ç§æ–¹å¼ï¼ŒAutoConfigurationImportSelectorç±»çš„selectImportsæ–¹æ³•è¿”å›ä¸€ç»„ä»META-INF/spring.factoriesæ–‡ä»¶ä¸­è¯»å–çš„beançš„å…¨ç±»åï¼Œè¿™æ · Spring Boot å°±å¯ä»¥åŠ è½½åˆ°è¿™äº› Bean å¹¶å®Œæˆå®ä¾‹çš„åˆ›å»ºå·¥ä½œ\nÂ¶è‡ªåŠ¨é…ç½®æ€»ç»“\nğŸ““ è‡ªåŠ¨é…ç½®çš„å…³é”®å‡ æ­¥ä»¥åŠç›¸åº”çš„æ³¨è§£æ€»ç»“å¦‚ä¸‹ï¼š\n\n@Configuration ä¸@Beanï¼šåŸºäº Java ä»£ç çš„ bean é…ç½®\n@Conditionalï¼šè®¾ç½®è‡ªåŠ¨é…ç½®æ¡ä»¶ä¾èµ–\n@EnableConfigurationProperties ä¸@ConfigurationPropertiesï¼šè¯»å–é…ç½®æ–‡ä»¶è½¬æ¢ä¸º bean\n@EnableAutoConfiguration ä¸@Importï¼šå®ç° bean å‘ç°ä¸åŠ è½½\n\n\nÂ¶è‡ªå®šä¹‰ starter\næœ¬å°èŠ‚é€šè¿‡è‡ªå®šä¹‰ starter æ¥åŠ å¼ºä¹‹å‰çš„çŸ¥è¯†\n\nåˆ›å»º starter å·¥ç¨‹ hello-spring-boot-starter å¹¶é…ç½® pom.xml æ–‡ä»¶\n\n\n123456789101112131415161718192021222324252627282930&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;    &lt;groupId&gt;com.pineappleman&lt;/groupId&gt;    &lt;artifactId&gt;hello-spring-boot-starter&lt;/artifactId&gt;    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;    &lt;parent&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;        &lt;version&gt;2.2.2.RELEASE&lt;/version&gt;        &lt;relativePath/&gt;    &lt;/parent&gt;    &lt;properties&gt;        &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;        &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;    &lt;/properties&gt;    &lt;dependencies&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;        &lt;/dependency&gt;    &lt;/dependencies&gt;&lt;/project&gt;\n\nåˆ›å»ºé…ç½®å±æ€§ç±» HelloProperties\n\n\n1234567891011121314151617181920212223242526272829303132/* *è¯»å–é…ç½®æ–‡ä»¶è½¬æ¢ä¸ºbean * */@ConfigurationProperties(prefix = &quot;hello&quot;)public class HelloProperties &#123;    private String name;    private String address;    public String getName() &#123;        return name;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public String getAddress() &#123;        return address;    &#125;    public void setAddress(String address) &#123;        this.address = address;    &#125;    @Override    public String toString() &#123;        return &quot;HelloProperties&#123;&quot; +                &quot;name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; +                &quot;, address=&#x27;&quot; + address + &#x27;\\&#x27;&#x27; +                &#x27;&#125;&#x27;;    &#125;&#125;\n\nåˆ›å»ºæœåŠ¡ç±» HelloService\n\n\n12345678910111213public class HelloService &#123;    private String name;    private String address;    public HelloService(String name, String address) &#123;        this.name = name;        this.address = address;    &#125;    public String sayHello()&#123;        return &quot;ä½ å¥½ï¼æˆ‘çš„åå­—å« &quot; + name + &quot;ï¼Œæˆ‘æ¥è‡ª &quot; + address;    &#125;&#125;\n\nåˆ›å»ºè‡ªåŠ¨é…ç½®ç±» HelloServiceAutoConfiguration\n\n\n123456789101112131415161718192021/** é…ç½®ç±»ï¼ŒåŸºäºJavaä»£ç çš„beané…ç½®* */@Configuration@EnableConfigurationProperties(HelloProperties.class)public class HelloServiceAutoConfiguration &#123;    private HelloProperties helloProperties;    //é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥é…ç½®å±æ€§å¯¹è±¡HelloProperties    public HelloServiceAutoConfiguration(HelloProperties helloProperties) &#123;        this.helloProperties = helloProperties;    &#125;    //å®ä¾‹åŒ–HelloServiceå¹¶è½½å…¥Spring IoCå®¹å™¨    @Bean    @ConditionalOnMissingBean    public HelloService helloService()&#123;        return new HelloService(helloProperties.getName(),helloProperties.getAddress());    &#125;&#125;\n\nåœ¨ resources ç›®å½•ä¸‹åˆ›å»º META-INF/spring.factories\n\n\n12org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\cn.itcast.config.HelloServiceAutoConfiguration\né€šè¿‡ä»¥ä¸Šæ­¥éª¤ä¹‹åï¼Œå¯ä»¥é€šè¿‡ mvn install å°†è‡ªå®šä¹‰çš„ starter å®‰è£…åˆ°æœ¬åœ° maven ä»“åº“\nÂ¶ä½¿ç”¨ starter\n\nåˆ›å»º maven å·¥ç¨‹ myapp å¹¶é…ç½® pom.xml æ–‡ä»¶\n\n\n12345678910111213141516171819202122232425262728293031323334353637&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;         xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;    &lt;groupId&gt;org.example&lt;/groupId&gt;    &lt;artifactId&gt;myapp&lt;/artifactId&gt;    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;    &lt;parent&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;        &lt;version&gt;2.2.2.RELEASE&lt;/version&gt;        &lt;relativePath/&gt;    &lt;/parent&gt;    &lt;properties&gt;        &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;        &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;    &lt;/properties&gt;    &lt;dependencies&gt;        &lt;!--å¯¼å…¥è‡ªå®šä¹‰çš„ starter --&gt;        &lt;dependency&gt;            &lt;groupId&gt;com.pineappleman&lt;/groupId&gt;            &lt;artifactId&gt;hello-spring-boot-starter&lt;/artifactId&gt;            &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;            &lt;optional&gt;true&lt;/optional&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;        &lt;/dependency&gt;    &lt;/dependencies&gt;&lt;/project&gt;\n\nåˆ›å»º application.yml æ–‡ä»¶\n\n\n12345server:  port: 8080hello:  name: xiaoming  address: beijing\n\nåˆ›å»º HelloController\n\n\n12345678910111213@RestController@RequestMapping(value = &quot;/hello&quot;)public class HelloController &#123;\t/** å½“å‰å®ä¾‹å·²ç»ç”±è‡ªå®šä¹‰çš„ starter å®Œæˆäº†åˆ›å»º */\t@Autowired\tprivate HelloService helloService;\t@GetMapping(value =&quot;/say&quot;)\tpublic String sayHello()&#123;\t\treturn helloService.sayHello();\t&#125;&#125;\n\nåˆ›å»ºå¯åŠ¨ç±» HelloApplication\n\n\n123456@SpringBootApplicationpublic class HelloApplication &#123;\tpublic static void main(String[] args) &#123;\t\tSpringApplication.run(HelloApplication.class, args);\t&#125;&#125;\nè‡³æ­¤ï¼Œå°±å®Œæˆäº† Spring Boot çš„ Starter çš„åˆ›å»ºä»¥åŠä½¿ç”¨\n","dateCreated":"2022-01-30T12:47:40+00:00","dateModified":"2023-06-07T02:13:34+00:00","datePublished":"2022-01-30T12:47:40+00:00","description":"ä½¿ç”¨æŸä¸ªç»„ä»¶æ—¶ï¼Œå¸¸çœ‹åˆ° xxx.starterï¼Œé‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯ starter","headline":"spring boot Starter","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://pineapple-man.github.io/spring-boot-starter/"},"publisher":{"@type":"Organization","name":"pineapple-man","sameAs":["https://github.com/pineapple-man","mailto://mingchaohu720@gmail.com"],"image":"logo.png","logo":{"@type":"ImageObject","url":"logo.png"}},"url":"https://pineapple-man.github.io/spring-boot-starter/","keywords":"SpringBoot"}</script><meta name="description" content="ä½¿ç”¨æŸä¸ªç»„ä»¶æ—¶ï¼Œå¸¸çœ‹åˆ° xxx.starterï¼Œé‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯ starter"><meta property="og:type" content="blog"><meta property="og:title" content="spring boot Starter"><meta property="og:url" content="https://pineapple-man.github.io/spring-boot-starter/"><meta property="og:site_name" content="pineapple-man"><meta property="og:description" content="ä½¿ç”¨æŸä¸ªç»„ä»¶æ—¶ï¼Œå¸¸çœ‹åˆ° xxx.starterï¼Œé‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯ starter"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-starter%E8%B5%B7%E6%AD%A5%E4%BE%9D%E8%B5%96.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-mybatisStarter.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-mybaits-autoconfiguration.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-mybatisstarter-spring-factories.png"><meta property="article:published_time" content="2022-01-30T12:47:40.000Z"><meta property="article:modified_time" content="2023-06-07T02:13:34.011Z"><meta property="article:author" content="pineapple-man"><meta property="article:tag" content="SpringBoot"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-starter%E8%B5%B7%E6%AD%A5%E4%BE%9D%E8%B5%96.png"><meta property="og:image" content="https://pineapple-man.github.io/assets/images/logo.png"><link rel="stylesheet" href="/assets/css/style-oth3meuzcjopbgwqbdvoxqknhcm0sy9wkullcc94zhkkop3pmfrpl5t4fzzz.min.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-210516333-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-210516333-1")</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"></head><body><div id="blog"><header id="header" data-behavior="5"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><div class="header-title"><a class="header-title-link" href="/" aria-label="">pineapple-man</a></div><a class="header-right-picture" href="#about" aria-label="æ‰“å¼€é“¾æ¥: /#about"><img class="header-picture" src="/assets/images/logo.png" alt="ä½œè€…çš„å›¾ç‰‡"></a></header><nav id="sidebar" data-behavior="5"><div class="sidebar-container"><div class="sidebar-profile"><a href="/#about" aria-label="é˜…è¯»æœ‰å…³ä½œè€…çš„æ›´å¤šä¿¡æ¯"><img class="sidebar-profile-picture" src="/assets/images/logo.png" alt="ä½œè€…çš„å›¾ç‰‡"></a><h4 class="sidebar-profile-name">pineapple-man</h4><h5 class="sidebar-profile-bio"><p>åšä¸€ä¸ªè èï¼šç«™å¾—ç¬”ç›´ï¼Œå¤´æˆ´ç‹å† ï¼Œå†…å¿ƒç”œç¾</p></h5></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="/" rel="noopener" title="é¦–é¡µ"><i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i> <span class="sidebar-button-desc">é¦–é¡µ</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-categories" rel="noopener" title="åˆ†ç±»"><i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i> <span class="sidebar-button-desc">åˆ†ç±»</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-tags" rel="noopener" title="æ ‡ç­¾"><i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i> <span class="sidebar-button-desc">æ ‡ç­¾</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-archives" rel="noopener" title="å½’æ¡£"><i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i> <span class="sidebar-button-desc">å½’æ¡£</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="#about" rel="noopener" title="å…³äº"><i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i> <span class="sidebar-button-desc">å…³äº</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="https://github.com/pineapple-man" target="_blank" rel="noopener" title="GitHub"><i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i> <span class="sidebar-button-desc">GitHub</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="mailto://mingchaohu720@gmail.com" target="_blank" rel="noopener" title="é‚®ç®±"><i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i> <span class="sidebar-button-desc">é‚®ç®±</span></a></li></ul></div></nav><div id="main" data-behavior="5" class="hasCoverMetaIn"><article class="post"><div class="post-header main-content-wrap text-center"><h1 class="post-title">spring boot Starter</h1><div class="post-meta"><time datetime="2022-01-30T12:47:40+00:00">1æœˆ 30, 2022 </time><span>å‘å¸ƒåœ¨ </span><a class="category-link" href="/categories/Java/">Java</a> <i class="fas fa-book-open"></i> æœ¬æ–‡å…±<span class="post-count"> 3.2k </span>å­— <i class="far fa-clock"></i> é˜…è¯»é¢„è®¡<span class="post-count"> 36 </span>åˆ†é’Ÿ</div></div><div class="post-content markdown"><div class="main-content-wrap"><h1 id="table-of-contents">ç›®å½•</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%B7%E6%AD%A5%E4%BE%9D%E8%B5%96"><span class="toc-text">èµ·æ­¥ä¾èµ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">è‡ªåŠ¨é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-Java-%E4%BB%A3%E7%A0%81%E7%9A%84-Bean-%E9%85%8D%E7%BD%AE"><span class="toc-text">åŸºäº Java ä»£ç çš„ Bean é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6%E4%BE%9D%E8%B5%96"><span class="toc-text">è‡ªåŠ¨é…ç½®æ¡ä»¶ä¾èµ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bean-%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96"><span class="toc-text">Bean å‚æ•°è·å–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bean-%E7%9A%84%E5%8F%91%E7%8E%B0"><span class="toc-text">Bean çš„å‘ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bean-%E5%88%B0%E5%8A%A0%E8%BD%BD"><span class="toc-text">Bean åˆ°åŠ è½½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E6%80%BB%E7%BB%93"><span class="toc-text">è‡ªåŠ¨é…ç½®æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-starter"><span class="toc-text">è‡ªå®šä¹‰ starter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-starter"><span class="toc-text">ä½¿ç”¨ starter</span></a></li></ol><p>Spring Boot å¤§å¤§ç®€åŒ–äº†é¡¹ç›®åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹ï¼Œè€Œè¿™äº›éƒ½æ˜¯é€šè¿‡ Spring Boot æä¾›çš„ starter æ¥å®Œæˆçš„ï¼Œä¸€ä¸ªé¡¹ç›®ä¸­çš„åŸºç¡€æ¨¡å—æœ¬è´¨å°±æ˜¯ä¸€ä¸ª Starterï¼Œæœ¬æ–‡ä¸»è¦å¯¹ Spring boot çš„ starter è¿›è¡Œæ¯”è¾ƒå…¨é¢æ·±å…¥çš„è®°å½•ã€‚</p><h2 id="æ¦‚è¿°"><a class="header-anchor" href="#æ¦‚è¿°">Â¶</a>æ¦‚è¿°</h2><p>spring boot åœ¨é…ç½®ä¸Šç›¸æ¯” spring è¦ç®€å•è®¸å¤š, å…¶æ ¸å¿ƒåœ¨äº spring-boot-starter, åœ¨ä½¿ç”¨ spring boot æ¥æ­å»ºä¸€ä¸ªé¡¹ç›®æ—¶, åªéœ€è¦å¼•å…¥å®˜æ–¹æä¾›çš„ starter, å°±å¯ä»¥ç›´æ¥ä½¿ç”¨, å…å»äº†å„ç§é…ç½®ã€‚starter ç®€å•æ¥è®²å°±æ˜¯å¼•å…¥äº†ä¸€äº›ç›¸å…³ä¾èµ–å’Œä¸€äº›åˆå§‹åŒ–çš„é…ç½®ã€‚</p><p>Spring å®˜æ–¹æä¾›äº†å¾ˆå¤š starterï¼Œç¬¬ä¸‰æ–¹ä¹Ÿå¯ä»¥å®šä¹‰ starterã€‚ä¸ºäº†åŠ ä»¥åŒºåˆ†ï¼Œstarter ä»åç§°ä¸Šè¿›è¡Œäº†å¦‚ä¸‹è§„èŒƒï¼š</p><div class="alert success no-icon"><ol><li>Spring å®˜æ–¹æä¾›çš„ starter åç§°ä¸ºï¼š<code>spring-boot-starter-xxx</code>ï¼Œä¾‹å¦‚ Spring å®˜æ–¹æä¾›çš„ <code>spring-boot-starter-web</code></li><li>ç¬¬ä¸‰æ–¹æä¾›çš„ starter åç§°ä¸ºï¼š<code>xxx-spring-boot-starter</code>ï¼Œä¾‹å¦‚ç”± mybatis æä¾›çš„ <code>mybatis-spring-boot-starter</code></li></ol></div><p>Spring Boot ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¸®æˆ‘ä»¬ç®€åŒ–é¡¹ç›®çš„æ­å»ºå’Œå¼€å‘è¿‡ç¨‹ï¼Œä¸»è¦æ˜¯åŸºäºå®ƒæä¾›çš„èµ·æ­¥ä¾èµ–å’Œè‡ªåŠ¨é…ç½®</p><h2 id="èµ·æ­¥ä¾èµ–"><a class="header-anchor" href="#èµ·æ­¥ä¾èµ–">Â¶</a>èµ·æ­¥ä¾èµ–</h2><p>èµ·æ­¥ä¾èµ–<strong>å…¶å®å°±æ˜¯å°†å…·å¤‡æŸç§åŠŸèƒ½çš„åæ ‡æ‰“åŒ…åˆ°ä¸€èµ·</strong>ï¼Œå¯ä»¥ç®€åŒ–ä¾èµ–å¯¼å…¥çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯¼å…¥ spring-boot-starter-web è¿™ä¸ª starterï¼Œåˆ™å’Œ web å¼€å‘ç›¸å…³çš„ jar åŒ…éƒ½ä¸€èµ·å¯¼å…¥åˆ°é¡¹ç›®ä¸­äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div class="figure fig-100 center"><a class="fancybox" target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-starterèµ·æ­¥ä¾èµ–.png" data-caption="" data-fancybox="default"><img class="fig-img" src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-starterèµ·æ­¥ä¾èµ–.png" alt=""></a></div><h2 id="è‡ªåŠ¨é…ç½®"><a class="header-anchor" href="#è‡ªåŠ¨é…ç½®">Â¶</a>è‡ªåŠ¨é…ç½®</h2><p>è‡ªåŠ¨é…ç½®ï¼Œå°±æ˜¯æ— é¡»æ‰‹åŠ¨é…ç½® xmlï¼Œè‡ªåŠ¨é…ç½®å¹¶ç®¡ç† beanï¼Œé‚£ä¹ˆ Spring Boot æ˜¯å¦‚ä½•å®Œæˆè‡ªåŠ¨é…ç½®çš„å°¼ï¼Ÿ<br>â›µ è‡ªåŠ¨é…ç½®æ¶‰åŠåˆ°å¦‚ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š</p><div class="alert success no-icon"><ol><li>åŸºäº Java ä»£ç çš„ bean é…ç½®</li><li>æ¿€åŠ¨é…ç½®æ¡ä»¶ä¾èµ–</li><li>Bean å‚æ•°è·å–</li><li>Bean çš„å‘ç°</li><li>Bean çš„åŠ è½½</li></ol></div><p>æ¥ä¸‹æ¥ä»¥<code>Mybatis-spring-boot-starter</code>æ¥è¯´æ˜è‡ªåŠ¨é…ç½®çš„å®ç°è¿‡ç¨‹</p><h3 id="åŸºäº-Java-ä»£ç çš„-Bean-é…ç½®"><a class="header-anchor" href="#åŸºäº-Java-ä»£ç çš„-Bean-é…ç½®">Â¶</a>åŸºäº Java ä»£ç çš„ Bean é…ç½®</h3><p>å½“æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¯¼å…¥äº†<code>mybatis-spring-boot-starter</code>è¿™ä¸ª jar åï¼Œå¯ä»¥çœ‹åˆ°å®ƒåŒ…æ‹¬äº†å¾ˆå¤šç›¸å…³çš„ jar åŒ…</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-mybatisStarter.png" alt=""></p><p>å…¶ä¸­åœ¨ mybatis-spring-boot-autoconfigure è¿™ä¸ª jar åŒ…ä¸­æœ‰å¦‚ä¸‹ä¸€ä¸ª<strong>MybatisAutoConfiguration</strong>è‡ªåŠ¨é…ç½®ç±»</p><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-mybaits-autoconfiguration.png" alt=""></p><p>æ‰“å¼€è¿™ä¸ªç±»ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)</span></span><br><span class="line"><span class="meta">@ConditionalOnBean(&#123;DataSource.class&#125;)</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(&#123;MybatisProperties.class&#125;)</span></span><br><span class="line"><span class="meta">@AutoConfigureAfter(&#123;DataSourceAutoConfiguration.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisAutoConfiguration</span> &#123;</span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">  <span class="keyword">public</span> SqlSessionFactory <span class="title function_">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span> <span class="keyword">throws</span> Exception&#123;...&#125;</span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">  <span class="keyword">public</span> SqlSessionTemplate <span class="title function_">sqlSessionTemplate</span><span class="params">(SqlSessionFactory sqlSessionFactory)</span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>@Configuration</strong>å’Œ <strong>@Bean</strong> è¿™ä¸¤ä¸ªæ³¨è§£ä¸€èµ·ä½¿ç”¨å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸºäº java ä»£ç çš„é…ç½®ç±»ï¼Œå¯ä»¥ç”¨æ¥æ›¿ä»£ä¼ ç»Ÿçš„ xml é…ç½®æ–‡ä»¶ï¼Œä¸¤ä¸ªæ³¨è§£å…·ä½“çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">æ³¨è§£</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center"><code>@Configuration</code></td><td style="text-align:center">åœ¨ç±»ä¸Šæ ‡æ³¨ï¼Œè¡¨æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»</td></tr><tr><td style="text-align:center"><code>@Bean</code></td><td style="text-align:center">è¡¨æ˜éœ€è¦å‘ Spring IoC å®¹å™¨ä¸­æ³¨å…¥çš„ Bean</td></tr></tbody></table><p>æ‰€ä»¥ä¸Šé¢çš„<strong>MybatisAutoConfiguration</strong>è¿™ä¸ªç±»ï¼Œè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆäº† <code>SqlSessionFactory</code> å’Œ <code>SqlSessionTemplate</code> è¿™äº› Mybatis çš„é‡è¦å®ä¾‹å¹¶äº¤ç»™ spring å®¹å™¨ç®¡ç†ï¼Œä»è€Œå®Œæˆ bean çš„è‡ªåŠ¨æ³¨å†Œ</p><h3 id="è‡ªåŠ¨é…ç½®æ¡ä»¶ä¾èµ–"><a class="header-anchor" href="#è‡ªåŠ¨é…ç½®æ¡ä»¶ä¾èµ–">Â¶</a>è‡ªåŠ¨é…ç½®æ¡ä»¶ä¾èµ–</h3><p>ä»<code>MybatisAutoConfiguration</code>è¿™ä¸ªç±»ä¸­ä½¿ç”¨çš„æ³¨è§£å¯ä»¥çœ‹å‡ºï¼Œè¦å®Œæˆè‡ªåŠ¨é…ç½®æ˜¯æœ‰ä¾èµ–æ¡ä»¶çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionalOnClass(&#123;SqlSessionFactory.class, SqlSessionFactoryBean.class&#125;)</span></span><br><span class="line"><span class="meta">@ConditionalOnBean(&#123;DataSource.class&#125;)</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¦å®Œæˆ Mybatis çš„è‡ªåŠ¨é…ç½®ï¼Œéœ€è¦åœ¨ç±»è·¯å¾„ä¸­å­˜åœ¨<code>SqlSessionFactory</code>ã€<code>SqlSessionFactoryBean</code>è¿™ä¸¤ä¸ªç±»ï¼ŒåŒæ—¶éœ€è¦å­˜åœ¨ DataSource è¿™ä¸ª bean ä¸”è¿™ä¸ª bean å®Œæˆè‡ªåŠ¨æ³¨å†Œ</p><p>Spring boot ä¸­å¸¸è§çš„æ¡ä»¶ä¾èµ–æ³¨è§£æœ‰ï¼š</p><table><thead><tr><th style="text-align:center">æ³¨è§£</th><th style="text-align:center">åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center"><code>@ConditionalOnBean</code></td><td style="text-align:center">ä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­å­˜åœ¨æŸä¸ª bean æ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean</td></tr><tr><td style="text-align:center"><code>@ConditionalOnClass</code></td><td style="text-align:center">æŸä¸ª class ä½äºç±»è·¯å¾„ä¸Šï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean</td></tr><tr><td style="text-align:center"><code>@ConditionalOnExpression</code></td><td style="text-align:center">å½“è¡¨è¾¾å¼ä¸º true çš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean</td></tr><tr><td style="text-align:center"><code>@ConditionalOnMissingBean</code></td><td style="text-align:center">ä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­ä¸å­˜åœ¨æŸä¸ª bean æ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Beanï¼Œé˜²æ­¢é‡å¤åˆ›å»º</td></tr><tr><td style="text-align:center"><code>@ConditionalOnMissingClass</code></td><td style="text-align:center">æŸä¸ª class åœ¨ç±»è·¯å¾„ä¸Šä¸å­˜åœ¨çš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean</td></tr><tr><td style="text-align:center"><code>@ConditionalOnNotWebApplication</code></td><td style="text-align:center">ä¸æ˜¯ web åº”ç”¨æ—¶æ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ª Bean</td></tr><tr><td style="text-align:center"><code>@AutoConfigureAfter</code></td><td style="text-align:center">åœ¨æŸä¸ª bean å®Œæˆè‡ªåŠ¨é…ç½®åå®ä¾‹åŒ–è¿™ä¸ª bean</td></tr><tr><td style="text-align:center"><code>@AutoConfigureBefore</code></td><td style="text-align:center">åœ¨æŸä¸ª bean å®Œæˆè‡ªåŠ¨é…ç½®å‰å®ä¾‹åŒ–è¿™ä¸ª bean</td></tr></tbody></table><h3 id="Bean-å‚æ•°è·å–"><a class="header-anchor" href="#Bean-å‚æ•°è·å–">Â¶</a>Bean å‚æ•°è·å–</h3><div class="alert success no-icon"><p>è¦å®Œæˆ mybatis çš„è‡ªåŠ¨é…ç½®ï¼Œéœ€è¦æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­æä¾›æ•°æ®æºç›¸å…³çš„é…ç½®å‚æ•°ï¼Œä¾‹å¦‚æ•°æ®åº“é©±åŠ¨ã€è¿æ¥ urlã€æ•°æ®åº“ç”¨æˆ·åã€å¯†ç ç­‰ã€‚é‚£ä¹ˆ spring boot æ˜¯å¦‚ä½•è¯»å– yml æˆ–è€… properites é…ç½®æ–‡ä»¶çš„çš„å±æ€§æ¥åˆ›å»ºæ•°æ®æºå¯¹è±¡çš„ï¼Ÿ</p></div><p>åœ¨æˆ‘ä»¬å¯¼å…¥ mybatis-spring-boot-starter è¿™ä¸ª jar åŒ…åä¼šä¼ é€’è¿‡æ¥ä¸€ä¸ª spring-boot-autoconfigure åŒ…ï¼Œåœ¨è¿™ä¸ªåŒ…ä¸­æœ‰ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»<strong>DataSourceAutoConfiguration</strong>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(&#123;DataSource.class, EmbeddedDatabaseType.class&#125;)</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(&#123;DataSourceProperties.class&#125;)</span></span><br><span class="line"><span class="meta">@Import(&#123;Registrar.class, DataSourcePoolMetadataProvidersConfiguration.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSourceAutoConfiguration</span> &#123;&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªç±»åŠ å…¥äº†<code>EnableConfigurationProperties</code>æ³¨è§£ï¼ŒDataSourceProperties è¿™ä¸ªç±»å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(</span></span><br><span class="line"><span class="meta">    prefix = &quot;spring.datasource&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSourceProperties</span> <span class="keyword">implements</span> <span class="title class_">BeanClassLoaderAware</span>, EnvironmentAware, InitializingBean &#123;&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªç±»ä¸ŠåŠ å…¥äº†<strong>ConfigurationProperties</strong>æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£çš„ä½œç”¨å°±æ˜¯æŠŠ yml æˆ–è€… properties é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®å‚æ•°ä¿¡æ¯å°è£…åˆ°<strong>ConfigurationProperties</strong>æ³¨è§£æ ‡æ³¨çš„ bean(å³<strong>DataSourceProperties</strong>)çš„ç›¸åº”å±æ€§ä¸Šã€‚</p><div class="alert info no-icon"><p><code>@EnableConfigurationProperties</code>æ³¨è§£çš„ä½œç”¨æ˜¯ä½¿<code>@ConfigurationProperties</code>æ³¨è§£ç”Ÿæ•ˆï¼Œå¹¶ä¸”å°†<code>@ConfigurationProperties</code>æ ‡æ³¨çš„ Bean æ³¨å…¥åˆ° <code>@EnablelConfigurationProperties</code>ç±»ä¸­ã€‚</p></div><p>å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼Œæœ€ç»ˆ <code>DataSourceProperties</code> ç±»å°†æ³¨å…¥åˆ° <code>DataSourceAutoConfiguration</code>ä¸­ä½¿ç”¨ï¼Œéšå Spring å°†æ ¹æ®<code>DataSourceAutoConfiguration</code>ç±»ä¸­çš„é…ç½®ï¼Œè‡ªåŠ¨æ³¨å…¥æ–°çš„ Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line"><span class="keyword">public</span> DataSourceInitializer <span class="title function_">dataSourceInitializer</span><span class="params">(DataSourceProperties properties, ApplicationContext applicationContext)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DataSourceInitializer</span>(properties, applicationContext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Bean-çš„å‘ç°"><a class="header-anchor" href="#Bean-çš„å‘ç°">Â¶</a>Bean çš„å‘ç°</h3><div class="alert success no-icon"><p>spring boot é»˜è®¤æ‰«æå¯åŠ¨ç±»æ‰€åœ¨çš„åŒ…ä¸‹çš„ä¸»ç±»ä¸å­ç±»çš„æ‰€æœ‰ç»„ä»¶ï¼Œä½†å¹¶æ²¡æœ‰åŒ…æ‹¬ä¾èµ–åŒ…ä¸­çš„ç±»ï¼Œé‚£ä¹ˆä¾èµ–åŒ…ä¸­çš„ bean æ˜¯å¦‚ä½•è¢«å‘ç°å’ŒåŠ è½½çš„ï¼Ÿ</p></div><div class="alert info no-icon"><p>ä¸€èˆ¬ Spring boot åº”ç”¨ç¨‹åºçš„å¯åŠ¨ç±»éƒ½æœ‰ <code>@SpringBootApplication</code> æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£çš„æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan(</span></span><br><span class="line"><span class="meta">    excludeFilters = &#123;@Filter(</span></span><br><span class="line"><span class="meta">    type = FilterType.CUSTOM,</span></span><br><span class="line"><span class="meta">    classes = &#123;TypeExcludeFilter.class&#125;</span></span><br><span class="line"><span class="meta">), @Filter(</span></span><br><span class="line"><span class="meta">    type = FilterType.CUSTOM,</span></span><br><span class="line"><span class="meta">    classes = &#123;AutoConfigurationExcludeFilter.class&#125;</span></span><br><span class="line"><span class="meta">)&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootApplication &#123;...&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ¯”è¾ƒé‡è¦æ˜¯ä¸‹é¢è¿™ä¸‰ä¸ªæ³¨è§£ï¼š</p><ul><li><code>@SpringBootConfiguration</code>ï¼šä½œç”¨å°±ç›¸å½“<code>@Configuration</code>æ³¨è§£ï¼Œè¢«æ³¨è§£çš„ç±»å°†æˆä¸ºä¸€ä¸ª bean é…ç½®ç±»</li><li><code>@ComponentScan</code>ï¼šä½œç”¨å°±æ˜¯è‡ªåŠ¨æ‰«æå¹¶åŠ è½½ç¬¦åˆæ¡ä»¶çš„ç»„ä»¶ï¼Œæœ€ç»ˆå°†è¿™äº› bean åŠ è½½åˆ° spring å®¹å™¨ä¸­</li><li><code>@EnableAutoConfiguration</code>ï¼šè¿™ä¸ªæ³¨è§£å¾ˆé‡è¦ï¼Œå€ŸåŠ©<code>@Import</code>çš„æ”¯æŒï¼Œæ”¶é›†å’Œæ³¨å†Œä¾èµ–åŒ…ä¸­ç›¸å…³çš„ Bean å®šä¹‰</li></ul></div><p>ç»§ç»­è¿½è¸ª<code>@EnableAutoConfiguration</code>æ³¨è§£æºç ï¼Œè¿™ä¸ªæ³¨è§£å¼•ç”¨äº†<code>@Import</code>æ³¨è§£ï¼Œ<code>@Import</code>æ³¨è§£èƒ½å¤Ÿå¯¼å…¥éœ€è¦è‡ªåŠ¨é…ç½®çš„ç»„ä»¶ï¼Œæ­¤å¤„å°±è‡ªåŠ¨å¯¼å…¥ç±»<code>EnableAutoConfigurationImportSelector</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@AutoConfigurationPackage</span></span><br><span class="line"><span class="meta">@Import(&#123;EnableAutoConfigurationImportSelector.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableAutoConfiguration &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">ENABLED_OVERRIDE_PROPERTY</span> <span class="operator">=</span> <span class="string">&quot;spring.boot.enableautoconfiguration&quot;</span>;</span><br><span class="line"></span><br><span class="line">    Class&lt;?&gt;[] exclude() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    String[] excludeName() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>EnableAutoConfigurationImportSelector</code>ç±»çš„æºç å¦‚ä¸‹ï¼Œç”±äºå¦‚ä»Šè¿™ä¸ªç±»å·²ç»è¢«å¼ƒç”¨ï¼Œæ‰€å“Ÿè¯¦ç»†çš„ç»†èŠ‚æŸ¥çœ‹çˆ¶ç±»<code>AutoConfigurationImportSelector</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EnableAutoConfigurationImportSelector</span> <span class="keyword">extends</span> <span class="title class_">AutoConfigurationImportSelector</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EnableAutoConfigurationImportSelector</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">isEnabled</span><span class="params">(AnnotationMetadata metadata)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.getClass().equals(EnableAutoConfigurationImportSelector.class) ? (Boolean)<span class="built_in">this</span>.getEnvironment().getProperty(<span class="string">&quot;spring.boot.enableautoconfiguration&quot;</span>, Boolean.class, <span class="literal">true</span>) : <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AutoConfigurationImportSelector</code>ç±»ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯<code>getCandidateConfigurations</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutoConfigurationImportSelector</span> <span class="keyword">implements</span> <span class="title class_">DeferredImportSelector</span>, BeanClassLoaderAware, ResourceLoaderAware, BeanFactoryAware, EnvironmentAware, Ordered &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">      <span class="keyword">protected</span> List&lt;String&gt; <span class="title function_">getCandidateConfigurations</span><span class="params">(AnnotationMetadata metadata, AnnotationAttributes attributes)</span> &#123;</span><br><span class="line">        List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(<span class="built_in">this</span>.getSpringFactoriesLoaderFactoryClass(), <span class="built_in">this</span>.getBeanClassLoader());</span><br><span class="line">        Assert.notEmpty(configurations, <span class="string">&quot;No auto configuration classes found in META-INF/spring.factories. If you are using a custom packaging, make sure that file is correct.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> configurations;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>getCandidateConfigurations()</code> æ–¹æ³•ä¸­è°ƒç”¨äº† SpringFactoriesLoader ç±»çš„ loadFactoryNames æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¸ªæºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">loadFactoryNames</span><span class="params">(Class&lt;?&gt; factoryClass, ClassLoader classLoader)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">factoryClassName</span> <span class="operator">=</span> factoryClass.getName();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Enumeration&lt;URL&gt; urls = classLoader != <span class="literal">null</span> ? classLoader.getResources(<span class="string">&quot;META-INF/spring.factories&quot;</span>) : ClassLoader.getSystemResources(<span class="string">&quot;META-INF/spring.factories&quot;</span>);</span><br><span class="line">        <span class="type">ArrayList</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(urls.hasMoreElements()) &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> (URL)urls.nextElement();</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> PropertiesLoaderUtils.loadProperties(<span class="keyword">new</span> <span class="title class_">UrlResource</span>(url));</span><br><span class="line">            <span class="type">String</span> <span class="variable">factoryClassNames</span> <span class="operator">=</span> properties.getProperty(factoryClassName);</span><br><span class="line">            result.addAll(Arrays.asList(StringUtils.commaDelimitedListToStringArray(factoryClassNames)));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException var8) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Unable to load [&quot;</span> + factoryClass.getName() + <span class="string">&quot;] factories from location [&quot;</span> + <span class="string">&quot;META-INF/spring.factories&quot;</span> + <span class="string">&quot;]&quot;</span>, var8);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Š <code>SpringFactoriesLoader</code>çš„<code>loadeFactoryNames</code>é™æ€æ–¹æ³•å¯ä»¥ä»æ‰€æœ‰çš„ jar ä¸­è¯»å– <code>META_INF/spring.factories</code>æ–‡ä»¶ï¼Œè€Œè‡ªåŠ¨è£…é…çš„ç±»å°±åœ¨è¿™ä¸ªæ–‡ä»¶æ±‡æ€»è¿›è¡Œé…ç½®</p><div class="alert warning no-icon"><p>ä¾‹å¦‚ï¼Œ<code>Mybatis-spring-boot-starter</code>ä¸­å°±æœ‰æ­¤æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/pineapple-man/blogImage@main/image/springboot/springboot-mybatisstarter-spring-factories.png" alt=""></p><p>å…¶ä¸­çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Auto Configure</span><br><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\</span><br><span class="line">org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</span><br></pre></td></tr></table></figure></div><p>è¿™æ · Spring Boot å°±å¯ä»¥åŠ è½½åˆ° MybatisAutoConfiguration è¿™ä¸ªé…ç½®ç±»äº†</p><h3 id="Bean-åˆ°åŠ è½½"><a class="header-anchor" href="#Bean-åˆ°åŠ è½½">Â¶</a>Bean åˆ°åŠ è½½</h3><p>åœ¨ Spring Boot åº”ç”¨ä¸­è¦è®©ä¸€ä¸ªæ™®é€šç±»äº¤ç»™ Spring å®¹å™¨ç®¡ç†ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š</p><div class="alert success no-icon"><ol><li>ä½¿ç”¨<code>@Configuration</code>ä¸<code>@Bean</code> æ³¨è§£</li><li>ä½¿ç”¨<code>@Controller</code>ã€<code>@Service</code>ã€<code>@Repository</code>ã€<code>@Component</code> æ³¨è§£æ ‡æ³¨è¯¥ç±»å¹¶ä¸”å¯ç”¨<code>@ComponentScan</code>è‡ªåŠ¨æ‰«æ</li><li>ä½¿ç”¨<code>@Import</code>æ³¨è§£ä»¥åŠå¯¹åº”çš„æ–¹æ³•</li></ol></div><p>å…¶ä¸­ Spring Boot å®ç°è‡ªåŠ¨é…ç½®ä½¿ç”¨çš„æ˜¯<code>@Import</code>æ³¨è§£è¿™ç§æ–¹å¼ï¼Œ<code>AutoConfigurationImportSelector</code>ç±»çš„<code>selectImports</code>æ–¹æ³•è¿”å›ä¸€ç»„ä»<code>META-INF/spring.factories</code>æ–‡ä»¶ä¸­è¯»å–çš„<code>bean</code>çš„å…¨ç±»åï¼Œè¿™æ · Spring Boot å°±å¯ä»¥åŠ è½½åˆ°è¿™äº› Bean å¹¶å®Œæˆå®ä¾‹çš„åˆ›å»ºå·¥ä½œ</p><h3 id="è‡ªåŠ¨é…ç½®æ€»ç»“"><a class="header-anchor" href="#è‡ªåŠ¨é…ç½®æ€»ç»“">Â¶</a>è‡ªåŠ¨é…ç½®æ€»ç»“</h3><p>ğŸ““ è‡ªåŠ¨é…ç½®çš„å…³é”®å‡ æ­¥ä»¥åŠç›¸åº”çš„æ³¨è§£æ€»ç»“å¦‚ä¸‹ï¼š</p><div class="alert info no-icon"><ol><li>@Configuration ä¸@Beanï¼šåŸºäº Java ä»£ç çš„ bean é…ç½®</li><li>@Conditionalï¼šè®¾ç½®è‡ªåŠ¨é…ç½®æ¡ä»¶ä¾èµ–</li><li>@EnableConfigurationProperties ä¸@ConfigurationPropertiesï¼šè¯»å–é…ç½®æ–‡ä»¶è½¬æ¢ä¸º bean</li><li>@EnableAutoConfiguration ä¸@Importï¼šå®ç° bean å‘ç°ä¸åŠ è½½</li></ol></div><h2 id="è‡ªå®šä¹‰-starter"><a class="header-anchor" href="#è‡ªå®šä¹‰-starter">Â¶</a>è‡ªå®šä¹‰ starter</h2><p>æœ¬å°èŠ‚é€šè¿‡è‡ªå®šä¹‰ starter æ¥åŠ å¼ºä¹‹å‰çš„çŸ¥è¯†</p><div class="alert warning no-icon"><ol><li>åˆ›å»º starter å·¥ç¨‹ hello-spring-boot-starter å¹¶é…ç½® pom.xml æ–‡ä»¶</li></ol></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.pineappleman<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><ol start="2"><li>åˆ›å»ºé…ç½®å±æ€§ç±» HelloProperties</li></ol></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *è¯»å–é…ç½®æ–‡ä»¶è½¬æ¢ä¸ºbean</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;HelloProperties&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><ol start="3"><li>åˆ›å»ºæœåŠ¡ç±» HelloService</li></ol></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HelloService</span><span class="params">(String name, String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ä½ å¥½ï¼æˆ‘çš„åå­—å« &quot;</span> + name + <span class="string">&quot;ï¼Œæˆ‘æ¥è‡ª &quot;</span> + address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><ol start="4"><li>åˆ›å»ºè‡ªåŠ¨é…ç½®ç±» HelloServiceAutoConfiguration</li></ol></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* é…ç½®ç±»ï¼ŒåŸºäºJavaä»£ç çš„beané…ç½®</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(HelloProperties.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServiceAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> HelloProperties helloProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥é…ç½®å±æ€§å¯¹è±¡HelloProperties</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HelloServiceAutoConfiguration</span><span class="params">(HelloProperties helloProperties)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.helloProperties = helloProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–HelloServiceå¹¶è½½å…¥Spring IoCå®¹å™¨</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    <span class="keyword">public</span> HelloService <span class="title function_">helloService</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HelloService</span>(helloProperties.getName(),helloProperties.getAddress());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><ol start="5"><li>åœ¨ resources ç›®å½•ä¸‹åˆ›å»º META-INF/spring.factories</li></ol></div><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\</span><br><span class="line">cn.itcast.config.HelloServiceAutoConfiguration</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ä¹‹åï¼Œå¯ä»¥é€šè¿‡ <code>mvn install</code> å°†è‡ªå®šä¹‰çš„ starter å®‰è£…åˆ°æœ¬åœ° maven ä»“åº“</p><h2 id="ä½¿ç”¨-starter"><a class="header-anchor" href="#ä½¿ç”¨-starter">Â¶</a>ä½¿ç”¨ starter</h2><div class="alert warning no-icon"><ol><li>åˆ›å»º maven å·¥ç¨‹ myapp å¹¶é…ç½® pom.xml æ–‡ä»¶</li></ol></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;project xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">         xmlns=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="line">         xsi:schemaLocation=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br><span class="line">    &lt;modelVersion&gt;<span class="number">4.0</span><span class="number">.0</span>&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;org.example&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;myapp&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">1.0</span>-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;<span class="number">2.2</span><span class="number">.2</span>.RELEASE&lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;maven.compiler.source&gt;<span class="number">8</span>&lt;/maven.compiler.source&gt;</span><br><span class="line">        &lt;maven.compiler.target&gt;<span class="number">8</span>&lt;/maven.compiler.target&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;!--å¯¼å…¥è‡ªå®šä¹‰çš„ starter --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.pineappleman&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;hello-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">1.0</span>-SNAPSHOT&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">            &lt;optional&gt;<span class="literal">true</span>&lt;/optional&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><ol start="2"><li>åˆ›å»º application.yml æ–‡ä»¶</li></ol></div><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">hello:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">xiaoming</span></span><br><span class="line">  <span class="attr">address:</span> <span class="string">beijing</span></span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><ol start="3"><li>åˆ›å»º HelloController</li></ol></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">	<span class="comment">/** å½“å‰å®ä¾‹å·²ç»ç”±è‡ªå®šä¹‰çš„ starter å®Œæˆäº†åˆ›å»º */</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> HelloService helloService;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@GetMapping(value =&quot;/say&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> helloService.sayHello();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="alert warning no-icon"><ol start="4"><li>åˆ›å»ºå¯åŠ¨ç±» HelloApplication</li></ol></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloApplication</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		SpringApplication.run(HelloApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå°±å®Œæˆäº† Spring Boot çš„ Starter çš„åˆ›å»ºä»¥åŠä½¿ç”¨</p></div></div><div id="post-footer" class="post-footer main-content-wrap"><div class="post-footer-tags"><span class="text-color-light text-small">æ ‡ç­¾</span><br><a class="tag tag--primary tag--small t-none-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></div><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/http%EF%BC%88%E5%9B%9B%EF%BC%89http-%E6%91%98%E8%A6%81%E8%AE%A4%E8%AF%81/" data-tooltip="HTTPï¼ˆå››ï¼‰HTTP æ‘˜è¦è®¤è¯" aria-label="ä¸Šä¸€ç¯‡: HTTPï¼ˆå››ï¼‰HTTP æ‘˜è¦è®¤è¯"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">ä¸Šä¸€ç¯‡</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mysql-%E5%9B%9B-%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E6%B5%81%E7%A8%8B/" data-tooltip="MySQL(å››)ç®€å•æŸ¥è¯¢è¯­å¥æµç¨‹" aria-label="ä¸‹ä¸€ç¯‡: MySQL(å››)ç®€å•æŸ¥è¯¢è¯­å¥æµç¨‹"><span class="hide-xs hide-sm text-small icon-mr">ä¸‹ä¸€ç¯‡</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="ç›®å½•"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></article><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><footer id="footer" class="main-content-wrap"><span class="copyrights">Copyrights &copy; 2023 pineapple-man. All Rights Reserved.</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><br>Total <span id="busuanzi_value_site_pv"></span> views. æ‚¨æ˜¯pineapple-mançš„ç¬¬<span id="busuanzi_value_site_uv"></span>ä¸ªå°ä¼™ä¼´<br><i class="fas fa-book-open"></i> <span class="post-count">åšå®¢å­—æ•°ç»Ÿè®¡ï¼š370.7k</span><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script></footer></div><div id="bottom-bar" class="post-bottom-bar" data-behavior="5"><div class="post-actions-wrap"><nav><ul class="post-actions post-action-nav"><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/http%EF%BC%88%E5%9B%9B%EF%BC%89http-%E6%91%98%E8%A6%81%E8%AE%A4%E8%AF%81/" data-tooltip="HTTPï¼ˆå››ï¼‰HTTP æ‘˜è¦è®¤è¯" aria-label="ä¸Šä¸€ç¯‡: HTTPï¼ˆå››ï¼‰HTTP æ‘˜è¦è®¤è¯"><i class="fa fa-angle-left" aria-hidden="true"></i> <span class="hide-xs hide-sm text-small icon-ml">ä¸Šä¸€ç¯‡</span></a></li><li class="post-action"><a class="post-action-btn btn btn--default tooltip--top" href="/mysql-%E5%9B%9B-%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E6%B5%81%E7%A8%8B/" data-tooltip="MySQL(å››)ç®€å•æŸ¥è¯¢è¯­å¥æµç¨‹" aria-label="ä¸‹ä¸€ç¯‡: MySQL(å››)ç®€å•æŸ¥è¯¢è¯­å¥æµç¨‹"><span class="hide-xs hide-sm text-small icon-mr">ä¸‹ä¸€ç¯‡</span> <i class="fa fa-angle-right" aria-hidden="true"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen"><i class="fa fa-share-alt" aria-hidden="true"></i></a></li><li class="post-action"><a class="post-action-btn btn btn--default" href="#table-of-contents" aria-label="ç›®å½•"><i class="fa fa-list" aria-hidden="true"></i></a></li></ul></div></div></div><div id="about"><div id="about-card"><div id="about-btn-close"><i class="fa fa-times"></i></div><img id="about-card-picture" src="/assets/images/logo.png" alt="ä½œè€…çš„å›¾ç‰‡"><h4 id="about-card-name">pineapple-man</h4><div id="about-card-bio"><p>åšä¸€ä¸ªè èï¼šç«™å¾—ç¬”ç›´ï¼Œå¤´æˆ´ç‹å† ï¼Œå†…å¿ƒç”œç¾</p></div><div id="about-card-job"><i class="fa fa-briefcase"></i><br><p>åˆšæ¯•ä¸šå°±å¤±ä¸š</p></div><div id="about-card-location"><i class="fa fa-map-marker-alt"></i><br>è¥¿å®‰</div></div></div><div id="cover" style="background-image:url(/assets/images/cover-v1.2.0.jpg)"></div><script src="/assets/js/script-kcoiyt1nxfue7qgcpkrcixymglcc3cuxeg98fy01hqww4nblnhd2ees6j6yc.min.js"></script></body></html>